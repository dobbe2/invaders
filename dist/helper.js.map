{
  "version": 3,
  "sources": ["../node_modules/stackframe/stackframe.js", "../node_modules/error-stack-parser/error-stack-parser.js", "../node_modules/stack-generator/stack-generator.js", "../node_modules/source-map/lib/util.js", "../node_modules/source-map/lib/binary-search.js", "../node_modules/source-map/lib/array-set.js", "../node_modules/source-map/lib/base64.js", "../node_modules/source-map/lib/base64-vlq.js", "../node_modules/source-map/lib/quick-sort.js", "../node_modules/source-map/lib/source-map-consumer.js", "../node_modules/stacktrace-gps/stacktrace-gps.js", "../node_modules/stacktrace-js/stacktrace.js", "../helper.js", "../node_modules/kaboom/src/math.ts", "../node_modules/kaboom/src/utils.ts", "../node_modules/kaboom/src/gfx.ts", "../node_modules/kaboom/src/app.ts", "../node_modules/kaboom/src/audio.ts", "../node_modules/kaboom/src/assets.ts", "../node_modules/kaboom/src/logger.ts", "../node_modules/kaboom/src/net.ts", "../node_modules/kaboom/src/plugins/mark.ts", "../node_modules/kaboom/src/plugins/pedit.ts", "../node_modules/kaboom/src/plugins/aseprite.ts", "../node_modules/kaboom/src/plugins/04b03.ts", "../node_modules/kaboom/src/plugins/cga.ts", "../node_modules/kaboom/src/plugins/proggy.ts", "../node_modules/kaboom/src/plugins/level.ts", "../node_modules/kaboom/src/kaboom.ts"],
  "sourcesContent": ["(function(root, factory) {\n    'use strict';\n    // Universal Module Definition (UMD) to support AMD, CommonJS/Node.js, Rhino, and browsers.\n\n    /* istanbul ignore next */\n    if (typeof define === 'function' && define.amd) {\n        define('stackframe', [], factory);\n    } else if (typeof exports === 'object') {\n        module.exports = factory();\n    } else {\n        root.StackFrame = factory();\n    }\n}(this, function() {\n    'use strict';\n    function _isNumber(n) {\n        return !isNaN(parseFloat(n)) && isFinite(n);\n    }\n\n    function _capitalize(str) {\n        return str.charAt(0).toUpperCase() + str.substring(1);\n    }\n\n    function _getter(p) {\n        return function() {\n            return this[p];\n        };\n    }\n\n    var booleanProps = ['isConstructor', 'isEval', 'isNative', 'isToplevel'];\n    var numericProps = ['columnNumber', 'lineNumber'];\n    var stringProps = ['fileName', 'functionName', 'source'];\n    var arrayProps = ['args'];\n    var objectProps = ['evalOrigin'];\n\n    var props = booleanProps.concat(numericProps, stringProps, arrayProps, objectProps);\n\n    function StackFrame(obj) {\n        if (!obj) return;\n        for (var i = 0; i < props.length; i++) {\n            if (obj[props[i]] !== undefined) {\n                this['set' + _capitalize(props[i])](obj[props[i]]);\n            }\n        }\n    }\n\n    StackFrame.prototype = {\n        getArgs: function() {\n            return this.args;\n        },\n        setArgs: function(v) {\n            if (Object.prototype.toString.call(v) !== '[object Array]') {\n                throw new TypeError('Args must be an Array');\n            }\n            this.args = v;\n        },\n\n        getEvalOrigin: function() {\n            return this.evalOrigin;\n        },\n        setEvalOrigin: function(v) {\n            if (v instanceof StackFrame) {\n                this.evalOrigin = v;\n            } else if (v instanceof Object) {\n                this.evalOrigin = new StackFrame(v);\n            } else {\n                throw new TypeError('Eval Origin must be an Object or StackFrame');\n            }\n        },\n\n        toString: function() {\n            var fileName = this.getFileName() || '';\n            var lineNumber = this.getLineNumber() || '';\n            var columnNumber = this.getColumnNumber() || '';\n            var functionName = this.getFunctionName() || '';\n            if (this.getIsEval()) {\n                if (fileName) {\n                    return '[eval] (' + fileName + ':' + lineNumber + ':' + columnNumber + ')';\n                }\n                return '[eval]:' + lineNumber + ':' + columnNumber;\n            }\n            if (functionName) {\n                return functionName + ' (' + fileName + ':' + lineNumber + ':' + columnNumber + ')';\n            }\n            return fileName + ':' + lineNumber + ':' + columnNumber;\n        }\n    };\n\n    StackFrame.fromString = function StackFrame$$fromString(str) {\n        var argsStartIndex = str.indexOf('(');\n        var argsEndIndex = str.lastIndexOf(')');\n\n        var functionName = str.substring(0, argsStartIndex);\n        var args = str.substring(argsStartIndex + 1, argsEndIndex).split(',');\n        var locationString = str.substring(argsEndIndex + 1);\n\n        if (locationString.indexOf('@') === 0) {\n            var parts = /@(.+?)(?::(\\d+))?(?::(\\d+))?$/.exec(locationString, '');\n            var fileName = parts[1];\n            var lineNumber = parts[2];\n            var columnNumber = parts[3];\n        }\n\n        return new StackFrame({\n            functionName: functionName,\n            args: args || undefined,\n            fileName: fileName,\n            lineNumber: lineNumber || undefined,\n            columnNumber: columnNumber || undefined\n        });\n    };\n\n    for (var i = 0; i < booleanProps.length; i++) {\n        StackFrame.prototype['get' + _capitalize(booleanProps[i])] = _getter(booleanProps[i]);\n        StackFrame.prototype['set' + _capitalize(booleanProps[i])] = (function(p) {\n            return function(v) {\n                this[p] = Boolean(v);\n            };\n        })(booleanProps[i]);\n    }\n\n    for (var j = 0; j < numericProps.length; j++) {\n        StackFrame.prototype['get' + _capitalize(numericProps[j])] = _getter(numericProps[j]);\n        StackFrame.prototype['set' + _capitalize(numericProps[j])] = (function(p) {\n            return function(v) {\n                if (!_isNumber(v)) {\n                    throw new TypeError(p + ' must be a Number');\n                }\n                this[p] = Number(v);\n            };\n        })(numericProps[j]);\n    }\n\n    for (var k = 0; k < stringProps.length; k++) {\n        StackFrame.prototype['get' + _capitalize(stringProps[k])] = _getter(stringProps[k]);\n        StackFrame.prototype['set' + _capitalize(stringProps[k])] = (function(p) {\n            return function(v) {\n                this[p] = String(v);\n            };\n        })(stringProps[k]);\n    }\n\n    return StackFrame;\n}));\n", "(function(root, factory) {\n    'use strict';\n    // Universal Module Definition (UMD) to support AMD, CommonJS/Node.js, Rhino, and browsers.\n\n    /* istanbul ignore next */\n    if (typeof define === 'function' && define.amd) {\n        define('error-stack-parser', ['stackframe'], factory);\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('stackframe'));\n    } else {\n        root.ErrorStackParser = factory(root.StackFrame);\n    }\n}(this, function ErrorStackParser(StackFrame) {\n    'use strict';\n\n    var FIREFOX_SAFARI_STACK_REGEXP = /(^|@)\\S+:\\d+/;\n    var CHROME_IE_STACK_REGEXP = /^\\s*at .*(\\S+:\\d+|\\(native\\))/m;\n    var SAFARI_NATIVE_CODE_REGEXP = /^(eval@)?(\\[native code])?$/;\n\n    return {\n        /**\n         * Given an Error object, extract the most information from it.\n         *\n         * @param {Error} error object\n         * @return {Array} of StackFrames\n         */\n        parse: function ErrorStackParser$$parse(error) {\n            if (typeof error.stacktrace !== 'undefined' || typeof error['opera#sourceloc'] !== 'undefined') {\n                return this.parseOpera(error);\n            } else if (error.stack && error.stack.match(CHROME_IE_STACK_REGEXP)) {\n                return this.parseV8OrIE(error);\n            } else if (error.stack) {\n                return this.parseFFOrSafari(error);\n            } else {\n                throw new Error('Cannot parse given Error object');\n            }\n        },\n\n        // Separate line and column numbers from a string of the form: (URI:Line:Column)\n        extractLocation: function ErrorStackParser$$extractLocation(urlLike) {\n            // Fail-fast but return locations like \"(native)\"\n            if (urlLike.indexOf(':') === -1) {\n                return [urlLike];\n            }\n\n            var regExp = /(.+?)(?::(\\d+))?(?::(\\d+))?$/;\n            var parts = regExp.exec(urlLike.replace(/[()]/g, ''));\n            return [parts[1], parts[2] || undefined, parts[3] || undefined];\n        },\n\n        parseV8OrIE: function ErrorStackParser$$parseV8OrIE(error) {\n            var filtered = error.stack.split('\\n').filter(function(line) {\n                return !!line.match(CHROME_IE_STACK_REGEXP);\n            }, this);\n\n            return filtered.map(function(line) {\n                if (line.indexOf('(eval ') > -1) {\n                    // Throw away eval information until we implement stacktrace.js/stackframe#8\n                    line = line.replace(/eval code/g, 'eval').replace(/(\\(eval at [^()]*)|(\\),.*$)/g, '');\n                }\n                var sanitizedLine = line.replace(/^\\s+/, '').replace(/\\(eval code/g, '(');\n\n                // capture and preseve the parenthesized location \"(/foo/my bar.js:12:87)\" in\n                // case it has spaces in it, as the string is split on \\s+ later on\n                var location = sanitizedLine.match(/ (\\((.+):(\\d+):(\\d+)\\)$)/);\n\n                // remove the parenthesized location from the line, if it was matched\n                sanitizedLine = location ? sanitizedLine.replace(location[0], '') : sanitizedLine;\n\n                var tokens = sanitizedLine.split(/\\s+/).slice(1);\n                // if a location was matched, pass it to extractLocation() otherwise pop the last token\n                var locationParts = this.extractLocation(location ? location[1] : tokens.pop());\n                var functionName = tokens.join(' ') || undefined;\n                var fileName = ['eval', '<anonymous>'].indexOf(locationParts[0]) > -1 ? undefined : locationParts[0];\n\n                return new StackFrame({\n                    functionName: functionName,\n                    fileName: fileName,\n                    lineNumber: locationParts[1],\n                    columnNumber: locationParts[2],\n                    source: line\n                });\n            }, this);\n        },\n\n        parseFFOrSafari: function ErrorStackParser$$parseFFOrSafari(error) {\n            var filtered = error.stack.split('\\n').filter(function(line) {\n                return !line.match(SAFARI_NATIVE_CODE_REGEXP);\n            }, this);\n\n            return filtered.map(function(line) {\n                // Throw away eval information until we implement stacktrace.js/stackframe#8\n                if (line.indexOf(' > eval') > -1) {\n                    line = line.replace(/ line (\\d+)(?: > eval line \\d+)* > eval:\\d+:\\d+/g, ':$1');\n                }\n\n                if (line.indexOf('@') === -1 && line.indexOf(':') === -1) {\n                    // Safari eval frames only have function names and nothing else\n                    return new StackFrame({\n                        functionName: line\n                    });\n                } else {\n                    var functionNameRegex = /((.*\".+\"[^@]*)?[^@]*)(?:@)/;\n                    var matches = line.match(functionNameRegex);\n                    var functionName = matches && matches[1] ? matches[1] : undefined;\n                    var locationParts = this.extractLocation(line.replace(functionNameRegex, ''));\n\n                    return new StackFrame({\n                        functionName: functionName,\n                        fileName: locationParts[0],\n                        lineNumber: locationParts[1],\n                        columnNumber: locationParts[2],\n                        source: line\n                    });\n                }\n            }, this);\n        },\n\n        parseOpera: function ErrorStackParser$$parseOpera(e) {\n            if (!e.stacktrace || (e.message.indexOf('\\n') > -1 &&\n                e.message.split('\\n').length > e.stacktrace.split('\\n').length)) {\n                return this.parseOpera9(e);\n            } else if (!e.stack) {\n                return this.parseOpera10(e);\n            } else {\n                return this.parseOpera11(e);\n            }\n        },\n\n        parseOpera9: function ErrorStackParser$$parseOpera9(e) {\n            var lineRE = /Line (\\d+).*script (?:in )?(\\S+)/i;\n            var lines = e.message.split('\\n');\n            var result = [];\n\n            for (var i = 2, len = lines.length; i < len; i += 2) {\n                var match = lineRE.exec(lines[i]);\n                if (match) {\n                    result.push(new StackFrame({\n                        fileName: match[2],\n                        lineNumber: match[1],\n                        source: lines[i]\n                    }));\n                }\n            }\n\n            return result;\n        },\n\n        parseOpera10: function ErrorStackParser$$parseOpera10(e) {\n            var lineRE = /Line (\\d+).*script (?:in )?(\\S+)(?:: In function (\\S+))?$/i;\n            var lines = e.stacktrace.split('\\n');\n            var result = [];\n\n            for (var i = 0, len = lines.length; i < len; i += 2) {\n                var match = lineRE.exec(lines[i]);\n                if (match) {\n                    result.push(\n                        new StackFrame({\n                            functionName: match[3] || undefined,\n                            fileName: match[2],\n                            lineNumber: match[1],\n                            source: lines[i]\n                        })\n                    );\n                }\n            }\n\n            return result;\n        },\n\n        // Opera 10.65+ Error.stack very similar to FF/Safari\n        parseOpera11: function ErrorStackParser$$parseOpera11(error) {\n            var filtered = error.stack.split('\\n').filter(function(line) {\n                return !!line.match(FIREFOX_SAFARI_STACK_REGEXP) && !line.match(/^Error created at/);\n            }, this);\n\n            return filtered.map(function(line) {\n                var tokens = line.split('@');\n                var locationParts = this.extractLocation(tokens.pop());\n                var functionCall = (tokens.shift() || '');\n                var functionName = functionCall\n                    .replace(/<anonymous function(: (\\w+))?>/, '$2')\n                    .replace(/\\([^)]*\\)/g, '') || undefined;\n                var argsRaw;\n                if (functionCall.match(/\\(([^)]*)\\)/)) {\n                    argsRaw = functionCall.replace(/^[^(]+\\(([^)]*)\\)$/, '$1');\n                }\n                var args = (argsRaw === undefined || argsRaw === '[arguments not available]') ?\n                    undefined : argsRaw.split(',');\n\n                return new StackFrame({\n                    functionName: functionName,\n                    args: args,\n                    fileName: locationParts[0],\n                    lineNumber: locationParts[1],\n                    columnNumber: locationParts[2],\n                    source: line\n                });\n            }, this);\n        }\n    };\n}));\n", "(function(root, factory) {\n    'use strict';\n    // Universal Module Definition (UMD) to support AMD, CommonJS/Node.js, Rhino, and browsers.\n\n    /* istanbul ignore next */\n    if (typeof define === 'function' && define.amd) {\n        define('stack-generator', ['stackframe'], factory);\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('stackframe'));\n    } else {\n        root.StackGenerator = factory(root.StackFrame);\n    }\n}(this, function(StackFrame) {\n    return {\n        backtrace: function StackGenerator$$backtrace(opts) {\n            var stack = [];\n            var maxStackSize = 10;\n\n            if (typeof opts === 'object' && typeof opts.maxStackSize === 'number') {\n                maxStackSize = opts.maxStackSize;\n            }\n\n            var curr = arguments.callee;\n            while (curr && stack.length < maxStackSize && curr['arguments']) {\n                // Allow V8 optimizations\n                var args = new Array(curr['arguments'].length);\n                for (var i = 0; i < args.length; ++i) {\n                    args[i] = curr['arguments'][i];\n                }\n                if (/function(?:\\s+([\\w$]+))+\\s*\\(/.test(curr.toString())) {\n                    stack.push(new StackFrame({functionName: RegExp.$1 || undefined, args: args}));\n                } else {\n                    stack.push(new StackFrame({args: args}));\n                }\n\n                try {\n                    curr = curr.caller;\n                } catch (e) {\n                    break;\n                }\n            }\n            return stack;\n        }\n    };\n}));\n", "/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\n/**\n * This is a helper function for getting values from parameter/options\n * objects.\n *\n * @param args The object we are extracting values from\n * @param name The name of the property we are getting.\n * @param defaultValue An optional value to return if the property is missing\n * from the object. If this is not specified and the property is missing, an\n * error will be thrown.\n */\nfunction getArg(aArgs, aName, aDefaultValue) {\n  if (aName in aArgs) {\n    return aArgs[aName];\n  } else if (arguments.length === 3) {\n    return aDefaultValue;\n  } else {\n    throw new Error('\"' + aName + '\" is a required argument.');\n  }\n}\nexports.getArg = getArg;\n\nvar urlRegexp = /^(?:([\\w+\\-.]+):)?\\/\\/(?:(\\w+:\\w+)@)?([\\w.]*)(?::(\\d+))?(\\S*)$/;\nvar dataUrlRegexp = /^data:.+\\,.+$/;\n\nfunction urlParse(aUrl) {\n  var match = aUrl.match(urlRegexp);\n  if (!match) {\n    return null;\n  }\n  return {\n    scheme: match[1],\n    auth: match[2],\n    host: match[3],\n    port: match[4],\n    path: match[5]\n  };\n}\nexports.urlParse = urlParse;\n\nfunction urlGenerate(aParsedUrl) {\n  var url = '';\n  if (aParsedUrl.scheme) {\n    url += aParsedUrl.scheme + ':';\n  }\n  url += '//';\n  if (aParsedUrl.auth) {\n    url += aParsedUrl.auth + '@';\n  }\n  if (aParsedUrl.host) {\n    url += aParsedUrl.host;\n  }\n  if (aParsedUrl.port) {\n    url += \":\" + aParsedUrl.port\n  }\n  if (aParsedUrl.path) {\n    url += aParsedUrl.path;\n  }\n  return url;\n}\nexports.urlGenerate = urlGenerate;\n\n/**\n * Normalizes a path, or the path portion of a URL:\n *\n * - Replaces consecutive slashes with one slash.\n * - Removes unnecessary '.' parts.\n * - Removes unnecessary '<dir>/..' parts.\n *\n * Based on code in the Node.js 'path' core module.\n *\n * @param aPath The path or url to normalize.\n */\nfunction normalize(aPath) {\n  var path = aPath;\n  var url = urlParse(aPath);\n  if (url) {\n    if (!url.path) {\n      return aPath;\n    }\n    path = url.path;\n  }\n  var isAbsolute = exports.isAbsolute(path);\n\n  var parts = path.split(/\\/+/);\n  for (var part, up = 0, i = parts.length - 1; i >= 0; i--) {\n    part = parts[i];\n    if (part === '.') {\n      parts.splice(i, 1);\n    } else if (part === '..') {\n      up++;\n    } else if (up > 0) {\n      if (part === '') {\n        // The first part is blank if the path is absolute. Trying to go\n        // above the root is a no-op. Therefore we can remove all '..' parts\n        // directly after the root.\n        parts.splice(i + 1, up);\n        up = 0;\n      } else {\n        parts.splice(i, 2);\n        up--;\n      }\n    }\n  }\n  path = parts.join('/');\n\n  if (path === '') {\n    path = isAbsolute ? '/' : '.';\n  }\n\n  if (url) {\n    url.path = path;\n    return urlGenerate(url);\n  }\n  return path;\n}\nexports.normalize = normalize;\n\n/**\n * Joins two paths/URLs.\n *\n * @param aRoot The root path or URL.\n * @param aPath The path or URL to be joined with the root.\n *\n * - If aPath is a URL or a data URI, aPath is returned, unless aPath is a\n *   scheme-relative URL: Then the scheme of aRoot, if any, is prepended\n *   first.\n * - Otherwise aPath is a path. If aRoot is a URL, then its path portion\n *   is updated with the result and aRoot is returned. Otherwise the result\n *   is returned.\n *   - If aPath is absolute, the result is aPath.\n *   - Otherwise the two paths are joined with a slash.\n * - Joining for example 'http://' and 'www.example.com' is also supported.\n */\nfunction join(aRoot, aPath) {\n  if (aRoot === \"\") {\n    aRoot = \".\";\n  }\n  if (aPath === \"\") {\n    aPath = \".\";\n  }\n  var aPathUrl = urlParse(aPath);\n  var aRootUrl = urlParse(aRoot);\n  if (aRootUrl) {\n    aRoot = aRootUrl.path || '/';\n  }\n\n  // `join(foo, '//www.example.org')`\n  if (aPathUrl && !aPathUrl.scheme) {\n    if (aRootUrl) {\n      aPathUrl.scheme = aRootUrl.scheme;\n    }\n    return urlGenerate(aPathUrl);\n  }\n\n  if (aPathUrl || aPath.match(dataUrlRegexp)) {\n    return aPath;\n  }\n\n  // `join('http://', 'www.example.com')`\n  if (aRootUrl && !aRootUrl.host && !aRootUrl.path) {\n    aRootUrl.host = aPath;\n    return urlGenerate(aRootUrl);\n  }\n\n  var joined = aPath.charAt(0) === '/'\n    ? aPath\n    : normalize(aRoot.replace(/\\/+$/, '') + '/' + aPath);\n\n  if (aRootUrl) {\n    aRootUrl.path = joined;\n    return urlGenerate(aRootUrl);\n  }\n  return joined;\n}\nexports.join = join;\n\nexports.isAbsolute = function (aPath) {\n  return aPath.charAt(0) === '/' || !!aPath.match(urlRegexp);\n};\n\n/**\n * Make a path relative to a URL or another path.\n *\n * @param aRoot The root path or URL.\n * @param aPath The path or URL to be made relative to aRoot.\n */\nfunction relative(aRoot, aPath) {\n  if (aRoot === \"\") {\n    aRoot = \".\";\n  }\n\n  aRoot = aRoot.replace(/\\/$/, '');\n\n  // It is possible for the path to be above the root. In this case, simply\n  // checking whether the root is a prefix of the path won't work. Instead, we\n  // need to remove components from the root one by one, until either we find\n  // a prefix that fits, or we run out of components to remove.\n  var level = 0;\n  while (aPath.indexOf(aRoot + '/') !== 0) {\n    var index = aRoot.lastIndexOf(\"/\");\n    if (index < 0) {\n      return aPath;\n    }\n\n    // If the only part of the root that is left is the scheme (i.e. http://,\n    // file:///, etc.), one or more slashes (/), or simply nothing at all, we\n    // have exhausted all components, so the path is not relative to the root.\n    aRoot = aRoot.slice(0, index);\n    if (aRoot.match(/^([^\\/]+:\\/)?\\/*$/)) {\n      return aPath;\n    }\n\n    ++level;\n  }\n\n  // Make sure we add a \"../\" for each component we removed from the root.\n  return Array(level + 1).join(\"../\") + aPath.substr(aRoot.length + 1);\n}\nexports.relative = relative;\n\nvar supportsNullProto = (function () {\n  var obj = Object.create(null);\n  return !('__proto__' in obj);\n}());\n\nfunction identity (s) {\n  return s;\n}\n\n/**\n * Because behavior goes wacky when you set `__proto__` on objects, we\n * have to prefix all the strings in our set with an arbitrary character.\n *\n * See https://github.com/mozilla/source-map/pull/31 and\n * https://github.com/mozilla/source-map/issues/30\n *\n * @param String aStr\n */\nfunction toSetString(aStr) {\n  if (isProtoString(aStr)) {\n    return '$' + aStr;\n  }\n\n  return aStr;\n}\nexports.toSetString = supportsNullProto ? identity : toSetString;\n\nfunction fromSetString(aStr) {\n  if (isProtoString(aStr)) {\n    return aStr.slice(1);\n  }\n\n  return aStr;\n}\nexports.fromSetString = supportsNullProto ? identity : fromSetString;\n\nfunction isProtoString(s) {\n  if (!s) {\n    return false;\n  }\n\n  var length = s.length;\n\n  if (length < 9 /* \"__proto__\".length */) {\n    return false;\n  }\n\n  if (s.charCodeAt(length - 1) !== 95  /* '_' */ ||\n      s.charCodeAt(length - 2) !== 95  /* '_' */ ||\n      s.charCodeAt(length - 3) !== 111 /* 'o' */ ||\n      s.charCodeAt(length - 4) !== 116 /* 't' */ ||\n      s.charCodeAt(length - 5) !== 111 /* 'o' */ ||\n      s.charCodeAt(length - 6) !== 114 /* 'r' */ ||\n      s.charCodeAt(length - 7) !== 112 /* 'p' */ ||\n      s.charCodeAt(length - 8) !== 95  /* '_' */ ||\n      s.charCodeAt(length - 9) !== 95  /* '_' */) {\n    return false;\n  }\n\n  for (var i = length - 10; i >= 0; i--) {\n    if (s.charCodeAt(i) !== 36 /* '$' */) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Comparator between two mappings where the original positions are compared.\n *\n * Optionally pass in `true` as `onlyCompareGenerated` to consider two\n * mappings with the same original source/line/column, but different generated\n * line and column the same. Useful when searching for a mapping with a\n * stubbed out mapping.\n */\nfunction compareByOriginalPositions(mappingA, mappingB, onlyCompareOriginal) {\n  var cmp = mappingA.source - mappingB.source;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalLine - mappingB.originalLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalColumn - mappingB.originalColumn;\n  if (cmp !== 0 || onlyCompareOriginal) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedColumn - mappingB.generatedColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedLine - mappingB.generatedLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  return mappingA.name - mappingB.name;\n}\nexports.compareByOriginalPositions = compareByOriginalPositions;\n\n/**\n * Comparator between two mappings with deflated source and name indices where\n * the generated positions are compared.\n *\n * Optionally pass in `true` as `onlyCompareGenerated` to consider two\n * mappings with the same generated line and column, but different\n * source/name/original line and column the same. Useful when searching for a\n * mapping with a stubbed out mapping.\n */\nfunction compareByGeneratedPositionsDeflated(mappingA, mappingB, onlyCompareGenerated) {\n  var cmp = mappingA.generatedLine - mappingB.generatedLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedColumn - mappingB.generatedColumn;\n  if (cmp !== 0 || onlyCompareGenerated) {\n    return cmp;\n  }\n\n  cmp = mappingA.source - mappingB.source;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalLine - mappingB.originalLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalColumn - mappingB.originalColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  return mappingA.name - mappingB.name;\n}\nexports.compareByGeneratedPositionsDeflated = compareByGeneratedPositionsDeflated;\n\nfunction strcmp(aStr1, aStr2) {\n  if (aStr1 === aStr2) {\n    return 0;\n  }\n\n  if (aStr1 > aStr2) {\n    return 1;\n  }\n\n  return -1;\n}\n\n/**\n * Comparator between two mappings with inflated source and name strings where\n * the generated positions are compared.\n */\nfunction compareByGeneratedPositionsInflated(mappingA, mappingB) {\n  var cmp = mappingA.generatedLine - mappingB.generatedLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedColumn - mappingB.generatedColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = strcmp(mappingA.source, mappingB.source);\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalLine - mappingB.originalLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalColumn - mappingB.originalColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  return strcmp(mappingA.name, mappingB.name);\n}\nexports.compareByGeneratedPositionsInflated = compareByGeneratedPositionsInflated;\n", "/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nexports.GREATEST_LOWER_BOUND = 1;\nexports.LEAST_UPPER_BOUND = 2;\n\n/**\n * Recursive implementation of binary search.\n *\n * @param aLow Indices here and lower do not contain the needle.\n * @param aHigh Indices here and higher do not contain the needle.\n * @param aNeedle The element being searched for.\n * @param aHaystack The non-empty array being searched.\n * @param aCompare Function which takes two elements and returns -1, 0, or 1.\n * @param aBias Either 'binarySearch.GREATEST_LOWER_BOUND' or\n *     'binarySearch.LEAST_UPPER_BOUND'. Specifies whether to return the\n *     closest element that is smaller than or greater than the one we are\n *     searching for, respectively, if the exact element cannot be found.\n */\nfunction recursiveSearch(aLow, aHigh, aNeedle, aHaystack, aCompare, aBias) {\n  // This function terminates when one of the following is true:\n  //\n  //   1. We find the exact element we are looking for.\n  //\n  //   2. We did not find the exact element, but we can return the index of\n  //      the next-closest element.\n  //\n  //   3. We did not find the exact element, and there is no next-closest\n  //      element than the one we are searching for, so we return -1.\n  var mid = Math.floor((aHigh - aLow) / 2) + aLow;\n  var cmp = aCompare(aNeedle, aHaystack[mid], true);\n  if (cmp === 0) {\n    // Found the element we are looking for.\n    return mid;\n  }\n  else if (cmp > 0) {\n    // Our needle is greater than aHaystack[mid].\n    if (aHigh - mid > 1) {\n      // The element is in the upper half.\n      return recursiveSearch(mid, aHigh, aNeedle, aHaystack, aCompare, aBias);\n    }\n\n    // The exact needle element was not found in this haystack. Determine if\n    // we are in termination case (3) or (2) and return the appropriate thing.\n    if (aBias == exports.LEAST_UPPER_BOUND) {\n      return aHigh < aHaystack.length ? aHigh : -1;\n    } else {\n      return mid;\n    }\n  }\n  else {\n    // Our needle is less than aHaystack[mid].\n    if (mid - aLow > 1) {\n      // The element is in the lower half.\n      return recursiveSearch(aLow, mid, aNeedle, aHaystack, aCompare, aBias);\n    }\n\n    // we are in termination case (3) or (2) and return the appropriate thing.\n    if (aBias == exports.LEAST_UPPER_BOUND) {\n      return mid;\n    } else {\n      return aLow < 0 ? -1 : aLow;\n    }\n  }\n}\n\n/**\n * This is an implementation of binary search which will always try and return\n * the index of the closest element if there is no exact hit. This is because\n * mappings between original and generated line/col pairs are single points,\n * and there is an implicit region between each of them, so a miss just means\n * that you aren't on the very start of a region.\n *\n * @param aNeedle The element you are looking for.\n * @param aHaystack The array that is being searched.\n * @param aCompare A function which takes the needle and an element in the\n *     array and returns -1, 0, or 1 depending on whether the needle is less\n *     than, equal to, or greater than the element, respectively.\n * @param aBias Either 'binarySearch.GREATEST_LOWER_BOUND' or\n *     'binarySearch.LEAST_UPPER_BOUND'. Specifies whether to return the\n *     closest element that is smaller than or greater than the one we are\n *     searching for, respectively, if the exact element cannot be found.\n *     Defaults to 'binarySearch.GREATEST_LOWER_BOUND'.\n */\nexports.search = function search(aNeedle, aHaystack, aCompare, aBias) {\n  if (aHaystack.length === 0) {\n    return -1;\n  }\n\n  var index = recursiveSearch(-1, aHaystack.length, aNeedle, aHaystack,\n                              aCompare, aBias || exports.GREATEST_LOWER_BOUND);\n  if (index < 0) {\n    return -1;\n  }\n\n  // We have found either the exact element, or the next-closest element than\n  // the one we are searching for. However, there may be more than one such\n  // element. Make sure we always return the smallest of these.\n  while (index - 1 >= 0) {\n    if (aCompare(aHaystack[index], aHaystack[index - 1], true) !== 0) {\n      break;\n    }\n    --index;\n  }\n\n  return index;\n};\n", "/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar util = require('./util');\nvar has = Object.prototype.hasOwnProperty;\n\n/**\n * A data structure which is a combination of an array and a set. Adding a new\n * member is O(1), testing for membership is O(1), and finding the index of an\n * element is O(1). Removing elements from the set is not supported. Only\n * strings are supported for membership.\n */\nfunction ArraySet() {\n  this._array = [];\n  this._set = Object.create(null);\n}\n\n/**\n * Static method for creating ArraySet instances from an existing array.\n */\nArraySet.fromArray = function ArraySet_fromArray(aArray, aAllowDuplicates) {\n  var set = new ArraySet();\n  for (var i = 0, len = aArray.length; i < len; i++) {\n    set.add(aArray[i], aAllowDuplicates);\n  }\n  return set;\n};\n\n/**\n * Return how many unique items are in this ArraySet. If duplicates have been\n * added, than those do not count towards the size.\n *\n * @returns Number\n */\nArraySet.prototype.size = function ArraySet_size() {\n  return Object.getOwnPropertyNames(this._set).length;\n};\n\n/**\n * Add the given string to this set.\n *\n * @param String aStr\n */\nArraySet.prototype.add = function ArraySet_add(aStr, aAllowDuplicates) {\n  var sStr = util.toSetString(aStr);\n  var isDuplicate = has.call(this._set, sStr);\n  var idx = this._array.length;\n  if (!isDuplicate || aAllowDuplicates) {\n    this._array.push(aStr);\n  }\n  if (!isDuplicate) {\n    this._set[sStr] = idx;\n  }\n};\n\n/**\n * Is the given string a member of this set?\n *\n * @param String aStr\n */\nArraySet.prototype.has = function ArraySet_has(aStr) {\n  var sStr = util.toSetString(aStr);\n  return has.call(this._set, sStr);\n};\n\n/**\n * What is the index of the given string in the array?\n *\n * @param String aStr\n */\nArraySet.prototype.indexOf = function ArraySet_indexOf(aStr) {\n  var sStr = util.toSetString(aStr);\n  if (has.call(this._set, sStr)) {\n    return this._set[sStr];\n  }\n  throw new Error('\"' + aStr + '\" is not in the set.');\n};\n\n/**\n * What is the element at the given index?\n *\n * @param Number aIdx\n */\nArraySet.prototype.at = function ArraySet_at(aIdx) {\n  if (aIdx >= 0 && aIdx < this._array.length) {\n    return this._array[aIdx];\n  }\n  throw new Error('No element indexed by ' + aIdx);\n};\n\n/**\n * Returns the array representation of this set (which has the proper indices\n * indicated by indexOf). Note that this is a copy of the internal array used\n * for storing the members so that no one can mess with internal state.\n */\nArraySet.prototype.toArray = function ArraySet_toArray() {\n  return this._array.slice();\n};\n\nexports.ArraySet = ArraySet;\n", "/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar intToCharMap = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'.split('');\n\n/**\n * Encode an integer in the range of 0 to 63 to a single base 64 digit.\n */\nexports.encode = function (number) {\n  if (0 <= number && number < intToCharMap.length) {\n    return intToCharMap[number];\n  }\n  throw new TypeError(\"Must be between 0 and 63: \" + number);\n};\n\n/**\n * Decode a single base 64 character code digit to an integer. Returns -1 on\n * failure.\n */\nexports.decode = function (charCode) {\n  var bigA = 65;     // 'A'\n  var bigZ = 90;     // 'Z'\n\n  var littleA = 97;  // 'a'\n  var littleZ = 122; // 'z'\n\n  var zero = 48;     // '0'\n  var nine = 57;     // '9'\n\n  var plus = 43;     // '+'\n  var slash = 47;    // '/'\n\n  var littleOffset = 26;\n  var numberOffset = 52;\n\n  // 0 - 25: ABCDEFGHIJKLMNOPQRSTUVWXYZ\n  if (bigA <= charCode && charCode <= bigZ) {\n    return (charCode - bigA);\n  }\n\n  // 26 - 51: abcdefghijklmnopqrstuvwxyz\n  if (littleA <= charCode && charCode <= littleZ) {\n    return (charCode - littleA + littleOffset);\n  }\n\n  // 52 - 61: 0123456789\n  if (zero <= charCode && charCode <= nine) {\n    return (charCode - zero + numberOffset);\n  }\n\n  // 62: +\n  if (charCode == plus) {\n    return 62;\n  }\n\n  // 63: /\n  if (charCode == slash) {\n    return 63;\n  }\n\n  // Invalid base64 digit.\n  return -1;\n};\n", "/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n *\n * Based on the Base 64 VLQ implementation in Closure Compiler:\n * https://code.google.com/p/closure-compiler/source/browse/trunk/src/com/google/debugging/sourcemap/Base64VLQ.java\n *\n * Copyright 2011 The Closure Compiler Authors. All rights reserved.\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *  * Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above\n *    copyright notice, this list of conditions and the following\n *    disclaimer in the documentation and/or other materials provided\n *    with the distribution.\n *  * Neither the name of Google Inc. nor the names of its\n *    contributors may be used to endorse or promote products derived\n *    from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nvar base64 = require('./base64');\n\n// A single base 64 digit can contain 6 bits of data. For the base 64 variable\n// length quantities we use in the source map spec, the first bit is the sign,\n// the next four bits are the actual value, and the 6th bit is the\n// continuation bit. The continuation bit tells us whether there are more\n// digits in this value following this digit.\n//\n//   Continuation\n//   |    Sign\n//   |    |\n//   V    V\n//   101011\n\nvar VLQ_BASE_SHIFT = 5;\n\n// binary: 100000\nvar VLQ_BASE = 1 << VLQ_BASE_SHIFT;\n\n// binary: 011111\nvar VLQ_BASE_MASK = VLQ_BASE - 1;\n\n// binary: 100000\nvar VLQ_CONTINUATION_BIT = VLQ_BASE;\n\n/**\n * Converts from a two-complement value to a value where the sign bit is\n * placed in the least significant bit.  For example, as decimals:\n *   1 becomes 2 (10 binary), -1 becomes 3 (11 binary)\n *   2 becomes 4 (100 binary), -2 becomes 5 (101 binary)\n */\nfunction toVLQSigned(aValue) {\n  return aValue < 0\n    ? ((-aValue) << 1) + 1\n    : (aValue << 1) + 0;\n}\n\n/**\n * Converts to a two-complement value from a value where the sign bit is\n * placed in the least significant bit.  For example, as decimals:\n *   2 (10 binary) becomes 1, 3 (11 binary) becomes -1\n *   4 (100 binary) becomes 2, 5 (101 binary) becomes -2\n */\nfunction fromVLQSigned(aValue) {\n  var isNegative = (aValue & 1) === 1;\n  var shifted = aValue >> 1;\n  return isNegative\n    ? -shifted\n    : shifted;\n}\n\n/**\n * Returns the base 64 VLQ encoded value.\n */\nexports.encode = function base64VLQ_encode(aValue) {\n  var encoded = \"\";\n  var digit;\n\n  var vlq = toVLQSigned(aValue);\n\n  do {\n    digit = vlq & VLQ_BASE_MASK;\n    vlq >>>= VLQ_BASE_SHIFT;\n    if (vlq > 0) {\n      // There are still more digits in this value, so we must make sure the\n      // continuation bit is marked.\n      digit |= VLQ_CONTINUATION_BIT;\n    }\n    encoded += base64.encode(digit);\n  } while (vlq > 0);\n\n  return encoded;\n};\n\n/**\n * Decodes the next base 64 VLQ value from the given string and returns the\n * value and the rest of the string via the out parameter.\n */\nexports.decode = function base64VLQ_decode(aStr, aIndex, aOutParam) {\n  var strLen = aStr.length;\n  var result = 0;\n  var shift = 0;\n  var continuation, digit;\n\n  do {\n    if (aIndex >= strLen) {\n      throw new Error(\"Expected more digits in base 64 VLQ value.\");\n    }\n\n    digit = base64.decode(aStr.charCodeAt(aIndex++));\n    if (digit === -1) {\n      throw new Error(\"Invalid base64 digit: \" + aStr.charAt(aIndex - 1));\n    }\n\n    continuation = !!(digit & VLQ_CONTINUATION_BIT);\n    digit &= VLQ_BASE_MASK;\n    result = result + (digit << shift);\n    shift += VLQ_BASE_SHIFT;\n  } while (continuation);\n\n  aOutParam.value = fromVLQSigned(result);\n  aOutParam.rest = aIndex;\n};\n", "/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\n// It turns out that some (most?) JavaScript engines don't self-host\n// `Array.prototype.sort`. This makes sense because C++ will likely remain\n// faster than JS when doing raw CPU-intensive sorting. However, when using a\n// custom comparator function, calling back and forth between the VM's C++ and\n// JIT'd JS is rather slow *and* loses JIT type information, resulting in\n// worse generated code for the comparator function than would be optimal. In\n// fact, when sorting with a comparator, these costs outweigh the benefits of\n// sorting in C++. By using our own JS-implemented Quick Sort (below), we get\n// a ~3500ms mean speed-up in `bench/bench.html`.\n\n/**\n * Swap the elements indexed by `x` and `y` in the array `ary`.\n *\n * @param {Array} ary\n *        The array.\n * @param {Number} x\n *        The index of the first item.\n * @param {Number} y\n *        The index of the second item.\n */\nfunction swap(ary, x, y) {\n  var temp = ary[x];\n  ary[x] = ary[y];\n  ary[y] = temp;\n}\n\n/**\n * Returns a random integer within the range `low .. high` inclusive.\n *\n * @param {Number} low\n *        The lower bound on the range.\n * @param {Number} high\n *        The upper bound on the range.\n */\nfunction randomIntInRange(low, high) {\n  return Math.round(low + (Math.random() * (high - low)));\n}\n\n/**\n * The Quick Sort algorithm.\n *\n * @param {Array} ary\n *        An array to sort.\n * @param {function} comparator\n *        Function to use to compare two items.\n * @param {Number} p\n *        Start index of the array\n * @param {Number} r\n *        End index of the array\n */\nfunction doQuickSort(ary, comparator, p, r) {\n  // If our lower bound is less than our upper bound, we (1) partition the\n  // array into two pieces and (2) recurse on each half. If it is not, this is\n  // the empty array and our base case.\n\n  if (p < r) {\n    // (1) Partitioning.\n    //\n    // The partitioning chooses a pivot between `p` and `r` and moves all\n    // elements that are less than or equal to the pivot to the before it, and\n    // all the elements that are greater than it after it. The effect is that\n    // once partition is done, the pivot is in the exact place it will be when\n    // the array is put in sorted order, and it will not need to be moved\n    // again. This runs in O(n) time.\n\n    // Always choose a random pivot so that an input array which is reverse\n    // sorted does not cause O(n^2) running time.\n    var pivotIndex = randomIntInRange(p, r);\n    var i = p - 1;\n\n    swap(ary, pivotIndex, r);\n    var pivot = ary[r];\n\n    // Immediately after `j` is incremented in this loop, the following hold\n    // true:\n    //\n    //   * Every element in `ary[p .. i]` is less than or equal to the pivot.\n    //\n    //   * Every element in `ary[i+1 .. j-1]` is greater than the pivot.\n    for (var j = p; j < r; j++) {\n      if (comparator(ary[j], pivot) <= 0) {\n        i += 1;\n        swap(ary, i, j);\n      }\n    }\n\n    swap(ary, i + 1, j);\n    var q = i + 1;\n\n    // (2) Recurse on each half.\n\n    doQuickSort(ary, comparator, p, q - 1);\n    doQuickSort(ary, comparator, q + 1, r);\n  }\n}\n\n/**\n * Sort the given array in-place with the given comparator function.\n *\n * @param {Array} ary\n *        An array to sort.\n * @param {function} comparator\n *        Function to use to compare two items.\n */\nexports.quickSort = function (ary, comparator) {\n  doQuickSort(ary, comparator, 0, ary.length - 1);\n};\n", "/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar util = require('./util');\nvar binarySearch = require('./binary-search');\nvar ArraySet = require('./array-set').ArraySet;\nvar base64VLQ = require('./base64-vlq');\nvar quickSort = require('./quick-sort').quickSort;\n\nfunction SourceMapConsumer(aSourceMap) {\n  var sourceMap = aSourceMap;\n  if (typeof aSourceMap === 'string') {\n    sourceMap = JSON.parse(aSourceMap.replace(/^\\)\\]\\}'/, ''));\n  }\n\n  return sourceMap.sections != null\n    ? new IndexedSourceMapConsumer(sourceMap)\n    : new BasicSourceMapConsumer(sourceMap);\n}\n\nSourceMapConsumer.fromSourceMap = function(aSourceMap) {\n  return BasicSourceMapConsumer.fromSourceMap(aSourceMap);\n}\n\n/**\n * The version of the source mapping spec that we are consuming.\n */\nSourceMapConsumer.prototype._version = 3;\n\n// `__generatedMappings` and `__originalMappings` are arrays that hold the\n// parsed mapping coordinates from the source map's \"mappings\" attribute. They\n// are lazily instantiated, accessed via the `_generatedMappings` and\n// `_originalMappings` getters respectively, and we only parse the mappings\n// and create these arrays once queried for a source location. We jump through\n// these hoops because there can be many thousands of mappings, and parsing\n// them is expensive, so we only want to do it if we must.\n//\n// Each object in the arrays is of the form:\n//\n//     {\n//       generatedLine: The line number in the generated code,\n//       generatedColumn: The column number in the generated code,\n//       source: The path to the original source file that generated this\n//               chunk of code,\n//       originalLine: The line number in the original source that\n//                     corresponds to this chunk of generated code,\n//       originalColumn: The column number in the original source that\n//                       corresponds to this chunk of generated code,\n//       name: The name of the original symbol which generated this chunk of\n//             code.\n//     }\n//\n// All properties except for `generatedLine` and `generatedColumn` can be\n// `null`.\n//\n// `_generatedMappings` is ordered by the generated positions.\n//\n// `_originalMappings` is ordered by the original positions.\n\nSourceMapConsumer.prototype.__generatedMappings = null;\nObject.defineProperty(SourceMapConsumer.prototype, '_generatedMappings', {\n  get: function () {\n    if (!this.__generatedMappings) {\n      this._parseMappings(this._mappings, this.sourceRoot);\n    }\n\n    return this.__generatedMappings;\n  }\n});\n\nSourceMapConsumer.prototype.__originalMappings = null;\nObject.defineProperty(SourceMapConsumer.prototype, '_originalMappings', {\n  get: function () {\n    if (!this.__originalMappings) {\n      this._parseMappings(this._mappings, this.sourceRoot);\n    }\n\n    return this.__originalMappings;\n  }\n});\n\nSourceMapConsumer.prototype._charIsMappingSeparator =\n  function SourceMapConsumer_charIsMappingSeparator(aStr, index) {\n    var c = aStr.charAt(index);\n    return c === \";\" || c === \",\";\n  };\n\n/**\n * Parse the mappings in a string in to a data structure which we can easily\n * query (the ordered arrays in the `this.__generatedMappings` and\n * `this.__originalMappings` properties).\n */\nSourceMapConsumer.prototype._parseMappings =\n  function SourceMapConsumer_parseMappings(aStr, aSourceRoot) {\n    throw new Error(\"Subclasses must implement _parseMappings\");\n  };\n\nSourceMapConsumer.GENERATED_ORDER = 1;\nSourceMapConsumer.ORIGINAL_ORDER = 2;\n\nSourceMapConsumer.GREATEST_LOWER_BOUND = 1;\nSourceMapConsumer.LEAST_UPPER_BOUND = 2;\n\n/**\n * Iterate over each mapping between an original source/line/column and a\n * generated line/column in this source map.\n *\n * @param Function aCallback\n *        The function that is called with each mapping.\n * @param Object aContext\n *        Optional. If specified, this object will be the value of `this` every\n *        time that `aCallback` is called.\n * @param aOrder\n *        Either `SourceMapConsumer.GENERATED_ORDER` or\n *        `SourceMapConsumer.ORIGINAL_ORDER`. Specifies whether you want to\n *        iterate over the mappings sorted by the generated file's line/column\n *        order or the original's source/line/column order, respectively. Defaults to\n *        `SourceMapConsumer.GENERATED_ORDER`.\n */\nSourceMapConsumer.prototype.eachMapping =\n  function SourceMapConsumer_eachMapping(aCallback, aContext, aOrder) {\n    var context = aContext || null;\n    var order = aOrder || SourceMapConsumer.GENERATED_ORDER;\n\n    var mappings;\n    switch (order) {\n    case SourceMapConsumer.GENERATED_ORDER:\n      mappings = this._generatedMappings;\n      break;\n    case SourceMapConsumer.ORIGINAL_ORDER:\n      mappings = this._originalMappings;\n      break;\n    default:\n      throw new Error(\"Unknown order of iteration.\");\n    }\n\n    var sourceRoot = this.sourceRoot;\n    mappings.map(function (mapping) {\n      var source = mapping.source === null ? null : this._sources.at(mapping.source);\n      if (source != null && sourceRoot != null) {\n        source = util.join(sourceRoot, source);\n      }\n      return {\n        source: source,\n        generatedLine: mapping.generatedLine,\n        generatedColumn: mapping.generatedColumn,\n        originalLine: mapping.originalLine,\n        originalColumn: mapping.originalColumn,\n        name: mapping.name === null ? null : this._names.at(mapping.name)\n      };\n    }, this).forEach(aCallback, context);\n  };\n\n/**\n * Returns all generated line and column information for the original source,\n * line, and column provided. If no column is provided, returns all mappings\n * corresponding to a either the line we are searching for or the next\n * closest line that has any mappings. Otherwise, returns all mappings\n * corresponding to the given line and either the column we are searching for\n * or the next closest column that has any offsets.\n *\n * The only argument is an object with the following properties:\n *\n *   - source: The filename of the original source.\n *   - line: The line number in the original source.\n *   - column: Optional. the column number in the original source.\n *\n * and an array of objects is returned, each with the following properties:\n *\n *   - line: The line number in the generated source, or null.\n *   - column: The column number in the generated source, or null.\n */\nSourceMapConsumer.prototype.allGeneratedPositionsFor =\n  function SourceMapConsumer_allGeneratedPositionsFor(aArgs) {\n    var line = util.getArg(aArgs, 'line');\n\n    // When there is no exact match, BasicSourceMapConsumer.prototype._findMapping\n    // returns the index of the closest mapping less than the needle. By\n    // setting needle.originalColumn to 0, we thus find the last mapping for\n    // the given line, provided such a mapping exists.\n    var needle = {\n      source: util.getArg(aArgs, 'source'),\n      originalLine: line,\n      originalColumn: util.getArg(aArgs, 'column', 0)\n    };\n\n    if (this.sourceRoot != null) {\n      needle.source = util.relative(this.sourceRoot, needle.source);\n    }\n    if (!this._sources.has(needle.source)) {\n      return [];\n    }\n    needle.source = this._sources.indexOf(needle.source);\n\n    var mappings = [];\n\n    var index = this._findMapping(needle,\n                                  this._originalMappings,\n                                  \"originalLine\",\n                                  \"originalColumn\",\n                                  util.compareByOriginalPositions,\n                                  binarySearch.LEAST_UPPER_BOUND);\n    if (index >= 0) {\n      var mapping = this._originalMappings[index];\n\n      if (aArgs.column === undefined) {\n        var originalLine = mapping.originalLine;\n\n        // Iterate until either we run out of mappings, or we run into\n        // a mapping for a different line than the one we found. Since\n        // mappings are sorted, this is guaranteed to find all mappings for\n        // the line we found.\n        while (mapping && mapping.originalLine === originalLine) {\n          mappings.push({\n            line: util.getArg(mapping, 'generatedLine', null),\n            column: util.getArg(mapping, 'generatedColumn', null),\n            lastColumn: util.getArg(mapping, 'lastGeneratedColumn', null)\n          });\n\n          mapping = this._originalMappings[++index];\n        }\n      } else {\n        var originalColumn = mapping.originalColumn;\n\n        // Iterate until either we run out of mappings, or we run into\n        // a mapping for a different line than the one we were searching for.\n        // Since mappings are sorted, this is guaranteed to find all mappings for\n        // the line we are searching for.\n        while (mapping &&\n               mapping.originalLine === line &&\n               mapping.originalColumn == originalColumn) {\n          mappings.push({\n            line: util.getArg(mapping, 'generatedLine', null),\n            column: util.getArg(mapping, 'generatedColumn', null),\n            lastColumn: util.getArg(mapping, 'lastGeneratedColumn', null)\n          });\n\n          mapping = this._originalMappings[++index];\n        }\n      }\n    }\n\n    return mappings;\n  };\n\nexports.SourceMapConsumer = SourceMapConsumer;\n\n/**\n * A BasicSourceMapConsumer instance represents a parsed source map which we can\n * query for information about the original file positions by giving it a file\n * position in the generated source.\n *\n * The only parameter is the raw source map (either as a JSON string, or\n * already parsed to an object). According to the spec, source maps have the\n * following attributes:\n *\n *   - version: Which version of the source map spec this map is following.\n *   - sources: An array of URLs to the original source files.\n *   - names: An array of identifiers which can be referrenced by individual mappings.\n *   - sourceRoot: Optional. The URL root from which all sources are relative.\n *   - sourcesContent: Optional. An array of contents of the original source files.\n *   - mappings: A string of base64 VLQs which contain the actual mappings.\n *   - file: Optional. The generated file this source map is associated with.\n *\n * Here is an example source map, taken from the source map spec[0]:\n *\n *     {\n *       version : 3,\n *       file: \"out.js\",\n *       sourceRoot : \"\",\n *       sources: [\"foo.js\", \"bar.js\"],\n *       names: [\"src\", \"maps\", \"are\", \"fun\"],\n *       mappings: \"AA,AB;;ABCDE;\"\n *     }\n *\n * [0]: https://docs.google.com/document/d/1U1RGAehQwRypUTovF1KRlpiOFze0b-_2gc6fAH0KY0k/edit?pli=1#\n */\nfunction BasicSourceMapConsumer(aSourceMap) {\n  var sourceMap = aSourceMap;\n  if (typeof aSourceMap === 'string') {\n    sourceMap = JSON.parse(aSourceMap.replace(/^\\)\\]\\}'/, ''));\n  }\n\n  var version = util.getArg(sourceMap, 'version');\n  var sources = util.getArg(sourceMap, 'sources');\n  // Sass 3.3 leaves out the 'names' array, so we deviate from the spec (which\n  // requires the array) to play nice here.\n  var names = util.getArg(sourceMap, 'names', []);\n  var sourceRoot = util.getArg(sourceMap, 'sourceRoot', null);\n  var sourcesContent = util.getArg(sourceMap, 'sourcesContent', null);\n  var mappings = util.getArg(sourceMap, 'mappings');\n  var file = util.getArg(sourceMap, 'file', null);\n\n  // Once again, Sass deviates from the spec and supplies the version as a\n  // string rather than a number, so we use loose equality checking here.\n  if (version != this._version) {\n    throw new Error('Unsupported version: ' + version);\n  }\n\n  sources = sources\n    .map(String)\n    // Some source maps produce relative source paths like \"./foo.js\" instead of\n    // \"foo.js\".  Normalize these first so that future comparisons will succeed.\n    // See bugzil.la/1090768.\n    .map(util.normalize)\n    // Always ensure that absolute sources are internally stored relative to\n    // the source root, if the source root is absolute. Not doing this would\n    // be particularly problematic when the source root is a prefix of the\n    // source (valid, but why??). See github issue #199 and bugzil.la/1188982.\n    .map(function (source) {\n      return sourceRoot && util.isAbsolute(sourceRoot) && util.isAbsolute(source)\n        ? util.relative(sourceRoot, source)\n        : source;\n    });\n\n  // Pass `true` below to allow duplicate names and sources. While source maps\n  // are intended to be compressed and deduplicated, the TypeScript compiler\n  // sometimes generates source maps with duplicates in them. See Github issue\n  // #72 and bugzil.la/889492.\n  this._names = ArraySet.fromArray(names.map(String), true);\n  this._sources = ArraySet.fromArray(sources, true);\n\n  this.sourceRoot = sourceRoot;\n  this.sourcesContent = sourcesContent;\n  this._mappings = mappings;\n  this.file = file;\n}\n\nBasicSourceMapConsumer.prototype = Object.create(SourceMapConsumer.prototype);\nBasicSourceMapConsumer.prototype.consumer = SourceMapConsumer;\n\n/**\n * Create a BasicSourceMapConsumer from a SourceMapGenerator.\n *\n * @param SourceMapGenerator aSourceMap\n *        The source map that will be consumed.\n * @returns BasicSourceMapConsumer\n */\nBasicSourceMapConsumer.fromSourceMap =\n  function SourceMapConsumer_fromSourceMap(aSourceMap) {\n    var smc = Object.create(BasicSourceMapConsumer.prototype);\n\n    var names = smc._names = ArraySet.fromArray(aSourceMap._names.toArray(), true);\n    var sources = smc._sources = ArraySet.fromArray(aSourceMap._sources.toArray(), true);\n    smc.sourceRoot = aSourceMap._sourceRoot;\n    smc.sourcesContent = aSourceMap._generateSourcesContent(smc._sources.toArray(),\n                                                            smc.sourceRoot);\n    smc.file = aSourceMap._file;\n\n    // Because we are modifying the entries (by converting string sources and\n    // names to indices into the sources and names ArraySets), we have to make\n    // a copy of the entry or else bad things happen. Shared mutable state\n    // strikes again! See github issue #191.\n\n    var generatedMappings = aSourceMap._mappings.toArray().slice();\n    var destGeneratedMappings = smc.__generatedMappings = [];\n    var destOriginalMappings = smc.__originalMappings = [];\n\n    for (var i = 0, length = generatedMappings.length; i < length; i++) {\n      var srcMapping = generatedMappings[i];\n      var destMapping = new Mapping;\n      destMapping.generatedLine = srcMapping.generatedLine;\n      destMapping.generatedColumn = srcMapping.generatedColumn;\n\n      if (srcMapping.source) {\n        destMapping.source = sources.indexOf(srcMapping.source);\n        destMapping.originalLine = srcMapping.originalLine;\n        destMapping.originalColumn = srcMapping.originalColumn;\n\n        if (srcMapping.name) {\n          destMapping.name = names.indexOf(srcMapping.name);\n        }\n\n        destOriginalMappings.push(destMapping);\n      }\n\n      destGeneratedMappings.push(destMapping);\n    }\n\n    quickSort(smc.__originalMappings, util.compareByOriginalPositions);\n\n    return smc;\n  };\n\n/**\n * The version of the source mapping spec that we are consuming.\n */\nBasicSourceMapConsumer.prototype._version = 3;\n\n/**\n * The list of original sources.\n */\nObject.defineProperty(BasicSourceMapConsumer.prototype, 'sources', {\n  get: function () {\n    return this._sources.toArray().map(function (s) {\n      return this.sourceRoot != null ? util.join(this.sourceRoot, s) : s;\n    }, this);\n  }\n});\n\n/**\n * Provide the JIT with a nice shape / hidden class.\n */\nfunction Mapping() {\n  this.generatedLine = 0;\n  this.generatedColumn = 0;\n  this.source = null;\n  this.originalLine = null;\n  this.originalColumn = null;\n  this.name = null;\n}\n\n/**\n * Parse the mappings in a string in to a data structure which we can easily\n * query (the ordered arrays in the `this.__generatedMappings` and\n * `this.__originalMappings` properties).\n */\nBasicSourceMapConsumer.prototype._parseMappings =\n  function SourceMapConsumer_parseMappings(aStr, aSourceRoot) {\n    var generatedLine = 1;\n    var previousGeneratedColumn = 0;\n    var previousOriginalLine = 0;\n    var previousOriginalColumn = 0;\n    var previousSource = 0;\n    var previousName = 0;\n    var length = aStr.length;\n    var index = 0;\n    var cachedSegments = {};\n    var temp = {};\n    var originalMappings = [];\n    var generatedMappings = [];\n    var mapping, str, segment, end, value;\n\n    while (index < length) {\n      if (aStr.charAt(index) === ';') {\n        generatedLine++;\n        index++;\n        previousGeneratedColumn = 0;\n      }\n      else if (aStr.charAt(index) === ',') {\n        index++;\n      }\n      else {\n        mapping = new Mapping();\n        mapping.generatedLine = generatedLine;\n\n        // Because each offset is encoded relative to the previous one,\n        // many segments often have the same encoding. We can exploit this\n        // fact by caching the parsed variable length fields of each segment,\n        // allowing us to avoid a second parse if we encounter the same\n        // segment again.\n        for (end = index; end < length; end++) {\n          if (this._charIsMappingSeparator(aStr, end)) {\n            break;\n          }\n        }\n        str = aStr.slice(index, end);\n\n        segment = cachedSegments[str];\n        if (segment) {\n          index += str.length;\n        } else {\n          segment = [];\n          while (index < end) {\n            base64VLQ.decode(aStr, index, temp);\n            value = temp.value;\n            index = temp.rest;\n            segment.push(value);\n          }\n\n          if (segment.length === 2) {\n            throw new Error('Found a source, but no line and column');\n          }\n\n          if (segment.length === 3) {\n            throw new Error('Found a source and line, but no column');\n          }\n\n          cachedSegments[str] = segment;\n        }\n\n        // Generated column.\n        mapping.generatedColumn = previousGeneratedColumn + segment[0];\n        previousGeneratedColumn = mapping.generatedColumn;\n\n        if (segment.length > 1) {\n          // Original source.\n          mapping.source = previousSource + segment[1];\n          previousSource += segment[1];\n\n          // Original line.\n          mapping.originalLine = previousOriginalLine + segment[2];\n          previousOriginalLine = mapping.originalLine;\n          // Lines are stored 0-based\n          mapping.originalLine += 1;\n\n          // Original column.\n          mapping.originalColumn = previousOriginalColumn + segment[3];\n          previousOriginalColumn = mapping.originalColumn;\n\n          if (segment.length > 4) {\n            // Original name.\n            mapping.name = previousName + segment[4];\n            previousName += segment[4];\n          }\n        }\n\n        generatedMappings.push(mapping);\n        if (typeof mapping.originalLine === 'number') {\n          originalMappings.push(mapping);\n        }\n      }\n    }\n\n    quickSort(generatedMappings, util.compareByGeneratedPositionsDeflated);\n    this.__generatedMappings = generatedMappings;\n\n    quickSort(originalMappings, util.compareByOriginalPositions);\n    this.__originalMappings = originalMappings;\n  };\n\n/**\n * Find the mapping that best matches the hypothetical \"needle\" mapping that\n * we are searching for in the given \"haystack\" of mappings.\n */\nBasicSourceMapConsumer.prototype._findMapping =\n  function SourceMapConsumer_findMapping(aNeedle, aMappings, aLineName,\n                                         aColumnName, aComparator, aBias) {\n    // To return the position we are searching for, we must first find the\n    // mapping for the given position and then return the opposite position it\n    // points to. Because the mappings are sorted, we can use binary search to\n    // find the best mapping.\n\n    if (aNeedle[aLineName] <= 0) {\n      throw new TypeError('Line must be greater than or equal to 1, got '\n                          + aNeedle[aLineName]);\n    }\n    if (aNeedle[aColumnName] < 0) {\n      throw new TypeError('Column must be greater than or equal to 0, got '\n                          + aNeedle[aColumnName]);\n    }\n\n    return binarySearch.search(aNeedle, aMappings, aComparator, aBias);\n  };\n\n/**\n * Compute the last column for each generated mapping. The last column is\n * inclusive.\n */\nBasicSourceMapConsumer.prototype.computeColumnSpans =\n  function SourceMapConsumer_computeColumnSpans() {\n    for (var index = 0; index < this._generatedMappings.length; ++index) {\n      var mapping = this._generatedMappings[index];\n\n      // Mappings do not contain a field for the last generated columnt. We\n      // can come up with an optimistic estimate, however, by assuming that\n      // mappings are contiguous (i.e. given two consecutive mappings, the\n      // first mapping ends where the second one starts).\n      if (index + 1 < this._generatedMappings.length) {\n        var nextMapping = this._generatedMappings[index + 1];\n\n        if (mapping.generatedLine === nextMapping.generatedLine) {\n          mapping.lastGeneratedColumn = nextMapping.generatedColumn - 1;\n          continue;\n        }\n      }\n\n      // The last mapping for each line spans the entire line.\n      mapping.lastGeneratedColumn = Infinity;\n    }\n  };\n\n/**\n * Returns the original source, line, and column information for the generated\n * source's line and column positions provided. The only argument is an object\n * with the following properties:\n *\n *   - line: The line number in the generated source.\n *   - column: The column number in the generated source.\n *   - bias: Either 'SourceMapConsumer.GREATEST_LOWER_BOUND' or\n *     'SourceMapConsumer.LEAST_UPPER_BOUND'. Specifies whether to return the\n *     closest element that is smaller than or greater than the one we are\n *     searching for, respectively, if the exact element cannot be found.\n *     Defaults to 'SourceMapConsumer.GREATEST_LOWER_BOUND'.\n *\n * and an object is returned with the following properties:\n *\n *   - source: The original source file, or null.\n *   - line: The line number in the original source, or null.\n *   - column: The column number in the original source, or null.\n *   - name: The original identifier, or null.\n */\nBasicSourceMapConsumer.prototype.originalPositionFor =\n  function SourceMapConsumer_originalPositionFor(aArgs) {\n    var needle = {\n      generatedLine: util.getArg(aArgs, 'line'),\n      generatedColumn: util.getArg(aArgs, 'column')\n    };\n\n    var index = this._findMapping(\n      needle,\n      this._generatedMappings,\n      \"generatedLine\",\n      \"generatedColumn\",\n      util.compareByGeneratedPositionsDeflated,\n      util.getArg(aArgs, 'bias', SourceMapConsumer.GREATEST_LOWER_BOUND)\n    );\n\n    if (index >= 0) {\n      var mapping = this._generatedMappings[index];\n\n      if (mapping.generatedLine === needle.generatedLine) {\n        var source = util.getArg(mapping, 'source', null);\n        if (source !== null) {\n          source = this._sources.at(source);\n          if (this.sourceRoot != null) {\n            source = util.join(this.sourceRoot, source);\n          }\n        }\n        var name = util.getArg(mapping, 'name', null);\n        if (name !== null) {\n          name = this._names.at(name);\n        }\n        return {\n          source: source,\n          line: util.getArg(mapping, 'originalLine', null),\n          column: util.getArg(mapping, 'originalColumn', null),\n          name: name\n        };\n      }\n    }\n\n    return {\n      source: null,\n      line: null,\n      column: null,\n      name: null\n    };\n  };\n\n/**\n * Return true if we have the source content for every source in the source\n * map, false otherwise.\n */\nBasicSourceMapConsumer.prototype.hasContentsOfAllSources =\n  function BasicSourceMapConsumer_hasContentsOfAllSources() {\n    if (!this.sourcesContent) {\n      return false;\n    }\n    return this.sourcesContent.length >= this._sources.size() &&\n      !this.sourcesContent.some(function (sc) { return sc == null; });\n  };\n\n/**\n * Returns the original source content. The only argument is the url of the\n * original source file. Returns null if no original source content is\n * available.\n */\nBasicSourceMapConsumer.prototype.sourceContentFor =\n  function SourceMapConsumer_sourceContentFor(aSource, nullOnMissing) {\n    if (!this.sourcesContent) {\n      return null;\n    }\n\n    if (this.sourceRoot != null) {\n      aSource = util.relative(this.sourceRoot, aSource);\n    }\n\n    if (this._sources.has(aSource)) {\n      return this.sourcesContent[this._sources.indexOf(aSource)];\n    }\n\n    var url;\n    if (this.sourceRoot != null\n        && (url = util.urlParse(this.sourceRoot))) {\n      // XXX: file:// URIs and absolute paths lead to unexpected behavior for\n      // many users. We can help them out when they expect file:// URIs to\n      // behave like it would if they were running a local HTTP server. See\n      // https://bugzilla.mozilla.org/show_bug.cgi?id=885597.\n      var fileUriAbsPath = aSource.replace(/^file:\\/\\//, \"\");\n      if (url.scheme == \"file\"\n          && this._sources.has(fileUriAbsPath)) {\n        return this.sourcesContent[this._sources.indexOf(fileUriAbsPath)]\n      }\n\n      if ((!url.path || url.path == \"/\")\n          && this._sources.has(\"/\" + aSource)) {\n        return this.sourcesContent[this._sources.indexOf(\"/\" + aSource)];\n      }\n    }\n\n    // This function is used recursively from\n    // IndexedSourceMapConsumer.prototype.sourceContentFor. In that case, we\n    // don't want to throw if we can't find the source - we just want to\n    // return null, so we provide a flag to exit gracefully.\n    if (nullOnMissing) {\n      return null;\n    }\n    else {\n      throw new Error('\"' + aSource + '\" is not in the SourceMap.');\n    }\n  };\n\n/**\n * Returns the generated line and column information for the original source,\n * line, and column positions provided. The only argument is an object with\n * the following properties:\n *\n *   - source: The filename of the original source.\n *   - line: The line number in the original source.\n *   - column: The column number in the original source.\n *   - bias: Either 'SourceMapConsumer.GREATEST_LOWER_BOUND' or\n *     'SourceMapConsumer.LEAST_UPPER_BOUND'. Specifies whether to return the\n *     closest element that is smaller than or greater than the one we are\n *     searching for, respectively, if the exact element cannot be found.\n *     Defaults to 'SourceMapConsumer.GREATEST_LOWER_BOUND'.\n *\n * and an object is returned with the following properties:\n *\n *   - line: The line number in the generated source, or null.\n *   - column: The column number in the generated source, or null.\n */\nBasicSourceMapConsumer.prototype.generatedPositionFor =\n  function SourceMapConsumer_generatedPositionFor(aArgs) {\n    var source = util.getArg(aArgs, 'source');\n    if (this.sourceRoot != null) {\n      source = util.relative(this.sourceRoot, source);\n    }\n    if (!this._sources.has(source)) {\n      return {\n        line: null,\n        column: null,\n        lastColumn: null\n      };\n    }\n    source = this._sources.indexOf(source);\n\n    var needle = {\n      source: source,\n      originalLine: util.getArg(aArgs, 'line'),\n      originalColumn: util.getArg(aArgs, 'column')\n    };\n\n    var index = this._findMapping(\n      needle,\n      this._originalMappings,\n      \"originalLine\",\n      \"originalColumn\",\n      util.compareByOriginalPositions,\n      util.getArg(aArgs, 'bias', SourceMapConsumer.GREATEST_LOWER_BOUND)\n    );\n\n    if (index >= 0) {\n      var mapping = this._originalMappings[index];\n\n      if (mapping.source === needle.source) {\n        return {\n          line: util.getArg(mapping, 'generatedLine', null),\n          column: util.getArg(mapping, 'generatedColumn', null),\n          lastColumn: util.getArg(mapping, 'lastGeneratedColumn', null)\n        };\n      }\n    }\n\n    return {\n      line: null,\n      column: null,\n      lastColumn: null\n    };\n  };\n\nexports.BasicSourceMapConsumer = BasicSourceMapConsumer;\n\n/**\n * An IndexedSourceMapConsumer instance represents a parsed source map which\n * we can query for information. It differs from BasicSourceMapConsumer in\n * that it takes \"indexed\" source maps (i.e. ones with a \"sections\" field) as\n * input.\n *\n * The only parameter is a raw source map (either as a JSON string, or already\n * parsed to an object). According to the spec for indexed source maps, they\n * have the following attributes:\n *\n *   - version: Which version of the source map spec this map is following.\n *   - file: Optional. The generated file this source map is associated with.\n *   - sections: A list of section definitions.\n *\n * Each value under the \"sections\" field has two fields:\n *   - offset: The offset into the original specified at which this section\n *       begins to apply, defined as an object with a \"line\" and \"column\"\n *       field.\n *   - map: A source map definition. This source map could also be indexed,\n *       but doesn't have to be.\n *\n * Instead of the \"map\" field, it's also possible to have a \"url\" field\n * specifying a URL to retrieve a source map from, but that's currently\n * unsupported.\n *\n * Here's an example source map, taken from the source map spec[0], but\n * modified to omit a section which uses the \"url\" field.\n *\n *  {\n *    version : 3,\n *    file: \"app.js\",\n *    sections: [{\n *      offset: {line:100, column:10},\n *      map: {\n *        version : 3,\n *        file: \"section.js\",\n *        sources: [\"foo.js\", \"bar.js\"],\n *        names: [\"src\", \"maps\", \"are\", \"fun\"],\n *        mappings: \"AAAA,E;;ABCDE;\"\n *      }\n *    }],\n *  }\n *\n * [0]: https://docs.google.com/document/d/1U1RGAehQwRypUTovF1KRlpiOFze0b-_2gc6fAH0KY0k/edit#heading=h.535es3xeprgt\n */\nfunction IndexedSourceMapConsumer(aSourceMap) {\n  var sourceMap = aSourceMap;\n  if (typeof aSourceMap === 'string') {\n    sourceMap = JSON.parse(aSourceMap.replace(/^\\)\\]\\}'/, ''));\n  }\n\n  var version = util.getArg(sourceMap, 'version');\n  var sections = util.getArg(sourceMap, 'sections');\n\n  if (version != this._version) {\n    throw new Error('Unsupported version: ' + version);\n  }\n\n  this._sources = new ArraySet();\n  this._names = new ArraySet();\n\n  var lastOffset = {\n    line: -1,\n    column: 0\n  };\n  this._sections = sections.map(function (s) {\n    if (s.url) {\n      // The url field will require support for asynchronicity.\n      // See https://github.com/mozilla/source-map/issues/16\n      throw new Error('Support for url field in sections not implemented.');\n    }\n    var offset = util.getArg(s, 'offset');\n    var offsetLine = util.getArg(offset, 'line');\n    var offsetColumn = util.getArg(offset, 'column');\n\n    if (offsetLine < lastOffset.line ||\n        (offsetLine === lastOffset.line && offsetColumn < lastOffset.column)) {\n      throw new Error('Section offsets must be ordered and non-overlapping.');\n    }\n    lastOffset = offset;\n\n    return {\n      generatedOffset: {\n        // The offset fields are 0-based, but we use 1-based indices when\n        // encoding/decoding from VLQ.\n        generatedLine: offsetLine + 1,\n        generatedColumn: offsetColumn + 1\n      },\n      consumer: new SourceMapConsumer(util.getArg(s, 'map'))\n    }\n  });\n}\n\nIndexedSourceMapConsumer.prototype = Object.create(SourceMapConsumer.prototype);\nIndexedSourceMapConsumer.prototype.constructor = SourceMapConsumer;\n\n/**\n * The version of the source mapping spec that we are consuming.\n */\nIndexedSourceMapConsumer.prototype._version = 3;\n\n/**\n * The list of original sources.\n */\nObject.defineProperty(IndexedSourceMapConsumer.prototype, 'sources', {\n  get: function () {\n    var sources = [];\n    for (var i = 0; i < this._sections.length; i++) {\n      for (var j = 0; j < this._sections[i].consumer.sources.length; j++) {\n        sources.push(this._sections[i].consumer.sources[j]);\n      }\n    }\n    return sources;\n  }\n});\n\n/**\n * Returns the original source, line, and column information for the generated\n * source's line and column positions provided. The only argument is an object\n * with the following properties:\n *\n *   - line: The line number in the generated source.\n *   - column: The column number in the generated source.\n *\n * and an object is returned with the following properties:\n *\n *   - source: The original source file, or null.\n *   - line: The line number in the original source, or null.\n *   - column: The column number in the original source, or null.\n *   - name: The original identifier, or null.\n */\nIndexedSourceMapConsumer.prototype.originalPositionFor =\n  function IndexedSourceMapConsumer_originalPositionFor(aArgs) {\n    var needle = {\n      generatedLine: util.getArg(aArgs, 'line'),\n      generatedColumn: util.getArg(aArgs, 'column')\n    };\n\n    // Find the section containing the generated position we're trying to map\n    // to an original position.\n    var sectionIndex = binarySearch.search(needle, this._sections,\n      function(needle, section) {\n        var cmp = needle.generatedLine - section.generatedOffset.generatedLine;\n        if (cmp) {\n          return cmp;\n        }\n\n        return (needle.generatedColumn -\n                section.generatedOffset.generatedColumn);\n      });\n    var section = this._sections[sectionIndex];\n\n    if (!section) {\n      return {\n        source: null,\n        line: null,\n        column: null,\n        name: null\n      };\n    }\n\n    return section.consumer.originalPositionFor({\n      line: needle.generatedLine -\n        (section.generatedOffset.generatedLine - 1),\n      column: needle.generatedColumn -\n        (section.generatedOffset.generatedLine === needle.generatedLine\n         ? section.generatedOffset.generatedColumn - 1\n         : 0),\n      bias: aArgs.bias\n    });\n  };\n\n/**\n * Return true if we have the source content for every source in the source\n * map, false otherwise.\n */\nIndexedSourceMapConsumer.prototype.hasContentsOfAllSources =\n  function IndexedSourceMapConsumer_hasContentsOfAllSources() {\n    return this._sections.every(function (s) {\n      return s.consumer.hasContentsOfAllSources();\n    });\n  };\n\n/**\n * Returns the original source content. The only argument is the url of the\n * original source file. Returns null if no original source content is\n * available.\n */\nIndexedSourceMapConsumer.prototype.sourceContentFor =\n  function IndexedSourceMapConsumer_sourceContentFor(aSource, nullOnMissing) {\n    for (var i = 0; i < this._sections.length; i++) {\n      var section = this._sections[i];\n\n      var content = section.consumer.sourceContentFor(aSource, true);\n      if (content) {\n        return content;\n      }\n    }\n    if (nullOnMissing) {\n      return null;\n    }\n    else {\n      throw new Error('\"' + aSource + '\" is not in the SourceMap.');\n    }\n  };\n\n/**\n * Returns the generated line and column information for the original source,\n * line, and column positions provided. The only argument is an object with\n * the following properties:\n *\n *   - source: The filename of the original source.\n *   - line: The line number in the original source.\n *   - column: The column number in the original source.\n *\n * and an object is returned with the following properties:\n *\n *   - line: The line number in the generated source, or null.\n *   - column: The column number in the generated source, or null.\n */\nIndexedSourceMapConsumer.prototype.generatedPositionFor =\n  function IndexedSourceMapConsumer_generatedPositionFor(aArgs) {\n    for (var i = 0; i < this._sections.length; i++) {\n      var section = this._sections[i];\n\n      // Only consider this section if the requested source is in the list of\n      // sources of the consumer.\n      if (section.consumer.sources.indexOf(util.getArg(aArgs, 'source')) === -1) {\n        continue;\n      }\n      var generatedPosition = section.consumer.generatedPositionFor(aArgs);\n      if (generatedPosition) {\n        var ret = {\n          line: generatedPosition.line +\n            (section.generatedOffset.generatedLine - 1),\n          column: generatedPosition.column +\n            (section.generatedOffset.generatedLine === generatedPosition.line\n             ? section.generatedOffset.generatedColumn - 1\n             : 0)\n        };\n        return ret;\n      }\n    }\n\n    return {\n      line: null,\n      column: null\n    };\n  };\n\n/**\n * Parse the mappings in a string in to a data structure which we can easily\n * query (the ordered arrays in the `this.__generatedMappings` and\n * `this.__originalMappings` properties).\n */\nIndexedSourceMapConsumer.prototype._parseMappings =\n  function IndexedSourceMapConsumer_parseMappings(aStr, aSourceRoot) {\n    this.__generatedMappings = [];\n    this.__originalMappings = [];\n    for (var i = 0; i < this._sections.length; i++) {\n      var section = this._sections[i];\n      var sectionMappings = section.consumer._generatedMappings;\n      for (var j = 0; j < sectionMappings.length; j++) {\n        var mapping = sectionMappings[j];\n\n        var source = section.consumer._sources.at(mapping.source);\n        if (section.consumer.sourceRoot !== null) {\n          source = util.join(section.consumer.sourceRoot, source);\n        }\n        this._sources.add(source);\n        source = this._sources.indexOf(source);\n\n        var name = section.consumer._names.at(mapping.name);\n        this._names.add(name);\n        name = this._names.indexOf(name);\n\n        // The mappings coming from the consumer for the section have\n        // generated positions relative to the start of the section, so we\n        // need to offset them to be relative to the start of the concatenated\n        // generated file.\n        var adjustedMapping = {\n          source: source,\n          generatedLine: mapping.generatedLine +\n            (section.generatedOffset.generatedLine - 1),\n          generatedColumn: mapping.generatedColumn +\n            (section.generatedOffset.generatedLine === mapping.generatedLine\n            ? section.generatedOffset.generatedColumn - 1\n            : 0),\n          originalLine: mapping.originalLine,\n          originalColumn: mapping.originalColumn,\n          name: name\n        };\n\n        this.__generatedMappings.push(adjustedMapping);\n        if (typeof adjustedMapping.originalLine === 'number') {\n          this.__originalMappings.push(adjustedMapping);\n        }\n      }\n    }\n\n    quickSort(this.__generatedMappings, util.compareByGeneratedPositionsDeflated);\n    quickSort(this.__originalMappings, util.compareByOriginalPositions);\n  };\n\nexports.IndexedSourceMapConsumer = IndexedSourceMapConsumer;\n", "(function(root, factory) {\n    'use strict';\n    // Universal Module Definition (UMD) to support AMD, CommonJS/Node.js, Rhino, and browsers.\n\n    /* istanbul ignore next */\n    if (typeof define === 'function' && define.amd) {\n        define('stacktrace-gps', ['source-map', 'stackframe'], factory);\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('source-map/lib/source-map-consumer'), require('stackframe'));\n    } else {\n        root.StackTraceGPS = factory(root.SourceMap || root.sourceMap, root.StackFrame);\n    }\n}(this, function(SourceMap, StackFrame) {\n    'use strict';\n\n    /**\n     * Make a X-Domain request to url and callback.\n     *\n     * @param {String} url\n     * @returns {Promise} with response text if fulfilled\n     */\n    function _xdr(url) {\n        return new Promise(function(resolve, reject) {\n            var req = new XMLHttpRequest();\n            req.open('get', url);\n            req.onerror = reject;\n            req.onreadystatechange = function onreadystatechange() {\n                if (req.readyState === 4) {\n                    if ((req.status >= 200 && req.status < 300) ||\n                        (url.substr(0, 7) === 'file://' && req.responseText)) {\n                        resolve(req.responseText);\n                    } else {\n                        reject(new Error('HTTP status: ' + req.status + ' retrieving ' + url));\n                    }\n                }\n            };\n            req.send();\n        });\n\n    }\n\n    /**\n     * Convert a Base64-encoded string into its original representation.\n     * Used for inline sourcemaps.\n     *\n     * @param {String} b64str Base-64 encoded string\n     * @returns {String} original representation of the base64-encoded string.\n     */\n    function _atob(b64str) {\n        if (typeof window !== 'undefined' && window.atob) {\n            return window.atob(b64str);\n        } else {\n            throw new Error('You must supply a polyfill for window.atob in this environment');\n        }\n    }\n\n    function _parseJson(string) {\n        if (typeof JSON !== 'undefined' && JSON.parse) {\n            return JSON.parse(string);\n        } else {\n            throw new Error('You must supply a polyfill for JSON.parse in this environment');\n        }\n    }\n\n    function _findFunctionName(source, lineNumber/*, columnNumber*/) {\n        var syntaxes = [\n            // {name} = function ({args}) TODO args capture\n            /['\"]?([$_A-Za-z][$_A-Za-z0-9]*)['\"]?\\s*[:=]\\s*function\\b/,\n            // function {name}({args}) m[1]=name m[2]=args\n            /function\\s+([^('\"`]*?)\\s*\\(([^)]*)\\)/,\n            // {name} = eval()\n            /['\"]?([$_A-Za-z][$_A-Za-z0-9]*)['\"]?\\s*[:=]\\s*(?:eval|new Function)\\b/,\n            // fn_name() {\n            /\\b(?!(?:if|for|switch|while|with|catch)\\b)(?:(?:static)\\s+)?(\\S+)\\s*\\(.*?\\)\\s*\\{/,\n            // {name} = () => {\n            /['\"]?([$_A-Za-z][$_A-Za-z0-9]*)['\"]?\\s*[:=]\\s*\\(.*?\\)\\s*=>/\n        ];\n        var lines = source.split('\\n');\n\n        // Walk backwards in the source lines until we find the line which matches one of the patterns above\n        var code = '';\n        var maxLines = Math.min(lineNumber, 20);\n        for (var i = 0; i < maxLines; ++i) {\n            // lineNo is 1-based, source[] is 0-based\n            var line = lines[lineNumber - i - 1];\n            var commentPos = line.indexOf('//');\n            if (commentPos >= 0) {\n                line = line.substr(0, commentPos);\n            }\n\n            if (line) {\n                code = line + code;\n                var len = syntaxes.length;\n                for (var index = 0; index < len; index++) {\n                    var m = syntaxes[index].exec(code);\n                    if (m && m[1]) {\n                        return m[1];\n                    }\n                }\n            }\n        }\n        return undefined;\n    }\n\n    function _ensureSupportedEnvironment() {\n        if (typeof Object.defineProperty !== 'function' || typeof Object.create !== 'function') {\n            throw new Error('Unable to consume source maps in older browsers');\n        }\n    }\n\n    function _ensureStackFrameIsLegit(stackframe) {\n        if (typeof stackframe !== 'object') {\n            throw new TypeError('Given StackFrame is not an object');\n        } else if (typeof stackframe.fileName !== 'string') {\n            throw new TypeError('Given file name is not a String');\n        } else if (typeof stackframe.lineNumber !== 'number' ||\n            stackframe.lineNumber % 1 !== 0 ||\n            stackframe.lineNumber < 1) {\n            throw new TypeError('Given line number must be a positive integer');\n        } else if (typeof stackframe.columnNumber !== 'number' ||\n            stackframe.columnNumber % 1 !== 0 ||\n            stackframe.columnNumber < 0) {\n            throw new TypeError('Given column number must be a non-negative integer');\n        }\n        return true;\n    }\n\n    function _findSourceMappingURL(source) {\n        var sourceMappingUrlRegExp = /\\/\\/[#@] ?sourceMappingURL=([^\\s'\"]+)\\s*$/mg;\n        var lastSourceMappingUrl;\n        var matchSourceMappingUrl;\n        // eslint-disable-next-line no-cond-assign\n        while (matchSourceMappingUrl = sourceMappingUrlRegExp.exec(source)) {\n            lastSourceMappingUrl = matchSourceMappingUrl[1];\n        }\n        if (lastSourceMappingUrl) {\n            return lastSourceMappingUrl;\n        } else {\n            throw new Error('sourceMappingURL not found');\n        }\n    }\n\n    function _extractLocationInfoFromSourceMapSource(stackframe, sourceMapConsumer, sourceCache) {\n        return new Promise(function(resolve, reject) {\n            var loc = sourceMapConsumer.originalPositionFor({\n                line: stackframe.lineNumber,\n                column: stackframe.columnNumber\n            });\n\n            if (loc.source) {\n                // cache mapped sources\n                var mappedSource = sourceMapConsumer.sourceContentFor(loc.source);\n                if (mappedSource) {\n                    sourceCache[loc.source] = mappedSource;\n                }\n\n                resolve(\n                    // given stackframe and source location, update stackframe\n                    new StackFrame({\n                        functionName: loc.name || stackframe.functionName,\n                        args: stackframe.args,\n                        fileName: loc.source,\n                        lineNumber: loc.line,\n                        columnNumber: loc.column\n                    }));\n            } else {\n                reject(new Error('Could not get original source for given stackframe and source map'));\n            }\n        });\n    }\n\n    /**\n     * @constructor\n     * @param {Object} opts\n     *      opts.sourceCache = {url: \"Source String\"} => preload source cache\n     *      opts.sourceMapConsumerCache = {/path/file.js.map: SourceMapConsumer}\n     *      opts.offline = True to prevent network requests.\n     *              Best effort without sources or source maps.\n     *      opts.ajax = Promise returning function to make X-Domain requests\n     */\n    return function StackTraceGPS(opts) {\n        if (!(this instanceof StackTraceGPS)) {\n            return new StackTraceGPS(opts);\n        }\n        opts = opts || {};\n\n        this.sourceCache = opts.sourceCache || {};\n        this.sourceMapConsumerCache = opts.sourceMapConsumerCache || {};\n\n        this.ajax = opts.ajax || _xdr;\n\n        this._atob = opts.atob || _atob;\n\n        this._get = function _get(location) {\n            return new Promise(function(resolve, reject) {\n                var isDataUrl = location.substr(0, 5) === 'data:';\n                if (this.sourceCache[location]) {\n                    resolve(this.sourceCache[location]);\n                } else if (opts.offline && !isDataUrl) {\n                    reject(new Error('Cannot make network requests in offline mode'));\n                } else {\n                    if (isDataUrl) {\n                        // data URLs can have parameters.\n                        // see http://tools.ietf.org/html/rfc2397\n                        var supportedEncodingRegexp =\n                            /^data:application\\/json;([\\w=:\"-]+;)*base64,/;\n                        var match = location.match(supportedEncodingRegexp);\n                        if (match) {\n                            var sourceMapStart = match[0].length;\n                            var encodedSource = location.substr(sourceMapStart);\n                            var source = this._atob(encodedSource);\n                            this.sourceCache[location] = source;\n                            resolve(source);\n                        } else {\n                            reject(new Error('The encoding of the inline sourcemap is not supported'));\n                        }\n                    } else {\n                        var xhrPromise = this.ajax(location, {method: 'get'});\n                        // Cache the Promise to prevent duplicate in-flight requests\n                        this.sourceCache[location] = xhrPromise;\n                        xhrPromise.then(resolve, reject);\n                    }\n                }\n            }.bind(this));\n        };\n\n        /**\n         * Creating SourceMapConsumers is expensive, so this wraps the creation of a\n         * SourceMapConsumer in a per-instance cache.\n         *\n         * @param {String} sourceMappingURL = URL to fetch source map from\n         * @param {String} defaultSourceRoot = Default source root for source map if undefined\n         * @returns {Promise} that resolves a SourceMapConsumer\n         */\n        this._getSourceMapConsumer = function _getSourceMapConsumer(sourceMappingURL, defaultSourceRoot) {\n            return new Promise(function(resolve) {\n                if (this.sourceMapConsumerCache[sourceMappingURL]) {\n                    resolve(this.sourceMapConsumerCache[sourceMappingURL]);\n                } else {\n                    var sourceMapConsumerPromise = new Promise(function(resolve, reject) {\n                        return this._get(sourceMappingURL).then(function(sourceMapSource) {\n                            if (typeof sourceMapSource === 'string') {\n                                sourceMapSource = _parseJson(sourceMapSource.replace(/^\\)\\]\\}'/, ''));\n                            }\n                            if (typeof sourceMapSource.sourceRoot === 'undefined') {\n                                sourceMapSource.sourceRoot = defaultSourceRoot;\n                            }\n\n                            resolve(new SourceMap.SourceMapConsumer(sourceMapSource));\n                        }, reject);\n                    }.bind(this));\n                    this.sourceMapConsumerCache[sourceMappingURL] = sourceMapConsumerPromise;\n                    resolve(sourceMapConsumerPromise);\n                }\n            }.bind(this));\n        };\n\n        /**\n         * Given a StackFrame, enhance function name and use source maps for a\n         * better StackFrame.\n         *\n         * @param {StackFrame} stackframe object\n         * @returns {Promise} that resolves with with source-mapped StackFrame\n         */\n        this.pinpoint = function StackTraceGPS$$pinpoint(stackframe) {\n            return new Promise(function(resolve, reject) {\n                this.getMappedLocation(stackframe).then(function(mappedStackFrame) {\n                    function resolveMappedStackFrame() {\n                        resolve(mappedStackFrame);\n                    }\n\n                    this.findFunctionName(mappedStackFrame)\n                        .then(resolve, resolveMappedStackFrame)\n                        // eslint-disable-next-line no-unexpected-multiline\n                        ['catch'](resolveMappedStackFrame);\n                }.bind(this), reject);\n            }.bind(this));\n        };\n\n        /**\n         * Given a StackFrame, guess function name from location information.\n         *\n         * @param {StackFrame} stackframe\n         * @returns {Promise} that resolves with enhanced StackFrame.\n         */\n        this.findFunctionName = function StackTraceGPS$$findFunctionName(stackframe) {\n            return new Promise(function(resolve, reject) {\n                _ensureStackFrameIsLegit(stackframe);\n                this._get(stackframe.fileName).then(function getSourceCallback(source) {\n                    var lineNumber = stackframe.lineNumber;\n                    var columnNumber = stackframe.columnNumber;\n                    var guessedFunctionName = _findFunctionName(source, lineNumber, columnNumber);\n                    // Only replace functionName if we found something\n                    if (guessedFunctionName) {\n                        resolve(new StackFrame({\n                            functionName: guessedFunctionName,\n                            args: stackframe.args,\n                            fileName: stackframe.fileName,\n                            lineNumber: lineNumber,\n                            columnNumber: columnNumber\n                        }));\n                    } else {\n                        resolve(stackframe);\n                    }\n                }, reject)['catch'](reject);\n            }.bind(this));\n        };\n\n        /**\n         * Given a StackFrame, seek source-mapped location and return new enhanced StackFrame.\n         *\n         * @param {StackFrame} stackframe\n         * @returns {Promise} that resolves with enhanced StackFrame.\n         */\n        this.getMappedLocation = function StackTraceGPS$$getMappedLocation(stackframe) {\n            return new Promise(function(resolve, reject) {\n                _ensureSupportedEnvironment();\n                _ensureStackFrameIsLegit(stackframe);\n\n                var sourceCache = this.sourceCache;\n                var fileName = stackframe.fileName;\n                this._get(fileName).then(function(source) {\n                    var sourceMappingURL = _findSourceMappingURL(source);\n                    var isDataUrl = sourceMappingURL.substr(0, 5) === 'data:';\n                    var defaultSourceRoot = fileName.substring(0, fileName.lastIndexOf('/') + 1);\n\n                    if (sourceMappingURL[0] !== '/' && !isDataUrl && !(/^https?:\\/\\/|^\\/\\//i).test(sourceMappingURL)) {\n                        sourceMappingURL = defaultSourceRoot + sourceMappingURL;\n                    }\n\n                    return this._getSourceMapConsumer(sourceMappingURL, defaultSourceRoot)\n                        .then(function(sourceMapConsumer) {\n                            return _extractLocationInfoFromSourceMapSource(stackframe, sourceMapConsumer, sourceCache)\n                                .then(resolve)['catch'](function() {\n                                    resolve(stackframe);\n                                });\n                        });\n                }.bind(this), reject)['catch'](reject);\n            }.bind(this));\n        };\n    };\n}));\n", "(function(root, factory) {\n    'use strict';\n    // Universal Module Definition (UMD) to support AMD, CommonJS/Node.js, Rhino, and browsers.\n\n    /* istanbul ignore next */\n    if (typeof define === 'function' && define.amd) {\n        define('stacktrace', ['error-stack-parser', 'stack-generator', 'stacktrace-gps'], factory);\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('error-stack-parser'), require('stack-generator'), require('stacktrace-gps'));\n    } else {\n        root.StackTrace = factory(root.ErrorStackParser, root.StackGenerator, root.StackTraceGPS);\n    }\n}(this, function StackTrace(ErrorStackParser, StackGenerator, StackTraceGPS) {\n    var _options = {\n        filter: function(stackframe) {\n            // Filter out stackframes for this library by default\n            return (stackframe.functionName || '').indexOf('StackTrace$$') === -1 &&\n                (stackframe.functionName || '').indexOf('ErrorStackParser$$') === -1 &&\n                (stackframe.functionName || '').indexOf('StackTraceGPS$$') === -1 &&\n                (stackframe.functionName || '').indexOf('StackGenerator$$') === -1;\n        },\n        sourceCache: {}\n    };\n\n    var _generateError = function StackTrace$$GenerateError() {\n        try {\n            // Error must be thrown to get stack in IE\n            throw new Error();\n        } catch (err) {\n            return err;\n        }\n    };\n\n    /**\n     * Merge 2 given Objects. If a conflict occurs the second object wins.\n     * Does not do deep merges.\n     *\n     * @param {Object} first base object\n     * @param {Object} second overrides\n     * @returns {Object} merged first and second\n     * @private\n     */\n    function _merge(first, second) {\n        var target = {};\n\n        [first, second].forEach(function(obj) {\n            for (var prop in obj) {\n                if (Object.prototype.hasOwnProperty.call(obj, prop)) {\n                    target[prop] = obj[prop];\n                }\n            }\n            return target;\n        });\n\n        return target;\n    }\n\n    function _isShapedLikeParsableError(err) {\n        return err.stack || err['opera#sourceloc'];\n    }\n\n    function _filtered(stackframes, filter) {\n        if (typeof filter === 'function') {\n            return stackframes.filter(filter);\n        }\n        return stackframes;\n    }\n\n    return {\n        /**\n         * Get a backtrace from invocation point.\n         *\n         * @param {Object} opts\n         * @returns {Array} of StackFrame\n         */\n        get: function StackTrace$$get(opts) {\n            var err = _generateError();\n            return _isShapedLikeParsableError(err) ? this.fromError(err, opts) : this.generateArtificially(opts);\n        },\n\n        /**\n         * Get a backtrace from invocation point.\n         * IMPORTANT: Does not handle source maps or guess function names!\n         *\n         * @param {Object} opts\n         * @returns {Array} of StackFrame\n         */\n        getSync: function StackTrace$$getSync(opts) {\n            opts = _merge(_options, opts);\n            var err = _generateError();\n            var stack = _isShapedLikeParsableError(err) ? ErrorStackParser.parse(err) : StackGenerator.backtrace(opts);\n            return _filtered(stack, opts.filter);\n        },\n\n        /**\n         * Given an error object, parse it.\n         *\n         * @param {Error} error object\n         * @param {Object} opts\n         * @returns {Promise} for Array[StackFrame}\n         */\n        fromError: function StackTrace$$fromError(error, opts) {\n            opts = _merge(_options, opts);\n            var gps = new StackTraceGPS(opts);\n            return new Promise(function(resolve) {\n                var stackframes = _filtered(ErrorStackParser.parse(error), opts.filter);\n                resolve(Promise.all(stackframes.map(function(sf) {\n                    return new Promise(function(resolve) {\n                        function resolveOriginal() {\n                            resolve(sf);\n                        }\n\n                        gps.pinpoint(sf).then(resolve, resolveOriginal)['catch'](resolveOriginal);\n                    });\n                })));\n            }.bind(this));\n        },\n\n        /**\n         * Use StackGenerator to generate a backtrace.\n         *\n         * @param {Object} opts\n         * @returns {Promise} of Array[StackFrame]\n         */\n        generateArtificially: function StackTrace$$generateArtificially(opts) {\n            opts = _merge(_options, opts);\n            var stackFrames = StackGenerator.backtrace(opts);\n            if (typeof opts.filter === 'function') {\n                stackFrames = stackFrames.filter(opts.filter);\n            }\n            return Promise.resolve(stackFrames);\n        },\n\n        /**\n         * Given a function, wrap it such that invocations trigger a callback that\n         * is called with a stack trace.\n         *\n         * @param {Function} fn to be instrumented\n         * @param {Function} callback function to call with a stack trace on invocation\n         * @param {Function} errback optional function to call with error if unable to get stack trace.\n         * @param {Object} thisArg optional context object (e.g. window)\n         */\n        instrument: function StackTrace$$instrument(fn, callback, errback, thisArg) {\n            if (typeof fn !== 'function') {\n                throw new Error('Cannot instrument non-function object');\n            } else if (typeof fn.__stacktraceOriginalFn === 'function') {\n                // Already instrumented, return given Function\n                return fn;\n            }\n\n            var instrumented = function StackTrace$$instrumented() {\n                try {\n                    this.get().then(callback, errback)['catch'](errback);\n                    return fn.apply(thisArg || this, arguments);\n                } catch (e) {\n                    if (_isShapedLikeParsableError(e)) {\n                        this.fromError(e).then(callback, errback)['catch'](errback);\n                    }\n                    throw e;\n                }\n            }.bind(this);\n            instrumented.__stacktraceOriginalFn = fn;\n\n            return instrumented;\n        },\n\n        /**\n         * Given a function that has been instrumented,\n         * revert the function to it's original (non-instrumented) state.\n         *\n         * @param {Function} fn to de-instrument\n         */\n        deinstrument: function StackTrace$$deinstrument(fn) {\n            if (typeof fn !== 'function') {\n                throw new Error('Cannot de-instrument non-function object');\n            } else if (typeof fn.__stacktraceOriginalFn === 'function') {\n                return fn.__stacktraceOriginalFn;\n            } else {\n                // Function not instrumented, return original\n                return fn;\n            }\n        },\n\n        /**\n         * Given an error message and Array of StackFrames, serialize and POST to given URL.\n         *\n         * @param {Array} stackframes\n         * @param {String} url\n         * @param {String} errorMsg\n         * @param {Object} requestOptions\n         */\n        report: function StackTrace$$report(stackframes, url, errorMsg, requestOptions) {\n            return new Promise(function(resolve, reject) {\n                var req = new XMLHttpRequest();\n                req.onerror = reject;\n                req.onreadystatechange = function onreadystatechange() {\n                    if (req.readyState === 4) {\n                        if (req.status >= 200 && req.status < 400) {\n                            resolve(req.responseText);\n                        } else {\n                            reject(new Error('POST to ' + url + ' failed with status: ' + req.status));\n                        }\n                    }\n                };\n                req.open('post', url);\n\n                // Set request headers\n                req.setRequestHeader('Content-Type', 'application/json');\n                if (requestOptions && typeof requestOptions.headers === 'object') {\n                    var headers = requestOptions.headers;\n                    for (var header in headers) {\n                        if (Object.prototype.hasOwnProperty.call(headers, header)) {\n                            req.setRequestHeader(header, headers[header]);\n                        }\n                    }\n                }\n\n                var reportPayload = {stack: stackframes};\n                if (errorMsg !== undefined && errorMsg !== null) {\n                    reportPayload.message = errorMsg;\n                }\n\n                req.send(JSON.stringify(reportPayload));\n            });\n        }\n    };\n}));\n", "import StackTrace from \"stacktrace-js\";\nimport kaboom from \"kaboom\";\n\nwindow.kaboom = kaboom;\n\n// report error to server\nwindow.addEventListener(\"error\", (e) => {\n    StackTrace\n\t\t.fromError(e.error)\n\t\t.then((stack) => {\n\t\t\tfetch(\"/error\", {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\tmsg: e.error.message,\n\t\t\t\t\tstack: stack.slice(0, 4).map((step) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t...step,\n\t\t\t\t\t\t\tfile: step.fileName.replace(location.origin + \"/\", \"\"),\n\t\t\t\t\t\t\tline: step.lineNumber,\n\t\t\t\t\t\t\tcol: step.columnNumber,\n\t\t\t\t\t\t};\n\t\t\t\t\t}),\n\t\t\t\t}),\n\t\t\t});\n\t\t})\n\t\t.catch(() => console.error(\"failed to parse err\"));\n});\n\n// listen for live reload msg\nconst wsp = location.protocol === \"https:\" ? \"wss\" : \"ws\";\nconst devws = new WebSocket(`${wsp}://${location.host}/devws`);\n\ndevws.onmessage = (e) => {\n\tconst msg = JSON.parse(e.data);\n\tif (msg === \"REFRESH\") {\n\t\tlocation.reload();\n\t}\n};\n\n// replit auth\nwindow.replit = {\n\n\tuser: null,\n\n\tgetUser() {\n\t\treturn fetch(\"/user\")\n\t\t\t.then((res) => res.json())\n\t\t\t.then((user) => {\n\t\t\t\tif (user) {\n\t\t\t\t\tthis.user = user;\n\t\t\t\t\treturn Promise.resolve(this.user);\n\t\t\t\t} else {\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\t},\n\n\tauthed() {\n\t\treturn this.user !== null;\n\t},\n\n\tauth() {\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tif (this.authed()) {\n\t\t\t\tresolve(this.user);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst authComplete = (e) => {\n\t\t\t\tif (e.data !== \"auth_complete\") {\n\t\t\t\t\tresolve(null);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\twindow.removeEventListener(\"message\", authComplete);\n\t\t\t\tauthWindow.close();\n\t\t\t\tthis.getUser().then(resolve);\n\t\t\t};\n\n\t\t\twindow.addEventListener(\"message\", authComplete);\n\n\t\t\tconst w = 320;\n\t\t\tconst h = 480;\n\t\t\tconst left = (screen.width / 2) - (w / 2);\n\t\t\tconst top = (screen.height / 2) - (h / 2);\n\n\t\t\tconst authWindow = window.open(\n\t\t\t\t`https://repl.it/auth_with_repl_site?domain=${location.host}`,\n\t\t\t\t\"_blank\",\n\t\t\t\t`modal=yes, toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=${w}, height=${h}, top=${top}, left=${left}`\n\t\t\t);\n\n\t\t});\n\n\t},\n\n};\n\n// replit db\nwindow.db = {\n\n\tgetData(key, def) {\n\t\treturn fetch(`/db/${key}`)\n\t\t\t.then((res) => res.json())\n\t\t\t.then((val) => {\n\t\t\t\t// set default value if empty\n\t\t\t\tif (val == null && def !== undefined) {\n\t\t\t\t\treturn this.setData(key, def);\n\t\t\t\t}\n\t\t\t\treturn Promise.resolve(val);\n\t\t\t});\n\t},\n\n\tsetData(key, val) {\n\t\treturn fetch(`/db/${key}`, {\n\t\t\tmethod: \"POST\",\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t},\n\t\t\tbody: JSON.stringify(val),\n\t\t}).then(() => Promise.resolve(val));\n\t},\n\n};\n\nreplit.getUser();\n", "function deg2rad(deg: number): number {\n\treturn deg * Math.PI / 180;\n}\n\nfunction rad2deg(rad: number): number {\n\treturn rad * 180 / Math.PI;\n}\n\nfunction clamp(\n\tval: number,\n\tmin: number,\n\tmax: number,\n): number {\n\tif (min > max) {\n\t\treturn clamp(val, max, min);\n\t}\n\treturn Math.min(Math.max(val, min), max);\n}\n\nfunction lerp(\n\ta: number,\n\tb: number,\n\tt: number,\n): number {\n\treturn a + (b - a) * t;\n}\n\nfunction map(\n\tv: number,\n\tl1: number,\n\th1: number,\n\tl2: number,\n\th2: number,\n): number {\n\treturn l2 + (v - l1) / (h1 - l1) * (h2 - l2);\n}\n\nfunction mapc(\n\tv: number,\n\tl1: number,\n\th1: number,\n\tl2: number,\n\th2: number,\n): number {\n\treturn clamp(map(v, l1, h1, l2, h2), l2, h2);\n}\n\nfunction vec2(...args): Vec2 {\n\n\tif (args.length === 0) {\n\t\treturn vec2(0, 0);\n\t}\n\n\tif (args.length === 1) {\n\t\tif (typeof args[0] === \"number\") {\n\t\t\treturn vec2(args[0], args[0]);\n\t\t} else if (isVec2(args[0])) {\n\t\t\treturn vec2(args[0].x, args[0].y);\n\t\t} else if (Array.isArray(args[0]) && args[0].length === 2) {\n\t\t\treturn vec2.apply(null, args[0]);\n\t\t}\n\t}\n\n\treturn {\n\t\tx: args[0],\n\t\ty: args[1],\n\t\tclone(): Vec2 {\n\t\t\treturn vec2(this.x, this.y);\n\t\t},\n\t\tadd(...args): Vec2 {\n\t\t\tconst p2 = vec2(...args);\n\t\t\treturn vec2(this.x + p2.x, this.y + p2.y);\n\t\t},\n\t\tsub(...args): Vec2 {\n\t\t\tconst p2 = vec2(...args);\n\t\t\treturn vec2(this.x - p2.x, this.y - p2.y);\n\t\t},\n\t\tscale(...args): Vec2 {\n\t\t\tconst s = vec2(...args);\n\t\t\treturn vec2(this.x * s.x, this.y * s.y);\n\t\t},\n\t\tdist(...args): number {\n\t\t\tconst p2 = vec2(...args);\n\t\t\treturn Math.sqrt(\n\t\t\t\t(this.x - p2.x) * (this.x - p2.x)\n\t\t\t\t+ (this.y - p2.y) * (this.y - p2.y)\n\t\t\t);\n\t\t},\n\t\tlen(): number {\n\t\t\treturn this.dist(vec2(0, 0));\n\t\t},\n\t\tunit(): Vec2 {\n\t\t\treturn this.scale(1 / this.len());\n\t\t},\n\t\tnormal(): Vec2 {\n\t\t\treturn vec2(this.y, -this.x);\n\t\t},\n\t\tdot(p2: Vec2): number {\n\t\t\treturn this.x * p2.x + this.y * p2.y;\n\t\t},\n\t\tangle(...args): number {\n\t\t\tconst p2 = vec2(...args);\n\t\t\treturn Math.atan2(this.y - p2.y, this.x - p2.x);\n\t\t},\n\t\tlerp(p2: Vec2, t: number): Vec2 {\n\t\t\treturn vec2(lerp(this.x, p2.x, t), lerp(this.y, p2.y, t));\n\t\t},\n\t\ttoFixed(n: number): Vec2 {\n\t\t\treturn vec2(this.x.toFixed(n), this.y.toFixed(n));\n\t\t},\n\t\teq(other: Vec2): boolean {\n\t\t\treturn this.x === other.x && this.y === other.y;\n\t\t},\n\t\tstr(): string {\n\t\t\treturn `(${this.x}, ${this.y})`;\n\t\t},\n\t};\n}\n\nfunction vec2FromAngle(a: number): Vec2 {\n\treturn vec2(Math.cos(a), Math.sin(a));\n}\n\nfunction vec3(x: number, y: number, z: number): Vec3 {\n\treturn {\n\t\tx: x,\n\t\ty: y,\n\t\tz: z,\n\t\txy(): Vec2 {\n\t\t\treturn vec2(this.x, this.y);\n\t\t},\n\t};\n}\n\nfunction isVec2(p: any): boolean {\n\treturn p !== undefined\n\t\t&& p.x !== undefined\n\t\t&& p.y !== undefined\n\t\t;\n}\n\nfunction isVec3(p: any): boolean {\n\treturn p !== undefined\n\t\t&& p.x !== undefined\n\t\t&& p.y !== undefined\n\t\t&& p.z !== undefined\n\t\t;\n}\n\nfunction isColor(c: any): boolean {\n\treturn c !== undefined\n\t\t&& c.r !== undefined\n\t\t&& c.g !== undefined\n\t\t&& c.b !== undefined\n\t\t&& c.a !== undefined\n\t\t;\n}\n\nfunction isMat4(m: any): Mat4 {\n\tif (\n\t\tm !== undefined\n\t\t&& Array.isArray(m.m)\n\t\t&& m.m.length === 16\n\t) {\n\t\treturn m;\n\t}\n}\n\nfunction rgb(...args): Color {\n\tif (args.length === 0) {\n\t\treturn rgba();\n\t} else if (args.length === 1) {\n\t\tif (isColor(args[0])) {\n\t\t\treturn rgba(args[0]);\n\t\t} else if (Array.isArray(args[0]) && args[0].length === 3) {\n\t\t\treturn rgb.apply(null, args[0])\n\t\t}\n\t}\n\treturn rgba(args[0], args[1], args[2], 1);\n}\n\nfunction rgba(...args): Color {\n\n\tif (args.length === 0) {\n\t\treturn rgba(1, 1, 1, 1);\n\t} else if (args.length === 1) {\n\t\tif (isColor(args[0])) {\n\t\t\treturn rgba(args[0].r, args[0].g, args[0].b, args[0].a);\n\t\t} else if (Array.isArray(args[0]) && args[0].length === 4) {\n\t\t\treturn rgba.apply(null, args[0]);\n\t\t}\n\t}\n\n\treturn {\n\t\tr: args[0],\n\t\tg: args[1],\n\t\tb: args[2],\n\t\ta: args[3] ?? 1,\n\t\tclone(): Color {\n\t\t\treturn rgba(this.r, this.g, this.b, this.a);\n\t\t},\n\t\tlighten(a): Color {\n\t\t\treturn rgba(this.r + a, this.g + a, this.b + a, this.a);\n\t\t},\n\t\tdarken(a: number): Color {\n\t\t\treturn this.lighten(-a);\n\t\t},\n\t\tinvert(): Color {\n\t\t\treturn rgba(1 - this.r, 1 - this.g, 1 - this.b, this.a);\n\t\t},\n\t\tisDark(p: number = 0.5): boolean {\n\t\t\treturn this.r + this.g + this.b < 3 * p;\n\t\t},\n\t\tisLight(p: number = 0.5): boolean {\n\t\t\treturn this.r + this.g + this.b > 3 * p;\n\t\t},\n\t\teq(other: Color): boolean {\n\t\t\treturn this.r === other.r\n\t\t\t\t&& this.g === other.g\n\t\t\t\t&& this.b === other.g\n\t\t\t\t&& this.a === other.a;\n\t\t},\n\t};\n\n}\n\nfunction quad(x: number, y: number, w: number, h: number): Quad {\n\treturn {\n\t\tx: x,\n\t\ty: y,\n\t\tw: w,\n\t\th: h,\n\t\tscale(other: Quad): Quad {\n\t\t\treturn quad(\n\t\t\t\tthis.x + this.w * other.x,\n\t\t\t\tthis.y + this.h * other.y,\n\t\t\t\tthis.w * other.w,\n\t\t\t\tthis.h * other.h\n\t\t\t);\n\t\t},\n\t\tclone(): Quad {\n\t\t\treturn quad(this.x, this.y, this.w, this.h);\n\t\t},\n\t\teq(other: Quad): boolean {\n\t\t\treturn this.x === other.x\n\t\t\t\t&& this.y === other.y\n\t\t\t\t&& this.w === other.w\n\t\t\t\t&& this.h === other.h;\n\t\t},\n\t};\n}\n\nfunction mat4(m?: number[]): Mat4 {\n\n\treturn {\n\n\t\tm: m ? [...m] : [\n\t\t\t1, 0, 0, 0,\n\t\t\t0, 1, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1,\n\t\t],\n\n\t\tclone(): Mat4 {\n\t\t\treturn mat4(this.m);\n\t\t},\n\n\t\tmult(other: Mat4): Mat4 {\n\n\t\t\tconst out = [];\n\n\t\t\tfor (let i = 0; i < 4; i++) {\n\t\t\t\tfor (let j = 0; j < 4; j++) {\n\t\t\t\t\tout[i * 4 + j] =\n\t\t\t\t\t\tthis.m[0 * 4 + j] * other.m[i * 4 + 0] +\n\t\t\t\t\t\tthis.m[1 * 4 + j] * other.m[i * 4 + 1] +\n\t\t\t\t\t\tthis.m[2 * 4 + j] * other.m[i * 4 + 2] +\n\t\t\t\t\t\tthis.m[3 * 4 + j] * other.m[i * 4 + 3];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn mat4(out);\n\n\t\t},\n\n\t\tmultVec4(p: Vec4): Vec4 {\n\t\t\treturn {\n\t\t\t\tx: p.x * this.m[0] + p.y * this.m[4] + p.z * this.m[8] + p.w * this.m[12],\n\t\t\t\ty: p.x * this.m[1] + p.y * this.m[5] + p.z * this.m[9] + p.w * this.m[13],\n\t\t\t\tz: p.x * this.m[2] + p.y * this.m[6] + p.z * this.m[10] + p.w * this.m[14],\n\t\t\t\tw: p.x * this.m[3] + p.y * this.m[7] + p.z * this.m[11] + p.w * this.m[15]\n\t\t\t};\n\t\t},\n\n\t\tmultVec3(p: Vec3): Vec3 {\n\t\t\tconst p4 = this.multVec4({\n\t\t\t\tx: p.x,\n\t\t\t\ty: p.y,\n\t\t\t\tz: p.z,\n\t\t\t\tw: 1.0,\n\t\t\t});\n\t\t\treturn vec3(p4.x, p4.y, p4.z);\n\t\t},\n\n\t\tmultVec2(p: Vec2): Vec2 {\n\t\t\treturn vec2(\n\t\t\t\tp.x * this.m[0] + p.y * this.m[4] + 0 * this.m[8] + 1 * this.m[12],\n\t\t\t\tp.x * this.m[1] + p.y * this.m[5] + 0 * this.m[9] + 1 * this.m[13],\n\t\t\t);\n\t\t},\n\n\t\ttranslate(p: Vec2): Mat4 {\n\t\t\treturn this.mult(mat4([\n\t\t\t\t1, 0, 0, 0,\n\t\t\t\t0, 1, 0, 0,\n\t\t\t\t0, 0, 1, 0,\n\t\t\t\tp.x, p.y, 0, 1,\n\t\t\t]));\n\t\t},\n\n\t\tscale(s: Vec2): Mat4 {\n\t\t\treturn this.mult(mat4([\n\t\t\t\ts.x, 0, 0, 0,\n\t\t\t\t0, s.y, 0, 0,\n\t\t\t\t0, 0, 1, 0,\n\t\t\t\t0, 0, 0, 1,\n\t\t\t]));\n\t\t},\n\n\t\trotateX(a: number): Mat4 {\n\t\t\treturn this.mult(mat4([\n\t\t\t\t1, 0, 0, 0,\n\t\t\t\t0, Math.cos(a), -Math.sin(a), 0,\n\t\t\t\t0, Math.sin(a), Math.cos(a), 0,\n\t\t\t\t0, 0, 0, 1,\n\t\t\t]));\n\t\t},\n\n\t\trotateY(a: number): Mat4 {\n\t\t\treturn this.mult(mat4([\n\t\t\t\tMath.cos(a), 0, -Math.sin(a), 0,\n\t\t\t\t0, 1, 0, 0,\n\t\t\t\tMath.sin(a), 0, Math.cos(a), 0,\n\t\t\t\t0, 0, 0, 1,\n\t\t\t]));\n\t\t},\n\n\t\trotateZ(a: number): Mat4 {\n\t\t\treturn this.mult(mat4([\n\t\t\t\tMath.cos(a), -Math.sin(a), 0, 0,\n\t\t\t\tMath.sin(a), Math.cos(a), 0, 0,\n\t\t\t\t0, 0, 1, 0,\n\t\t\t\t0, 0, 0, 1,\n\t\t\t]));\n\t\t},\n\n\t\tinvert(): Mat4 {\n\n\t\t\tconst out = [];\n\n\t\t\tconst f00 = this.m[10] * this.m[15] - this.m[14] * this.m[11];\n\t\t\tconst f01 = this.m[9] * this.m[15] - this.m[13] * this.m[11];\n\t\t\tconst f02 = this.m[9] * this.m[14] - this.m[13] * this.m[10];\n\t\t\tconst f03 = this.m[8] * this.m[15] - this.m[12] * this.m[11];\n\t\t\tconst f04 = this.m[8] * this.m[14] - this.m[12] * this.m[10];\n\t\t\tconst f05 = this.m[8] * this.m[13] - this.m[12] * this.m[9];\n\t\t\tconst f06 = this.m[6] * this.m[15] - this.m[14] * this.m[7];\n\t\t\tconst f07 = this.m[5] * this.m[15] - this.m[13] * this.m[7];\n\t\t\tconst f08 = this.m[5] * this.m[14] - this.m[13] * this.m[6];\n\t\t\tconst f09 = this.m[4] * this.m[15] - this.m[12] * this.m[7];\n\t\t\tconst f10 = this.m[4] * this.m[14] - this.m[12] * this.m[6];\n\t\t\tconst f11 = this.m[5] * this.m[15] - this.m[13] * this.m[7];\n\t\t\tconst f12 = this.m[4] * this.m[13] - this.m[12] * this.m[5];\n\t\t\tconst f13 = this.m[6] * this.m[11] - this.m[10] * this.m[7];\n\t\t\tconst f14 = this.m[5] * this.m[11] - this.m[9] * this.m[7];\n\t\t\tconst f15 = this.m[5] * this.m[10] - this.m[9] * this.m[6];\n\t\t\tconst f16 = this.m[4] * this.m[11] - this.m[8] * this.m[7];\n\t\t\tconst f17 = this.m[4] * this.m[10] - this.m[8] * this.m[6];\n\t\t\tconst f18 = this.m[4] * this.m[9] - this.m[8] * this.m[5];\n\n\t\t\tout[0] = this.m[5] * f00 - this.m[6] * f01 + this.m[7] * f02;\n\t\t\tout[4] = -(this.m[4] * f00 - this.m[6] * f03 + this.m[7] * f04);\n\t\t\tout[8] = this.m[4] * f01 - this.m[5] * f03 + this.m[7] * f05;\n\t\t\tout[12] = -(this.m[4] * f02 - this.m[5] * f04 + this.m[6] * f05);\n\n\t\t\tout[1] = -(this.m[1] * f00 - this.m[2] * f01 + this.m[3] * f02);\n\t\t\tout[5] = this.m[0] * f00 - this.m[2] * f03 + this.m[3] * f04;\n\t\t\tout[9] = -(this.m[0] * f01 - this.m[1] * f03 + this.m[3] * f05);\n\t\t\tout[13] = this.m[0] * f02 - this.m[1] * f04 + this.m[2] * f05;\n\n\t\t\tout[2] = this.m[1] * f06 - this.m[2] * f07 + this.m[3] * f08;\n\t\t\tout[6] = -(this.m[0] * f06 - this.m[2] * f09 + this.m[3] * f10);\n\t\t\tout[10] = this.m[0] * f11 - this.m[1] * f09 + this.m[3] * f12;\n\t\t\tout[14] = -(this.m[0] * f08 - this.m[1] * f10 + this.m[2] * f12);\n\n\t\t\tout[3] = -(this.m[1] * f13 - this.m[2] * f14 + this.m[3] * f15);\n\t\t\tout[7] = this.m[0] * f13 - this.m[2] * f16 + this.m[3] * f17;\n\t\t\tout[11] = -(this.m[0] * f14 - this.m[1] * f16 + this.m[3] * f18);\n\t\t\tout[15] = this.m[0] * f15 - this.m[1] * f17 + this.m[2] * f18;\n\n\t\t\tconst det =\n\t\t\t\tthis.m[0] * out[0] +\n\t\t\t\tthis.m[1] * out[4] +\n\t\t\t\tthis.m[2] * out[8] +\n\t\t\t\tthis.m[3] * out[12];\n\n\t\t\tfor (let i = 0; i < 4; i++) {\n\t\t\t\tfor (let j = 0; j < 4; j++) {\n\t\t\t\t\tout[i * 4 + j] *= (1.0 / det);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn mat4(out);\n\n\t\t},\n\n\t};\n\n}\n\n// easy sine wave\nfunction wave(lo: number, hi: number, t: number): number {\n\treturn lo + (Math.sin(t) + 1) / 2 * (hi - lo);\n}\n\n// basic ANSI C LCG\nconst A = 1103515245;\nconst C = 12345;\nconst M = 2147483648;\nconst defRNG = makeRng(Date.now());\n\nfunction makeRng(seed: number): RNG {\n\treturn {\n\t\tseed: seed,\n\t\tgen(...args) {\n\t\t\tif (args.length === 0) {\n\t\t\t\t// generate 0 - 1\n\t\t\t\tthis.seed = (A * this.seed + C) % M;\n\t\t\t\treturn this.seed / M;\n\t\t\t} else if (args.length === 1) {\n\t\t\t\tif (typeof args[0] === \"number\") {\n\t\t\t\t\treturn this.gen(0, args[0]);\n\t\t\t\t} else if (isVec2(args[0])) {\n\t\t\t\t\treturn this.gen(vec2(0, 0), args[0]);\n\t\t\t\t} else if (isColor(args[0])) {\n\t\t\t\t\treturn this.gen(rgba(0, 0, 0, 0), args[0]);\n\t\t\t\t}\n\t\t\t} else if (args.length === 2) {\n\t\t\t\tif (typeof args[0] === \"number\" && typeof args[1] === \"number\") {\n\t\t\t\t\treturn this.gen() * (args[1] - args[0]) + args[0];\n\t\t\t\t} else if (isVec2(args[0]) && isVec2(args[1])) {\n\t\t\t\t\treturn vec2(\n\t\t\t\t\t\tthis.gen(args[0].x, args[1].x),\n\t\t\t\t\t\tthis.gen(args[0].y, args[1].y),\n\t\t\t\t\t);\n\t\t\t\t} else if (isColor(args[0]) && isColor(args[1])) {\n\t\t\t\t\treturn rgba(\n\t\t\t\t\t\tthis.gen(args[0].r, args[1].r),\n\t\t\t\t\t\tthis.gen(args[0].g, args[1].g),\n\t\t\t\t\t\tthis.gen(args[0].b, args[1].b),\n\t\t\t\t\t\tthis.gen(args[0].a, args[1].a),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t};\n}\n\nfunction randSeed(seed: number): number {\n\tif (seed != null) {\n\t\tdefRNG.seed = seed;\n\t}\n\treturn defRNG.seed;\n}\n\nfunction rand(...args) {\n\t// @ts-ignore\n\treturn defRNG.gen(...args);\n}\n\nfunction chance(p: number): boolean {\n\treturn rand() <= p;\n}\n\nfunction choose<T>(list: T[]): T {\n\treturn list[Math.floor(rand(list.length))];\n}\n\nfunction colRectRect(r1: Rect, r2: Rect): boolean {\n\treturn r1.p2.x >= r2.p1.x\n\t\t&& r1.p1.x <= r2.p2.x\n\t\t&& r1.p2.y >= r2.p1.y\n\t\t&& r1.p1.y <= r2.p2.y;\n}\n\nfunction overlapRectRect(r1: Rect, r2: Rect): boolean {\n\treturn r1.p2.x > r2.p1.x\n\t\t&& r1.p1.x < r2.p2.x\n\t\t&& r1.p2.y > r2.p1.y\n\t\t&& r1.p1.y < r2.p2.y;\n}\n\nfunction colLineLine(l1: Line, l2: Line): boolean {\n\tconst a =\n\t\t(\n\t\t\t(l2.p2.x - l2.p1.x)\n\t\t\t* (l1.p1.y - l2.p1.y)\n\t\t\t- (l2.p2.y - l2.p1.y)\n\t\t\t* (l1.p1.x - l2.p1.x)\n\t\t)\n\t\t/\n\t\t(\n\t\t\t(l2.p2.y - l2.p1.y)\n\t\t\t* (l1.p2.x - l1.p1.x)\n\t\t\t- (l2.p2.x - l2.p1.x)\n\t\t\t* (l1.p2.y - l1.p1.y)\n\t\t);\n\tconst b =\n\t\t(\n\t\t\t(l1.p2.x - l1.p1.x)\n\t\t\t* (l1.p1.y - l2.p1.y)\n\t\t\t- (l1.p2.y - l1.p1.y)\n\t\t\t* (l1.p1.x - l2.p1.x)\n\t\t)\n\t\t/\n\t\t(\n\t\t\t(l2.p2.y - l2.p1.y)\n\t\t\t* (l1.p2.x - l1.p1.x)\n\t\t\t- (l2.p2.x - l2.p1.x)\n\t\t\t* (l1.p2.y - l1.p1.y)\n\t\t);\n\treturn a >= 0.0 && a <= 1.0 && b >= 0.0 && b <= 1.0;\n}\n\nfunction colRectLine(r: Rect, l: Line): boolean {\n\tif (colRectPt(r, l.p1) || colRectPt(r, l.p2)) {\n\t\treturn true;\n\t}\n\treturn colLineLine(l, makeLine(r.p1, vec2(r.p2.x, r.p1.y)))\n\t\t|| colLineLine(l, makeLine(vec2(r.p2.x, r.p1.y), r.p2))\n\t\t|| colLineLine(l, makeLine(r.p2, vec2(r.p1.x, r.p2.y)))\n\t\t|| colLineLine(l, makeLine(vec2(r.p1.x, r.p2.y), r.p1));\n}\n\nfunction colRectPt(r: Rect, pt: Vec2): boolean {\n\treturn pt.x >= r.p1.x && pt.x <= r.p2.x && pt.y >= r.p1.y && pt.y < r.p2.y;\n}\n\nfunction makeLine(p1: Vec2, p2: Vec2): Line {\n\treturn {\n\t\tp1: p1.clone(),\n\t\tp2: p2.clone(),\n\t};\n}\n\nexport {\n\tvec2,\n\tvec3,\n\tmat4,\n\tquad,\n\trgba,\n\trgb,\n\tmakeRng,\n\trand,\n\trandSeed,\n\tchance,\n\tchoose,\n\tclamp,\n\tlerp,\n\tmap,\n\tmapc,\n\twave,\n\tdeg2rad,\n\trad2deg,\n\tcolRectRect,\n\toverlapRectRect,\n\tcolLineLine,\n\tcolRectLine,\n\tcolRectPt,\n\tvec2FromAngle,\n\tisVec2,\n\tisVec3,\n\tisColor,\n\tisMat4,\n};\n", "function deepEq(o1: any, o2: any): boolean {\n\tconst t1 = typeof o1;\n\tconst t2 = typeof o2;\n\tif (t1 !== t2) {\n\t\treturn false;\n\t}\n\tif (t1 === \"object\" && t2 === \"object\") {\n\t\tconst k1 = Object.keys(o1);\n\t\tconst k2 = Object.keys(o2);\n\t\tif (k1.length !== k2.length) {\n\t\t\treturn false;\n\t\t}\n\t\tfor (const k of k1) {\n\t\t\tconst v1 = o1[k];\n\t\t\tconst v2 = o2[k];\n\t\t\tif (!(typeof v1 === \"function\" && typeof v2 === \"function\")) {\n\t\t\t\tif (!deepEq(v1, v2)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\treturn o1 === o2;\n}\n\nexport {\n\tdeepEq,\n};\n", "import {\n\tvec2,\n\tvec3,\n\tquad,\n\trgb,\n\trgba,\n\tmat4,\n\tisVec2,\n\tisVec3,\n\tisColor,\n\tisMat4,\n} from \"./math\";\n\nimport {\n\tdeepEq,\n} from \"./utils\";\n\ntype GfxCtx = {\n\tvbuf: WebGLBuffer,\n\tibuf: WebGLBuffer,\n\tvqueue: number[],\n\tiqueue: number[],\n\tclearColor: Color,\n\tdefProg: GfxProgram,\n\tcurProg: GfxProgram,\n\tdefTex: GfxTexture,\n\tcurTex: GfxTexture,\n\tbgTex: GfxTexture,\n\tcurUniform: Uniform,\n\ttransform: Mat4,\n\ttransformStack: Mat4[],\n\tdrawCalls: number,\n\tlastDrawCalls: number,\n\twidth: number,\n\theight: number,\n};\n\ntype GfxConf = {\n\tclearColor?: Color,\n\twidth?: number,\n\theight?: number,\n\tscale?: number,\n\ttexFilter?: TexFilter,\n    stretch?: boolean,\n    letterbox?: boolean,\n};\n\ntype Gfx = {\n\twidth(): number,\n\theight(): number,\n\tscale(): number,\n\tclearColor(): Color,\n\tmakeTex(data: GfxTextureData): GfxTexture,\n\tmakeProgram(vert: string, frag: string): GfxProgram,\n\tmakeFont(\n\t\ttex: GfxTexture,\n\t\tgw: number,\n\t\tgh: number,\n\t\tchars: string,\n\t): GfxFont,\n\tdrawTexture(\n\t\ttex: GfxTexture,\n\t\tconf?: DrawTextureConf,\n\t),\n\tdrawText(\n\t\ttxt: string,\n\t\tfont: GfxFont,\n\t\tconf?: DrawTextConf,\n\t),\n\tdrawFmtText(ftext: FormattedText),\n\tfmtText(\n\t\ttxt: string,\n\t\tfont: GfxFont,\n\t\tconf?: DrawTextConf,\n\t): FormattedText,\n\tdrawRect(\n\t\tpos: Vec2,\n\t\tw: number,\n\t\th: number,\n\t\tconf?: DrawRectConf,\n\t),\n\tdrawRectStroke(\n\t\tpos: Vec2,\n\t\tw: number,\n\t\th: number,\n\t\tconf?: DrawRectStrokeConf,\n\t),\n\tdrawLine(\n\t\tp1: Vec2,\n\t\tp2: Vec2,\n\t\tconf?: DrawLineConf,\n\t),\n\tdrawTri(\n\t\tp1: Vec2,\n\t\tp2: Vec2,\n\t\tp3: Vec2,\n\t\tconf?: DrawLineConf,\n\t),\n\tframeStart(),\n\tframeEnd(),\n\tpushTransform(),\n\tpopTransform(),\n\tpushMatrix(m: Mat4),\n\tdrawCalls(): number,\n};\n\nconst DEF_ORIGIN = \"topleft\";\nconst STRIDE = 9;\nconst QUEUE_COUNT = 65536;\nconst BG_GRID_SIZE = 64;\n\nconst VERT_TEMPLATE = `\nattribute vec3 a_pos;\nattribute vec2 a_uv;\nattribute vec4 a_color;\n\nvarying vec3 v_pos;\nvarying vec2 v_uv;\nvarying vec4 v_color;\n\nvec4 def_vert() {\n\treturn vec4(a_pos, 1.0);\n}\n\n{{user}}\n\nvoid main() {\n\tvec4 pos = vert(a_pos, a_uv, a_color);\n\tv_pos = a_pos;\n\tv_uv = a_uv;\n\tv_color = a_color;\n\tgl_Position = pos;\n}\n`;\n\nconst FRAG_TEMPLATE = `\nprecision mediump float;\n\nvarying vec3 v_pos;\nvarying vec2 v_uv;\nvarying vec4 v_color;\n\nuniform sampler2D u_tex;\n\nvec4 def_frag() {\n\treturn v_color * texture2D(u_tex, v_uv);\n}\n\n{{user}}\n\nvoid main() {\n\tgl_FragColor = frag(v_pos, v_uv, v_color, u_tex);\n\tif (gl_FragColor.a == 0.0) {\n\t\tdiscard;\n\t}\n}\n`;\n\nconst DEF_VERT = `\nvec4 vert(vec3 pos, vec2 uv, vec4 color) {\n\treturn def_vert();\n}\n`;\n\nconst DEF_FRAG = `\nvec4 frag(vec3 pos, vec2 uv, vec4 color, sampler2D tex) {\n\treturn def_frag();\n}\n`;\n\nfunction originPt(orig: Origin | Vec2): Vec2 {\n\tswitch (orig) {\n\t\tcase \"topleft\": return vec2(-1, -1);\n\t\tcase \"top\": return vec2(0, -1);\n\t\tcase \"topright\": return vec2(1, -1);\n\t\tcase \"left\": return vec2(-1, 0);\n\t\tcase \"center\": return vec2(0, 0);\n\t\tcase \"right\": return vec2(1, 0);\n\t\tcase \"botleft\": return vec2(-1, 1);\n\t\tcase \"bot\": return vec2(0, 1);\n\t\tcase \"botright\": return vec2(1, 1);\n\t\tdefault: return orig;\n\t}\n}\n\nfunction gfxInit(gl: WebGLRenderingContext, gconf: GfxConf): Gfx {\n\n\tconst texFilter = (() => {\n\t\tswitch (gconf.texFilter) {\n\t\t\tcase \"linear\": return gl.LINEAR;\n\t\t\tcase \"nearest\": return gl.NEAREST;\n\t\t\tdefault: return gl.NEAREST;\n\t\t}\n\t})();\n\n\tconst gfx: GfxCtx = (() => {\n\n\t\tconst defProg = makeProgram(DEF_VERT, DEF_FRAG);\n\t\tconst emptyTex = makeTex(\n\t\t\tnew ImageData(new Uint8ClampedArray([ 255, 255, 255, 255, ]), 1, 1)\n\t\t);\n\n\t\tconst c = gconf.clearColor ?? rgba(0, 0, 0, 1);\n\n\t\tgl.clearColor(c.r, c.g, c.b, c.a);\n\t\tgl.enable(gl.BLEND);\n\t\tgl.enable(gl.SCISSOR_TEST);\n\t\tgl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n\n\t\tconst vbuf = gl.createBuffer();\n\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, vbuf);\n\t\tgl.bufferData(gl.ARRAY_BUFFER, QUEUE_COUNT * 4, gl.DYNAMIC_DRAW);\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, null);\n\n\t\tconst ibuf = gl.createBuffer();\n\n\t\tgl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf);\n\t\tgl.bufferData(gl.ELEMENT_ARRAY_BUFFER, QUEUE_COUNT * 2, gl.DYNAMIC_DRAW);\n\t\tgl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\n\n\t\tconst bgTex = makeTex(\n\t\t\tnew ImageData(new Uint8ClampedArray([\n\t\t\t\t128, 128, 128, 255,\n\t\t\t\t190, 190, 190, 255,\n\t\t\t\t190, 190, 190, 255,\n\t\t\t\t128, 128, 128, 255,\n\t\t\t]), 2, 2)\n\t\t);\n\n\t\treturn {\n\t\t\tdrawCalls: 0,\n\t\t\tlastDrawCalls: 0,\n\t\t\tdefProg: defProg,\n\t\t\tcurProg: defProg,\n\t\t\tdefTex: emptyTex,\n\t\t\tcurTex: emptyTex,\n\t\t\tcurUniform: {},\n\t\t\tvbuf: vbuf,\n\t\t\tibuf: ibuf,\n\t\t\tvqueue: [],\n\t\t\tiqueue: [],\n\t\t\ttransform: mat4(),\n\t\t\ttransformStack: [],\n\t\t\tclearColor: c,\n\t\t\tbgTex: bgTex,\n\t\t\twidth: gconf.width,\n\t\t\theight: gconf.height,\n\t\t};\n\n\t})();\n\n\tfunction powerOfTwo(n) {\n\t\treturn (Math.log(n) / Math.log(2)) % 1 === 0;\n\t}\n\n\tfunction makeTex(data: GfxTextureData): GfxTexture {\n\n\t\tconst id = gl.createTexture();\n\n\t\tgl.bindTexture(gl.TEXTURE_2D, id);\n\t\tgl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, data);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, texFilter);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, texFilter);\n\n\t\t// TODO\n\t\tconst wrap = (() => {\n\t\t\tif (powerOfTwo(data.width) && powerOfTwo(data.height)) {\n\t\t\t\treturn gl.REPEAT;\n\t\t\t} else {\n\t\t\t\treturn gl.CLAMP_TO_EDGE;\n\t\t\t}\n\t\t})();\n\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, wrap);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, wrap);\n\t\tgl.bindTexture(gl.TEXTURE_2D, null);\n\n\t\treturn {\n\t\t\twidth: data.width,\n\t\t\theight: data.height,\n\t\t\tbind() {\n\t\t\t\tgl.bindTexture(gl.TEXTURE_2D, id);\n\t\t\t},\n\t\t\tunbind() {\n\t\t\t\tgl.bindTexture(gl.TEXTURE_2D, null);\n\t\t\t},\n\t\t};\n\n\t}\n\n\tfunction makeProgram(\n\t\tvertSrc: string | null = DEF_VERT,\n\t\tfragSrc: string | null = DEF_FRAG,\n\t): GfxProgram {\n\n\t\tlet msg;\n\t\tconst vcode = VERT_TEMPLATE.replace(\"{{user}}\", vertSrc ?? DEF_VERT);\n\t\tconst fcode = FRAG_TEMPLATE.replace(\"{{user}}\", fragSrc ?? DEF_FRAG);\n\t\tconst vertShader = gl.createShader(gl.VERTEX_SHADER);\n\t\tconst fragShader = gl.createShader(gl.FRAGMENT_SHADER);\n\n\t\tgl.shaderSource(vertShader, vcode);\n\t\tgl.shaderSource(fragShader, fcode);\n\t\tgl.compileShader(vertShader);\n\t\tgl.compileShader(fragShader);\n\n\t\tif ((msg = gl.getShaderInfoLog(vertShader))) {\n\t\t\tthrow new Error(msg);\n\t\t}\n\n\t\tif ((msg = gl.getShaderInfoLog(fragShader))) {\n\t\t\tthrow new Error(msg);\n\t\t}\n\n\t\tconst id = gl.createProgram();\n\n\t\tgl.attachShader(id, vertShader);\n\t\tgl.attachShader(id, fragShader);\n\n\t\tgl.bindAttribLocation(id, 0, \"a_pos\");\n\t\tgl.bindAttribLocation(id, 1, \"a_uv\");\n\t\tgl.bindAttribLocation(id, 2, \"a_color\");\n\n\t\tgl.linkProgram(id);\n\n\t\tif ((msg = gl.getProgramInfoLog(id))) {\n\t\t\t// for some reason on safari it always has a \"\\n\" msg\n\t\t\tif (msg !== \"\\n\") {\n\t\t\t\tthrow new Error(msg);\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\n\t\t\tbind() {\n\t\t\t\tgl.useProgram(id);\n\t\t\t},\n\n\t\t\tunbind() {\n\t\t\t\tgl.useProgram(null);\n\t\t\t},\n\n\t\t\tbindAttribs() {\n\t\t\t\tgl.vertexAttribPointer(0, 3, gl.FLOAT, false, STRIDE * 4, 0);\n\t\t\t\tgl.enableVertexAttribArray(0);\n\t\t\t\tgl.vertexAttribPointer(1, 2, gl.FLOAT, false, STRIDE * 4, 12);\n\t\t\t\tgl.enableVertexAttribArray(1);\n\t\t\t\tgl.vertexAttribPointer(2, 4, gl.FLOAT, false, STRIDE * 4, 20);\n\t\t\t\tgl.enableVertexAttribArray(2);\n\t\t\t},\n\n\t\t\tsend(uniform: Uniform) {\n\t\t\t\tthis.bind();\n\t\t\t\t// TODO: slow for vec2\n\t\t\t\tfor (const name in uniform) {\n\t\t\t\t\tconst val = uniform[name];\n\t\t\t\t\tconst loc = gl.getUniformLocation(id, name);\n\t\t\t\t\tif (typeof val === \"number\") {\n\t\t\t\t\t\tgl.uniform1f(loc, val);\n\t\t\t\t\t} else if (isMat4(val)) {\n\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\tgl.uniformMatrix4fv(loc, false, new Float32Array(val.m));\n\t\t\t\t\t} else if (isColor(val)) {\n\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\tgl.uniform4f(loc, val.r, val.g, val.b, val.a);\n\t\t\t\t\t} else if (isVec3(val)) {\n\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\tgl.uniform3f(loc, val.x, val.y, val.z);\n\t\t\t\t\t} else if (isVec2(val)) {\n\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\tgl.uniform2f(loc, val.x, val.y);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.unbind();\n\t\t\t},\n\n\t\t};\n\n\t}\n\n\tfunction makeFont(\n\t\ttex: GfxTexture,\n\t\tgw: number,\n\t\tgh: number,\n\t\tchars: string,\n\t): GfxFont {\n\n\t\tconst cols = tex.width / gw;\n\t\tconst rows = tex.height / gh;\n\t\tconst qw = 1.0 / cols;\n\t\tconst qh = 1.0 / rows;\n\t\tconst map: Record<string, Vec2> = {};\n\t\tconst charMap = chars.split(\"\").entries();\n\n\t\tfor (const [i, ch] of charMap) {\n\t\t\tmap[ch] = vec2(\n\t\t\t\t(i % cols) * qw,\n\t\t\t\tMath.floor(i / cols) * qh,\n\t\t\t);\n\t\t}\n\n\t\treturn {\n\t\t\ttex: tex,\n\t\t\tmap: map,\n\t\t\tqw: qw,\n\t\t\tqh: qh,\n\t\t};\n\n\t}\n\n\t// TODO: expose\n\tfunction drawRaw(\n\t\tverts: Vertex[],\n\t\tindices: number[],\n\t\ttex: GfxTexture = gfx.defTex,\n\t\tprog: GfxProgram = gfx.defProg,\n\t\tuniform: Uniform = {},\n\t) {\n\n\t\ttex = tex ?? gfx.defTex;\n\t\tprog = prog ?? gfx.defProg;\n\n\t\t// flush on texture / shader change and overflow\n\t\tif (\n\t\t\ttex !== gfx.curTex\n\t\t\t|| prog !== gfx.curProg\n\t\t\t|| !deepEq(gfx.curUniform, uniform)\n\t\t\t|| gfx.vqueue.length + verts.length * STRIDE > QUEUE_COUNT\n\t\t\t|| gfx.iqueue.length + indices.length > QUEUE_COUNT\n\t\t) {\n\t\t\tflush();\n\t\t}\n\n\t\tgfx.curTex = tex;\n\t\tgfx.curProg = prog;\n\t\tgfx.curUniform = uniform;\n\n\t\tconst nIndices = indices\n\t\t\t.map((i) => {\n\t\t\t\treturn i + gfx.vqueue.length / STRIDE;\n\t\t\t});\n\n\t\tconst nVerts = verts\n\t\t\t.map((v) => {\n\t\t\t\tconst pt = toNDC(gfx.transform.multVec2(v.pos.xy()));\n\t\t\t\treturn [\n\t\t\t\t\tpt.x, pt.y, v.pos.z,\n\t\t\t\t\tv.uv.x, v.uv.y,\n\t\t\t\t\tv.color.r, v.color.g, v.color.b, v.color.a\n\t\t\t\t];\n\t\t\t})\n\t\t\t.flat();\n\n\t\tnIndices.forEach((i) => gfx.iqueue.push(i));\n\t\tnVerts.forEach((v) => gfx.vqueue.push(v));\n\n\t}\n\n\tfunction flush() {\n\n\t\tif (\n\t\t\t!gfx.curTex\n\t\t\t|| !gfx.curProg\n\t\t\t|| gfx.vqueue.length === 0\n\t\t\t|| gfx.iqueue.length === 0\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tgfx.curProg.send(gfx.curUniform);\n\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, gfx.vbuf);\n\t\tgl.bufferSubData(gl.ARRAY_BUFFER, 0, new Float32Array(gfx.vqueue));\n\t\tgl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, gfx.ibuf);\n\t\tgl.bufferSubData(gl.ELEMENT_ARRAY_BUFFER, 0, new Uint16Array(gfx.iqueue));\n\t\tgfx.curProg.bind();\n\t\tgfx.curProg.bindAttribs();\n\t\tgfx.curTex.bind();\n\t\tgl.drawElements(gl.TRIANGLES, gfx.iqueue.length, gl.UNSIGNED_SHORT, 0);\n\t\tgfx.curTex.unbind();\n\t\tgfx.curProg.unbind();\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, null);\n\t\tgl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\n\n\t\tgfx.iqueue = [];\n\t\tgfx.vqueue = [];\n\n\t\tgfx.drawCalls++;\n\n\t}\n\n\tfunction frameStart() {\n\n\t\tgl.clear(gl.COLOR_BUFFER_BIT);\n\n\t\tif (!gconf.clearColor) {\n\t\t\tdrawQuad({\n\t\t\t\twidth: width(),\n\t\t\t\theight: height(),\n\t\t\t\tquad: quad(\n\t\t\t\t\t0,\n\t\t\t\t\t0,\n\t\t\t\t\twidth() * scale() / BG_GRID_SIZE,\n\t\t\t\t\theight() * scale() / BG_GRID_SIZE,\n\t\t\t\t),\n\t\t\t\ttex: gfx.bgTex,\n\t\t\t})\n\t\t}\n\n\t\tgfx.drawCalls = 0;\n\t\tgfx.transformStack = [];\n\t\tgfx.transform = mat4();\n\n\t}\n\n\tfunction frameEnd() {\n\t\tflush();\n\t\tgfx.lastDrawCalls = gfx.drawCalls;\n\t}\n\n\tfunction drawCalls() {\n\t\treturn gfx.lastDrawCalls;\n\t}\n\n\tfunction toNDC(pt: Vec2): Vec2 {\n\t\treturn vec2(\n\t\t\tpt.x / width() * 2 - 1,\n\t\t\t-pt.y / height() * 2 + 1,\n\t\t);\n\t}\n\n\t// TODO: don't use push as prefix for these\n\tfunction pushMatrix(m: Mat4) {\n\t\tgfx.transform = m.clone();\n\t}\n\n\tfunction pushTranslate(p: Vec2) {\n\t\tif (!p || (p.x === 0 && p.y === 0)) {\n\t\t\treturn;\n\t\t}\n\t\tgfx.transform = gfx.transform.translate(p);\n\t}\n\n\tfunction pushScale(p: Vec2) {\n\t\tif (!p || (p.x === 1 && p.y === 1)) {\n\t\t\treturn;\n\t\t}\n\t\tgfx.transform = gfx.transform.scale(p);\n\t}\n\n\tfunction pushRotateX(a: number) {\n\t\tif (!a) {\n\t\t\treturn;\n\t\t}\n\t\tgfx.transform = gfx.transform.rotateX(a);\n\t}\n\n\tfunction pushRotateY(a: number) {\n\t\tif (!a) {\n\t\t\treturn;\n\t\t}\n\t\tgfx.transform = gfx.transform.rotateY(a);\n\t}\n\n\tfunction pushRotateZ(a: number) {\n\t\tif (!a) {\n\t\t\treturn;\n\t\t}\n\t\tgfx.transform = gfx.transform.rotateZ(a);\n\t}\n\n\tfunction pushTransform() {\n\t\tgfx.transformStack.push(gfx.transform.clone());\n\t}\n\n\tfunction popTransform() {\n\t\tif (gfx.transformStack.length > 0) {\n\t\t\tgfx.transform = gfx.transformStack.pop();\n\t\t}\n\t}\n\n\t// TODO: clean\n\t// draw a textured quad\n\tfunction drawQuad(conf: DrawQuadConf = {}) {\n\n\t\tconst w = conf.width || 0;\n\t\tconst h = conf.height || 0;\n\t\tconst pos = conf.pos || vec2(0, 0);\n\t\tconst origin = originPt(conf.origin || DEF_ORIGIN);\n\t\tconst offset = origin.scale(vec2(w, h).scale(-0.5));\n\t\tconst scale = vec2(conf.scale ?? 1);\n\t\tconst rot = conf.rot || 0;\n\t\tconst q = conf.quad || quad(0, 0, 1, 1);\n\t\tconst z = 1 - (conf.z ?? 0);\n\t\tconst color = conf.color || rgba(1, 1, 1, 1);\n\n\t\tpushTransform();\n\t\tpushTranslate(pos);\n\t\tpushRotateZ(rot);\n\t\tpushScale(scale);\n\t\tpushTranslate(offset);\n\n\t\tdrawRaw([\n\t\t\t{\n\t\t\t\tpos: vec3(-w / 2, h / 2, z),\n\t\t\t\tuv: vec2(conf.flipX ? q.x + q.w : q.x, conf.flipY ? q.y : q.y + q.h),\n\t\t\t\tcolor: color,\n\t\t\t},\n\t\t\t{\n\t\t\t\tpos: vec3(-w / 2, -h / 2, z),\n\t\t\t\tuv: vec2(conf.flipX ? q.x + q.w : q.x, conf.flipY ? q.y + q.h : q.y),\n\t\t\t\tcolor: color,\n\t\t\t},\n\t\t\t{\n\t\t\t\tpos: vec3(w / 2, -h / 2, z),\n\t\t\t\tuv: vec2(conf.flipX ? q.x : q.x + q.w, conf.flipY ? q.y + q.h : q.y),\n\t\t\t\tcolor: color,\n\t\t\t},\n\t\t\t{\n\t\t\t\tpos: vec3(w / 2, h / 2, z),\n\t\t\t\tuv: vec2(conf.flipX ? q.x : q.x + q.w, conf.flipY ? q.y : q.y + q.h),\n\t\t\t\tcolor: color,\n\t\t\t},\n\t\t], [0, 1, 3, 1, 2, 3], conf.tex, conf.prog, conf.uniform);\n\n\t\tpopTransform();\n\n\t}\n\n\tfunction drawTexture(\n\t\ttex: GfxTexture,\n\t\tconf: DrawTextureConf = {},\n\t) {\n\n\t\tconst q = conf.quad ?? quad(0, 0, 1, 1);\n\t\tconst w = tex.width * q.w;\n\t\tconst h = tex.height * q.h;\n\t\tconst scale = vec2(1);\n\n\t\tif (conf.tiled) {\n\n\t\t\t// TODO: draw fract\n\t\t\tconst repX = Math.ceil((conf.width || w) / w);\n\t\t\tconst repY = Math.ceil((conf.height || h) / h);\n\t\t\tconst origin = originPt(conf.origin || DEF_ORIGIN).add(vec2(1, 1)).scale(0.5);\n\t\t\tconst offset = origin.scale(repX * w, repY * h);\n\n\t\t\t// TODO: rotation\n\t\t\tfor (let i = 0; i < repX; i++) {\n\t\t\t\tfor (let j = 0; j < repY; j++) {\n\t\t\t\t\tdrawQuad({\n\t\t\t\t\t\t...conf,\n\t\t\t\t\t\tpos: (conf.pos || vec2(0)).add(vec2(w * i, h * j)).sub(offset),\n\t\t\t\t\t\tscale: scale.scale(conf.scale || vec2(1)),\n\t\t\t\t\t\ttex: tex,\n\t\t\t\t\t\tquad: q,\n\t\t\t\t\t\twidth: w,\n\t\t\t\t\t\theight: h,\n\t\t\t\t\t\torigin: \"topleft\",\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\n\t\t\t// TODO: should this ignore scale?\n\t\t\tif (conf.width && conf.height) {\n\t\t\t\tscale.x = conf.width / w;\n\t\t\t\tscale.y = conf.height / h;\n\t\t\t} else if (conf.width) {\n\t\t\t\tscale.x = conf.width / w;\n\t\t\t\tscale.y = scale.x;\n\t\t\t} else if (conf.height) {\n\t\t\t\tscale.y = conf.height / h;\n\t\t\t\tscale.x = scale.y;\n\t\t\t}\n\n\t\t\tdrawQuad({\n\t\t\t\t...conf,\n\t\t\t\tscale: scale.scale(conf.scale || vec2(1)),\n\t\t\t\ttex: tex,\n\t\t\t\tquad: q,\n\t\t\t\twidth: w,\n\t\t\t\theight: h,\n\t\t\t});\n\n\t\t}\n\n\t}\n\n\tfunction drawRect(\n\t\tpos: Vec2,\n\t\tw: number,\n\t\th: number,\n\t\tconf: DrawRectConf = {}\n\t) {\n\t\tdrawQuad({\n\t\t\t...conf,\n\t\t\tpos: pos,\n\t\t\twidth: w,\n\t\t\theight: h,\n\t\t});\n\t}\n\n\tfunction drawRectStroke(\n\t\tpos: Vec2,\n\t\tw: number,\n\t\th: number,\n\t\tconf: DrawRectStrokeConf = {}\n\t) {\n\n\t\tif (conf.scale) {\n\t\t\tconst scale = vec2(conf.scale);\n\t\t\tw = w * scale.x;\n\t\t\th = h * scale.y;\n\t\t\tconf.scale = 1;\n\t\t}\n\n\t\tconst offset = originPt(conf.origin || DEF_ORIGIN).scale(vec2(w, h)).scale(0.5);\n\t\tconst p1 = pos.add(vec2(-w / 2, -h / 2)).sub(offset);\n\t\tconst p2 = pos.add(vec2(-w / 2,  h / 2)).sub(offset);\n\t\tconst p3 = pos.add(vec2( w / 2,  h / 2)).sub(offset);\n\t\tconst p4 = pos.add(vec2( w / 2, -h / 2)).sub(offset);\n\n\t\tdrawLine(p1, p2, conf);\n\t\tdrawLine(p2, p3, conf);\n\t\tdrawLine(p3, p4, conf);\n\t\tdrawLine(p4, p1, conf);\n\n\t}\n\n\tfunction drawLine(\n\t\tp1: Vec2,\n\t\tp2: Vec2,\n\t\tconf: DrawLineConf = {},\n\t) {\n\n\t\tconst w = conf.width || 1;\n\t\tconst h = p1.dist(p2);\n\t\tconst rot = Math.PI / 2 - p1.angle(p2);\n\n\t\tdrawQuad({\n\t\t\t...conf,\n\t\t\tpos: p1.add(p2).scale(0.5),\n\t\t\twidth: w,\n\t\t\theight: h,\n\t\t\trot: rot,\n\t\t\torigin: \"center\",\n\t\t});\n\n\t}\n\n\t// TODO: not drawing\n\tfunction drawTri(\n\t\tp1: Vec2,\n\t\tp2: Vec2,\n\t\tp3: Vec2,\n\t\tconf: DrawTriConf = {},\n\t) {\n\t\tconst z = conf.z;\n\t\tconst color = conf.color || rgb(1, 1, 1);\n\t\tdrawRaw([\n\t\t\t{\n\t\t\t\tpos: vec3(p1.x, p1.y, z),\n\t\t\t\tuv: vec2(0, 0),\n\t\t\t\tcolor: color,\n\t\t\t},\n\t\t\t{\n\t\t\t\tpos: vec3(p2.x, p2.y, z),\n\t\t\t\tuv: vec2(0, 0),\n\t\t\t\tcolor: color,\n\t\t\t},\n\t\t\t{\n\t\t\t\tpos: vec3(p3.x, p3.y, z),\n\t\t\t\tuv: vec2(0, 0),\n\t\t\t\tcolor: color,\n\t\t\t},\n\t\t], [0, 1, 2], gfx.defTex, conf.prog, conf.uniform);\n\t}\n\n\t// format text and return a list of chars with their calculated position\n\tfunction fmtText(\n\t\ttext: string,\n\t\tfont: GfxFont,\n\t\tconf: DrawTextConf = {}\n\t): FormattedText {\n\n\t\tconst chars = (text + \"\").split(\"\");\n\t\tconst gw = font.qw * font.tex.width;\n\t\tconst gh = font.qh * font.tex.height;\n\t\tconst size = conf.size || gh;\n\t\tconst scale = vec2(size / gh).scale(vec2(conf.scale || 1));\n\t\tconst cw = scale.x * gw;\n\t\tconst ch = scale.y * gh;\n\t\tlet curX = 0;\n\t\tlet th = ch;\n\t\tlet tw = 0;\n\t\tconst flines = [];\n\t\tlet curLine = [];\n\t\tlet lastSpace = null;\n\t\tlet cursor = 0;\n\n\t\twhile (cursor < chars.length) {\n\n\t\t\tlet char = chars[cursor];\n\n\t\t\t// check new line\n\t\t\tif (char === \"\\n\") {\n\t\t\t\t// always new line on '\\n'\n\t\t\t\tth += ch;\n\t\t\t\tcurX = 0;\n\t\t\t\tlastSpace = null;\n\t\t\t\tflines.push(curLine);\n\t\t\t\tcurLine = [];\n\t\t\t} else if ((conf.width ? (curX + cw > conf.width) : false)) {\n\t\t\t\t// new line on last word if width exceeds\n\t\t\t\tth += ch;\n\t\t\t\tcurX = 0;\n\t\t\t\tif (lastSpace != null) {\n\t\t\t\t\tcursor -= curLine.length - lastSpace;\n\t\t\t\t\tchar = chars[cursor];\n\t\t\t\t\tcurLine = curLine.slice(0, lastSpace);\n\t\t\t\t}\n\t\t\t\tlastSpace = null;\n\t\t\t\tflines.push(curLine);\n\t\t\t\tcurLine = [];\n\t\t\t}\n\n\t\t\t// push char\n\t\t\tif (char !== \"\\n\") {\n\t\t\t\tcurLine.push(char);\n\t\t\t\tcurX += cw;\n\t\t\t\tif (char === \" \") {\n\t\t\t\t\tlastSpace = curLine.length;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttw = Math.max(tw, curX);\n\t\t\tcursor++;\n\n\t\t}\n\n\t\tflines.push(curLine);\n\n\t\tif (conf.width) {\n\t\t\ttw = conf.width;\n\t\t}\n\n\t\t// whole text offset\n\t\tconst fchars = [];\n\t\tconst pos = vec2(conf.pos || 0);\n\t\tconst offset = originPt(conf.origin || DEF_ORIGIN).scale(0.5);\n\t\t// this math is complicated i forgot how it works instantly\n\t\tconst ox = -offset.x * cw - (offset.x + 0.5) * (tw - cw);\n\t\tconst oy = -offset.y * ch - (offset.y + 0.5) * (th - ch);\n\n\t\tflines.forEach((line, ln) => {\n\n\t\t\t// line offset\n\t\t\tconst oxl = (tw - line.length * cw) * (offset.x + 0.5);\n\n\t\t\tline.forEach((char, cn) => {\n\t\t\t\tconst qpos = font.map[char];\n\t\t\t\tconst x = cn * cw;\n\t\t\t\tconst y = ln * ch;\n\t\t\t\tif (qpos) {\n\t\t\t\t\tfchars.push({\n\t\t\t\t\t\ttex: font.tex,\n\t\t\t\t\t\tquad: quad(qpos.x, qpos.y, font.qw, font.qh),\n\t\t\t\t\t\tch: char,\n\t\t\t\t\t\tpos: vec2(pos.x + x + ox + oxl, pos.y + y + oy),\n\t\t\t\t\t\tcolor: conf.color,\n\t\t\t\t\t\torigin: conf.origin,\n\t\t\t\t\t\tscale: scale,\n\t\t\t\t\t\tz: conf.z,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\treturn {\n\t\t\twidth: tw,\n\t\t\theight: th,\n\t\t\tchars: fchars,\n\t\t};\n\n\t}\n\n\tfunction drawText(\n\t\ttxt: string,\n\t\tfont: GfxFont,\n\t\tconf = {},\n\t) {\n\t\tdrawFmtText(fmtText(txt, font, conf));\n\t}\n\n\t// TODO: rotation\n\tfunction drawFmtText(ftext: FormattedText) {\n\t\tfor (const ch of ftext.chars) {\n\t\t\tdrawQuad({\n\t\t\t\ttex: ch.tex,\n\t\t\t\twidth: ch.tex.width * ch.quad.w,\n\t\t\t\theight: ch.tex.height * ch.quad.h,\n\t\t\t\tpos: ch.pos,\n\t\t\t\tscale: ch.scale,\n\t\t\t\tcolor: ch.color,\n\t\t\t\tquad: ch.quad,\n\t\t\t\t// TODO: topleft\n\t\t\t\torigin: \"center\",\n\t\t\t\tz: ch.z,\n\t\t\t});\n\t\t}\n\t}\n\n\tfunction updateSize() {\n\t\tif (gconf.width && gconf.height && gconf.stretch) {\n\t\t\tgfx.width = gconf.width;\n\t\t\tgfx.height = gconf.height;\n\t\t} else if (gconf.width && gconf.height && gconf.letterbox) {\n\t\t\t// TODO: not working\n\t\t\tconst r1 = gl.drawingBufferWidth / gl.drawingBufferHeight;\n\t\t\tconst r2 = gconf.width / gconf.height;\n\t\t\tif (r1 > r2) {\n\t\t\t\tgfx.width = gconf.height * r1;\n\t\t\t\tgfx.height = gconf.height;\n\t\t\t\tconst sw = gl.drawingBufferHeight * r2;\n\t\t\t\tconst sh = gl.drawingBufferHeight;\n\t\t\t\tconst x = (gl.drawingBufferWidth - sw) / 2;\n\t\t\t\tgl.scissor(x, 0, sw, sh);\n\t\t\t\tgl.viewport(x, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\t\t\t} else {\n\t\t\t\tgfx.width = gconf.width;\n\t\t\t\tgfx.height = gconf.width / r1;\n\t\t\t\tconst sw = gl.drawingBufferWidth;\n\t\t\t\tconst sh = gl.drawingBufferWidth / r2;\n\t\t\t\tconst y = (gl.drawingBufferHeight - sh) / 2;\n\t\t\t\tgl.scissor(0, gl.drawingBufferHeight - sh - y, sw, sh);\n\t\t\t\tgl.viewport(0, -y, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\t\t\t}\n\t\t} else {\n\t\t\tgfx.width = gl.drawingBufferWidth / scale();\n\t\t\tgfx.height = gl.drawingBufferHeight / scale();\n\t\t}\n\t}\n\n\t// get game width\n\tfunction width(): number {\n\t\treturn gfx.width;\n\t}\n\n\t// get game height\n\tfunction height(): number {\n\t\treturn gfx.height;\n\t}\n\n\tfunction scale(): number {\n\t\treturn gconf.scale ?? 1;\n\t}\n\n\tfunction clearColor(): Color {\n\t\treturn gfx.clearColor.clone();\n\t}\n\n\tupdateSize();\n\tframeStart();\n\tframeEnd();\n\n\t// TODO: type this\n\treturn {\n\t\twidth,\n\t\theight,\n\t\tscale,\n\t\tmakeTex,\n\t\tmakeProgram,\n\t\tmakeFont,\n\t\tdrawTexture,\n\t\tdrawText,\n\t\tdrawFmtText,\n\t\tdrawRect,\n\t\tdrawRectStroke,\n\t\tdrawLine,\n\t\tdrawTri,\n\t\tfmtText,\n\t\tframeStart,\n\t\tframeEnd,\n\t\tpushTransform,\n\t\tpopTransform,\n\t\tpushMatrix,\n\t\tdrawCalls,\n\t\tclearColor,\n\t};\n\n}\n\nexport {\n\tGfx,\n\toriginPt,\n\tgfxInit,\n};\n", "import {\n\tvec2,\n} from \"./math\";\n\ntype ButtonState =\n\t\"up\"\n\t| \"pressed\"\n\t| \"rpressed\"\n\t| \"down\"\n\t| \"released\"\n\t;\n\ntype AppConf = {\n\twidth?: number,\n\theight?: number,\n\tstretch?: boolean,\n\tscale?: number,\n\tcrisp?: boolean,\n\tcanvas?: HTMLCanvasElement,\n\troot?: HTMLElement,\n\ttouchToMouse?: boolean,\n\taudioCtx?: AudioContext,\n};\n\ntype AppCtx = {\n\tcanvas: HTMLCanvasElement,\n\tmousePos: Vec2,\n\tmouseDeltaPos: Vec2,\n\tmouseState: ButtonState,\n\tkeyStates: Record<string, ButtonState>,\n\tcharInputted: string[],\n\tmouseMoved: boolean,\n\ttime: number,\n\tdt: number,\n\trealTime: number,\n\tskipTime: boolean,\n\tscale: number,\n\tisTouch: boolean,\n\tloopID: number | null,\n\tstopped: boolean,\n\tfps: number,\n\tfpsBuf: number[],\n\tfpsTimer: number,\n};\n\ntype App = {\n\tgl: WebGLRenderingContext,\n\tmousePos(): Vec2,\n\tmouseDeltaPos(): Vec2,\n\tkeyDown(k: string): boolean,\n\tkeyPressed(k: string): boolean,\n\tkeyPressedRep(k: string): boolean,\n\tkeyReleased(k: string): boolean,\n\tmouseDown(): boolean,\n\tmouseClicked(): boolean,\n\tmouseReleased(): boolean,\n\tmouseMoved(): boolean,\n\tcharInputted(): string[],\n\tcursor(c?: string),\n\tdt(): number,\n\tfps(): number,\n\ttime(): number,\n\tscreenshot(): string,\n\trun(f: () => void),\n\tquit(),\n\tfocused(): boolean,\n\tfocus(),\n\tcanvas: HTMLCanvasElement,\n\tisTouch: boolean,\n\tscale: number,\n};\n\nfunction processBtnState(s: ButtonState): ButtonState {\n\tif (s === \"pressed\" || s === \"rpressed\") {\n\t\treturn \"down\";\n\t}\n\tif (s === \"released\") {\n\t\treturn \"up\";\n\t}\n\treturn s;\n}\n\nfunction appInit(gconf: AppConf = {}): App {\n\n    const root = gconf.root ?? document.body;\n\n\tconst app: AppCtx = {\n\t\tcanvas: gconf.canvas ?? (() => {\n\t\t\tconst canvas = document.createElement(\"canvas\");\n\t\t\troot.appendChild(canvas);\n\t\t\treturn canvas;\n\t\t})(),\n\t\tkeyStates: {},\n\t\tcharInputted: [],\n\t\tmouseMoved: false,\n\t\tmouseState: \"up\",\n\t\tmousePos: vec2(0, 0),\n\t\tmouseDeltaPos: vec2(0, 0),\n\t\ttime: 0,\n\t\trealTime: 0,\n\t\tskipTime: false,\n\t\tdt: 0.0,\n\t\tscale: gconf.scale ?? 1,\n\t\tisTouch: false,\n\t\tloopID: null,\n\t\tstopped: false,\n\t\tfps: 0,\n\t\tfpsBuf: [],\n\t\tfpsTimer: 0,\n\t};\n\n\tconst keyMap = {\n\t\t\"ArrowLeft\": \"left\",\n\t\t\"ArrowRight\": \"right\",\n\t\t\"ArrowUp\": \"up\",\n\t\t\"ArrowDown\": \"down\",\n\t\t\" \": \"space\",\n\t};\n\n\tconst preventDefaultKeys = [\n\t\t\"space\",\n\t\t\"left\",\n\t\t\"right\",\n\t\t\"up\",\n\t\t\"down\",\n\t\t\"tab\",\n\t\t\"f1\",\n\t\t\"f2\",\n\t\t\"f3\",\n\t\t\"f4\",\n\t\t\"f5\",\n\t\t\"f6\",\n\t\t\"f7\",\n\t\t\"f8\",\n\t\t\"f9\",\n\t\t\"f10\",\n\t\t\"f11\",\n\t];\n\n\tif (gconf.width && gconf.height && !gconf.stretch) {\n\t\tapp.canvas.width = gconf.width * app.scale;\n\t\tapp.canvas.height = gconf.height * app.scale;\n\t} else {\n\t\tapp.canvas.width = root.offsetWidth;\n\t\tapp.canvas.height = root.offsetHeight;\n\t}\n\n\tconst styles = [\n\t\t\"outline: none\",\n\t\t\"cursor: default\",\n\t];\n\n\tif (gconf.crisp) {\n\t\tstyles.push(\"image-rendering: pixelated\");\n\t\tstyles.push(\"image-rendering: crisp-edges\");\n\t}\n\n\t// @ts-ignore\n\tapp.canvas.style = styles.join(\";\");\n\tapp.canvas.setAttribute(\"tabindex\", \"0\");\n\n\tconst gl = app.canvas\n\t\t.getContext(\"webgl\", {\n\t\t\tantialias: true,\n\t\t\tdepth: true,\n\t\t\tstencil: true,\n\t\t\talpha: true,\n\t\t\tpreserveDrawingBuffer: true,\n\t\t});\n\n\tapp.isTouch = (\"ontouchstart\" in window) ||\n\t\t(navigator.maxTouchPoints > 0) ||\n\t\t(navigator.msMaxTouchPoints > 0);\n\n\tapp.canvas.addEventListener(\"mousemove\", (e) => {\n\t\tapp.mousePos = vec2(e.offsetX, e.offsetY).scale(1 / app.scale);\n\t\tapp.mouseDeltaPos = vec2(e.movementX, e.movementY).scale(1 / app.scale);\n\t\tapp.mouseMoved = true;\n\t});\n\n\tapp.canvas.addEventListener(\"mousedown\", () => {\n\t\tapp.mouseState = \"pressed\";\n\t});\n\n\tapp.canvas.addEventListener(\"mouseup\", () => {\n\t\tapp.mouseState = \"released\";\n\t});\n\n\tapp.canvas.addEventListener(\"keydown\", (e) => {\n\n\t\tconst k = keyMap[e.key] || e.key.toLowerCase();\n\n\t\tif (preventDefaultKeys.includes(k)) {\n\t\t\te.preventDefault();\n\t\t}\n\n\t\tif (k.length === 1) {\n\t\t\tapp.charInputted.push(k);\n\t\t}\n\n\t\tif (k === \"space\") {\n\t\t\tapp.charInputted.push(\" \");\n\t\t}\n\n\t\tif (e.repeat) {\n\t\t\tapp.keyStates[k] = \"rpressed\";\n\t\t} else {\n\t\t\tapp.keyStates[k] = \"pressed\";\n\t\t}\n\n\t});\n\n\tapp.canvas.addEventListener(\"keyup\", (e: KeyboardEvent) => {\n\t\tconst k = keyMap[e.key] || e.key.toLowerCase();\n\t\tapp.keyStates[k] = \"released\";\n\t});\n\n\tapp.canvas.addEventListener(\"touchstart\", (e) => {\n\t\tif (!gconf.touchToMouse) return;\n\t\t// disable long tap context menu\n\t\te.preventDefault();\n\t\tconst t = e.touches[0];\n\t\tapp.mousePos = vec2(t.clientX, t.clientY).scale(1 / app.scale);\n\t\tapp.mouseState = \"pressed\";\n\t});\n\n\tapp.canvas.addEventListener(\"touchmove\", (e) => {\n\t\tif (!gconf.touchToMouse) return;\n\t\t// disable scrolling\n\t\te.preventDefault();\n\t\tconst t = e.touches[0];\n\t\tapp.mousePos = vec2(t.clientX, t.clientY).scale(1 / app.scale);\n\t\tapp.mouseMoved = true;\n\t});\n\n\tapp.canvas.addEventListener(\"touchend\", (e) => {\n\t\tif (!gconf.touchToMouse) return;\n\t\tapp.mouseState = \"released\";\n\t});\n\n\tapp.canvas.addEventListener(\"touchcancel\", (e) => {\n\t\tif (!gconf.touchToMouse) return;\n\t\tapp.mouseState = \"released\";\n\t});\n\n\tdocument.addEventListener(\"visibilitychange\", () => {\n\t\tswitch (document.visibilityState) {\n\t\t\tcase \"visible\":\n\t\t\t\t// prevent a surge of dt() when switch back after the tab being hidden for a while\n\t\t\t\tapp.skipTime = true;\n\t\t\t\tgconf.audioCtx?.resume();\n\t\t\t\tbreak;\n\t\t\tcase \"hidden\":\n\t\t\t\tgconf.audioCtx?.suspend();\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tfunction mousePos(): Vec2 {\n\t\treturn app.mousePos.clone();\n\t}\n\n\tfunction mouseDeltaPos(): Vec2 {\n\t\treturn app.mouseDeltaPos.clone();\n\t}\n\n\tfunction mouseClicked(): boolean {\n\t\treturn app.mouseState === \"pressed\";\n\t}\n\n\tfunction mouseDown(): boolean {\n\t\treturn app.mouseState === \"pressed\" || app.mouseState === \"down\";\n\t}\n\n\tfunction mouseReleased(): boolean {\n\t\treturn app.mouseState === \"released\";\n\t}\n\n\tfunction mouseMoved(): boolean {\n\t\treturn app.mouseMoved;\n\t}\n\n\t// TODO: check for any\n\tfunction keyPressed(k?: string): boolean {\n\t\treturn app.keyStates[k] === \"pressed\";\n\t}\n\n\tfunction keyPressedRep(k: string): boolean {\n\t\treturn app.keyStates[k] === \"pressed\" || app.keyStates[k] === \"rpressed\";\n\t}\n\n\tfunction keyDown(k: string): boolean {\n\t\treturn app.keyStates[k] === \"pressed\"\n\t\t\t|| app.keyStates[k] === \"rpressed\"\n\t\t\t|| app.keyStates[k] === \"down\";\n\t}\n\n\tfunction keyReleased(k: string): boolean {\n\t\treturn app.keyStates[k] === \"released\";\n\t}\n\n\tfunction charInputted(): string[] {\n\t\treturn [...app.charInputted];\n\t}\n\n\t// get delta time between last frame\n\tfunction dt(): number {\n\t\treturn app.dt;\n\t}\n\n\t// get current running time\n\tfunction time(): number {\n\t\treturn app.time;\n\t}\n\n\tfunction fps(): number {\n\t\treturn app.fps;\n\t}\n\n\t// get a base64 png image of canvas\n\tfunction screenshot(): string {\n\t\treturn app.canvas.toDataURL();\n\t}\n\n\tfunction cursor(c?: string) {\n\t\tif (c) {\n\t\t\tapp.canvas.style.cursor = c ?? \"default\";\n\t\t}\n\t\treturn app.canvas.style.cursor;\n\t}\n\n\tfunction run(f: () => void) {\n\n\t\tconst frame = (t: number) => {\n\n\t\t\tconst realTime = t / 1000;\n\t\t\tconst realDt = realTime - app.realTime;\n\n\t\t\tapp.realTime = realTime;\n\n\t\t\tif (!app.skipTime) {\n\t\t\t\tapp.dt = realDt;\n\t\t\t\tapp.time += app.dt;\n\t\t\t\tapp.fpsBuf.push(1 / app.dt);\n\t\t\t\tapp.fpsTimer += app.dt;\n\t\t\t\tif (app.fpsTimer >= 1) {\n\t\t\t\t\tapp.fpsTimer = 0;\n\t\t\t\t\tapp.fps = Math.round(app.fpsBuf.reduce((a, b) => a + b) / app.fpsBuf.length);\n\t\t\t\t\tapp.fpsBuf = [];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tapp.skipTime = false;\n\n\t\t\tf();\n\n\t\t\tfor (const k in app.keyStates) {\n\t\t\t\tapp.keyStates[k] = processBtnState(app.keyStates[k]);\n\t\t\t}\n\n\t\t\tapp.mouseState = processBtnState(app.mouseState);\n\t\t\tapp.charInputted = [];\n\t\t\tapp.mouseMoved = false;\n\t\t\tapp.loopID = requestAnimationFrame(frame);\n\n\t\t};\n\n\t\tapp.stopped = false;\n\t\tapp.loopID = requestAnimationFrame(frame);\n\n\t}\n\n\tfunction quit() {\n\t\tcancelAnimationFrame(app.loopID);\n\t\tapp.stopped = true;\n\t}\n\n\treturn {\n\t\tgl,\n\t\tmousePos,\n\t\tmouseDeltaPos,\n\t\tkeyDown,\n\t\tkeyPressed,\n\t\tkeyPressedRep,\n\t\tkeyReleased,\n\t\tmouseDown,\n\t\tmouseClicked,\n\t\tmouseReleased,\n\t\tmouseMoved,\n\t\tcharInputted,\n\t\tcursor,\n\t\tdt,\n\t\ttime,\n\t\tfps,\n\t\tscreenshot,\n\t\trun,\n\t\tquit,\n\t\tfocused: () => document.activeElement === app.canvas,\n\t\tfocus: () => app.canvas.focus(),\n\t\tcanvas: app.canvas,\n\t\tisTouch: app.isTouch,\n\t\tscale: app.scale,\n\t};\n\n}\n\nexport {\n\tApp,\n\tappInit,\n};\n", "// TODO: onend event\n\nimport {\n\tclamp,\n} from \"./math\";\n\ntype AudioCtx = {\n\tctx: AudioContext,\n\tgainNode: GainNode,\n\tmasterNode: AudioNode,\n};\n\ntype Audio = {\n\tctx(): AudioContext,\n\tvolume(v: number): number,\n\tplay(sound: AudioBuffer, conf?: AudioPlayConf): AudioPlay,\n\tburp(conf?: AudioPlayConf): AudioPlay,\n};\n\nconst MIN_GAIN = 0;\nconst MAX_GAIN = 3;\nconst MIN_SPEED = 0;\nconst MAX_SPEED = 3;\nconst MIN_DETUNE = -1200;\nconst MAX_DETUNE = 1200;\n\n// @ts-ignore\nimport burpBytes from \"./burp.mp3\";\n\nfunction audioInit(): Audio {\n\n\tconst audio: AudioCtx = (() => {\n\n\t\t// @ts-ignore\n\t\tconst ctx = new (window.AudioContext || window.webkitAudioContext)();\n\t\tconst gainNode = ctx.createGain();\n\t\tconst masterNode = gainNode;\n\n\t\tmasterNode.connect(ctx.destination);\n\n\t\treturn {\n\t\t\tctx,\n\t\t\tgainNode,\n\t\t\tmasterNode,\n\t\t};\n\n\t})();\n\n\tlet burpBuf;\n\n\taudio.ctx.decodeAudioData(burpBytes.buffer.slice(0), (buf) => {\n\t\tburpBuf = buf;\n\t}, () => {\n\t\tthrow new Error(\"failed to make burp\")\n\t});\n\n\t// get / set master volume\n\tfunction volume(v?: number): number {\n\t\tif (v !== undefined) {\n\t\t\taudio.gainNode.gain.value = clamp(v, MIN_GAIN, MAX_GAIN);\n\t\t}\n\t\treturn audio.gainNode.gain.value;\n\t}\n\n\t// plays a sound, returns a control handle\n\tfunction play(\n\t\tsound: AudioBuffer,\n\t\tconf: AudioPlayConf = {\n\t\t\tloop: false,\n\t\t\tvolume: 1,\n\t\t\tspeed: 1,\n\t\t\tdetune: 0,\n\t\t\tseek: 0,\n\t\t},\n\t): AudioPlay {\n\n\t\tlet stopped = false;\n\t\tlet srcNode = audio.ctx.createBufferSource();\n\n\t\tsrcNode.buffer = sound;\n\t\tsrcNode.loop = conf.loop ? true : false;\n\n\t\tconst gainNode = audio.ctx.createGain();\n\n\t\tsrcNode.connect(gainNode);\n\t\tgainNode.connect(audio.masterNode);\n\n\t\tconst pos = conf.seek ?? 0;\n\n\t\tsrcNode.start(0, pos);\n\n\t\tlet startTime = audio.ctx.currentTime - pos;\n\t\tlet stopTime: number | null = null;\n\n\t\tconst handle = {\n\n\t\t\tstop() {\n\t\t\t\tif (stopped) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.pause();\n\t\t\t\tstartTime = audio.ctx.currentTime;\n\t\t\t},\n\n\t\t\tplay(seek?: number) {\n\n\t\t\t\tif (!stopped) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst oldNode = srcNode;\n\n\t\t\t\tsrcNode = audio.ctx.createBufferSource();\n\t\t\t\tsrcNode.buffer = oldNode.buffer;\n\t\t\t\tsrcNode.loop = oldNode.loop;\n\t\t\t\tsrcNode.playbackRate.value = oldNode.playbackRate.value;\n\n\t\t\t\tif (srcNode.detune) {\n\t\t\t\t\tsrcNode.detune.value = oldNode.detune.value;\n\t\t\t\t}\n\n\t\t\t\tsrcNode.connect(gainNode);\n\n\t\t\t\tconst pos = seek ?? this.time();\n\n\t\t\t\tsrcNode.start(0, pos);\n\t\t\t\tstartTime = audio.ctx.currentTime - pos;\n\t\t\t\tstopped = false;\n\t\t\t\tstopTime = null;\n\n\t\t\t},\n\n\t\t\tpause() {\n\t\t\t\tif (stopped) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tsrcNode.stop();\n\t\t\t\tstopped = true;\n\t\t\t\tstopTime = audio.ctx.currentTime;\n\t\t\t},\n\n\t\t\tpaused(): boolean {\n\t\t\t\treturn stopped;\n\t\t\t},\n\n\t\t\tstopped(): boolean {\n\t\t\t\treturn stopped;\n\t\t\t},\n\n\t\t\t// TODO: affect time()\n\t\t\tspeed(val?: number): number {\n\t\t\t\tif (val !== undefined) {\n\t\t\t\t\tsrcNode.playbackRate.value = clamp(val, MIN_SPEED, MAX_SPEED);\n\t\t\t\t}\n\t\t\t\treturn srcNode.playbackRate.value;\n\t\t\t},\n\n\t\t\tdetune(val?: number): number {\n\t\t\t\tif (!srcNode.detune) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tif (val !== undefined) {\n\t\t\t\t\tsrcNode.detune.value = clamp(val, MIN_DETUNE, MAX_DETUNE);\n\t\t\t\t}\n\t\t\t\treturn srcNode.detune.value;\n\t\t\t},\n\n\t\t\tvolume(val?: number): number {\n\t\t\t\tif (val !== undefined) {\n\t\t\t\t\tgainNode.gain.value = clamp(val, MIN_GAIN, MAX_GAIN);\n\t\t\t\t}\n\t\t\t\treturn gainNode.gain.value;\n\t\t\t},\n\n\t\t\tloop() {\n\t\t\t\tsrcNode.loop = true;\n\t\t\t},\n\n\t\t\tunloop() {\n\t\t\t\tsrcNode.loop = false;\n\t\t\t},\n\n\t\t\tduration(): number {\n\t\t\t\treturn sound.duration;\n\t\t\t},\n\n\t\t\ttime(): number {\n\t\t\t\tif (stopped) {\n\t\t\t\t\treturn stopTime - startTime;\n\t\t\t\t} else {\n\t\t\t\t\treturn audio.ctx.currentTime - startTime;\n\t\t\t\t}\n\t\t\t},\n\n\t\t};\n\n\t\thandle.speed(conf.speed);\n\t\thandle.detune(conf.detune);\n\t\thandle.volume(conf.volume);\n\n\t\treturn handle;\n\n\t}\n\n\tfunction ctx(): AudioContext {\n\t\treturn audio.ctx;\n\t}\n\n\tfunction burp(conf?: AudioPlayConf) {\n\t\treturn play(burpBuf, conf);\n\t}\n\n\treturn {\n\t\tctx,\n\t\tvolume,\n\t\tplay,\n\t\tburp,\n\t};\n\n}\n\nexport {\n\tAudio,\n\taudioInit,\n};\n", "import {\n\tquad,\n} from \"./math\";\n\nimport {\n\tAudio,\n} from \"./audio\";\n\nimport {\n\tGfx,\n} from \"./gfx\";\n\n// @ts-ignore\nimport unsciiSrc from \"./unscii_8x8.png\";\n\ntype AssetsConf = {\n\terrHandler?: (err: string) => void,\n};\n\ntype LoaderID = number;\n\ntype AssetsCtx = {\n\tlastLoaderID: LoaderID,\n\tloadRoot: string,\n\tloaders: Record<number, boolean>,\n\tsprites: Record<string, SpriteData>,\n\tsounds: Record<string, SoundData>,\n\tfonts: Record<string, FontData>,\n\tshaders: Record<string, ShaderData>,\n};\n\ntype Assets = {\n\tloadRoot(path: string): string,\n\tloadSprite(\n\t\tname: string,\n\t\tsrc: SpriteLoadSrc,\n\t\tconf?: SpriteLoadConf,\n\t): Promise<SpriteData>,\n\tloadSound(\n\t\tname: string,\n\t\tsrc: string,\n\t): Promise<SoundData>,\n\tloadFont(\n\t\tname: string,\n\t\tsrc: string,\n\t\tgw: number,\n\t\tgh: number,\n\t\tchars?: string,\n\t): Promise<FontData>,\n\tloadShader(\n\t\tname: string,\n\t\tvert?: string,\n\t\tfrag?: string,\n\t\tisUrl?: boolean,\n\t): Promise<ShaderData>,\n\tloadProgress(): number,\n\tload<T>(prom: Promise<T>),\n\tdefFont(): FontData,\n\tsprites: Record<string, SpriteData>,\n\tfonts: Record<string, FontData>,\n\tsounds: Record<string, SoundData>,\n\tshaders: Record<string, ShaderData>,\n};\n\nconst ASCII_CHARS = \" !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\";\nconst CP437_CHARS = \" \u263A\u263B\u2665\u2666\u2663\u2660\u2022\u25D8\u25CB\u25D9\u2642\u2640\u266A\u266B\u263C\u25BA\u25C4\u2195\u203C\u00B6\u00A7\u25AC\u21A8\u2191\u2193\u2192\u2190\u221F\u2194\u25B2\u25BC !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2302\u00C7\u00FC\u00E9\u00E2\u00E4\u00E0\u00E5\u00E7\u00EA\u00EB\u00E8\u00EF\u00EE\u00EC\u00C4\u00C5\u00C9\u00E6\u00C6\u00F4\u00F6\u00F2\u00FB\u00F9\u00FF\u00D6\u00DC\u00A2\u00A3\u00A5\u20A7\u0192\u00E1\u00ED\u00F3\u00FA\u00F1\u00D1\u00AA\u00BA\u00BF\u2310\u00AC\u00BD\u00BC\u00A1\u00AB\u00BB\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255D\u255C\u255B\u2510\u2514\u2534\u252C\u251C\u2500\u253C\u255E\u255F\u255A\u2554\u2569\u2566\u2560\u2550\u256C\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256B\u256A\u2518\u250C\u2588\u2584\u258C\u2590\u2580\u03B1\u00DF\u0393\u03C0\u03A3\u03C3\u00B5\u03C4\u03A6\u0398\u03A9\u03B4\u221E\u03C6\u03B5\u2229\u2261\u00B1\u2265\u2264\u2320\u2321\u00F7\u2248\u00B0\u2219\u00B7\u221A\u207F\u00B2\u25A0\";\nconst DEF_FONT = \"unscii\";\n\nfunction loadImg(src: string): Promise<HTMLImageElement> {\n\tconst img = new Image();\n\timg.src = src;\n\timg.crossOrigin = \"anonymous\";\n\treturn new Promise<HTMLImageElement>((resolve, reject) => {\n\t\timg.onload = () => {\n\t\t\tresolve(img);\n\t\t};\n\t\timg.onerror = () => {\n\t\t\treject(`failed to load ${src}`);\n\t\t};\n\t});\n}\n\nfunction isDataUrl(src: string): boolean {\n\treturn src.startsWith(\"data:\");\n}\n\nfunction assetsInit(gfx: Gfx, audio: Audio, gconf: AssetsConf = {}): Assets {\n\n\tconst assets: AssetsCtx = {\n\t\tlastLoaderID: 0,\n\t\tloadRoot: \"\",\n\t\tloaders: {},\n\t\tsprites: {},\n\t\tsounds: {},\n\t\tfonts: {},\n\t\tshaders: {},\n\t};\n\n\tfunction load<T>(prom: Promise<T>) {\n\t\tconst id = assets.lastLoaderID;\n\t\tassets.loaders[id] = false;\n\t\tassets.lastLoaderID++;\n\t\tprom\n\t\t\t.catch(gconf.errHandler ?? console.error)\n\t\t\t.finally(() => assets.loaders[id] = true);\n\t}\n\n\t// get current load progress\n\tfunction loadProgress(): number {\n\n\t\tlet total = 0;\n\t\tlet loaded = 0;\n\n\t\tfor (const id in assets.loaders) {\n\t\t\ttotal += 1;\n\t\t\tif (assets.loaders[id]) {\n\t\t\t\tloaded += 1;\n\t\t\t}\n\t\t}\n\n\t\treturn loaded / total;\n\n\t}\n\n\t// global load path prefix\n\tfunction loadRoot(path: string): string {\n\t\tif (path !== undefined) {\n\t\t\tassets.loadRoot = path;\n\t\t}\n\t\treturn assets.loadRoot;\n\t}\n\n\t// load a bitmap font to asset manager\n\tfunction loadFont(\n\t\tname: string,\n\t\tsrc: string,\n\t\tgw: number,\n\t\tgh: number,\n\t\tchars: string = ASCII_CHARS,\n\t): Promise<FontData> {\n\n\t\tconst loader = new Promise<FontData>((resolve, reject) => {\n\n\t\t\tconst path = isDataUrl(src) ? src : assets.loadRoot + src;\n\n\t\t\tloadImg(path)\n\t\t\t\t.then((img) => {\n\t\t\t\t\tconst font = gfx.makeFont(gfx.makeTex(img), gw, gh, chars);\n\t\t\t\t\tassets.fonts[name] = font;\n\t\t\t\t\tresolve(font);\n\t\t\t\t})\n\t\t\t\t.catch(reject);\n\n\t\t});\n\n\t\tload(loader);\n\n\t\treturn loader;\n\n\t}\n\n\t// TODO: use getSprite() functions for async settings\n\t// load a sprite to asset manager\n\tfunction loadSprite(\n\t\tname: string,\n\t\tsrc: SpriteLoadSrc,\n\t\tconf: SpriteLoadConf = {\n\t\t\tsliceX: 1,\n\t\t\tsliceY: 1,\n\t\t\tanims: {},\n\t\t},\n\t): Promise<SpriteData> {\n\n\t\t// synchronously load sprite from local pixel data\n\t\tfunction loadRawSprite(\n\t\t\tname: string,\n\t\t\tsrc: GfxTextureData,\n\t\t\tconf: SpriteLoadConf = {\n\t\t\t\tsliceX: 1,\n\t\t\t\tsliceY: 1,\n\t\t\t\tgridWidth: 0,\n\t\t\t\tgridHeight: 0,\n\t\t\t\tanims: {},\n\t\t\t},\n\t\t) {\n\n\t\t\tconst frames = [];\n\t\t\tconst tex = gfx.makeTex(src);\n\t\t\tconst sliceX = conf.sliceX || tex.width / (conf.gridWidth || tex.width);\n\t\t\tconst sliceY = conf.sliceY || tex.height / (conf.gridHeight || tex.height);\n\t\t\tconst qw = 1 / sliceX;\n\t\t\tconst qh = 1 / sliceY;\n\n\t\t\tfor (let j = 0; j < sliceY; j++) {\n\t\t\t\tfor (let i = 0; i < sliceX; i++) {\n\t\t\t\t\tframes.push(quad(\n\t\t\t\t\t\ti * qw,\n\t\t\t\t\t\tj * qh,\n\t\t\t\t\t\tqw,\n\t\t\t\t\t\tqh,\n\t\t\t\t\t));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst sprite = {\n\t\t\t\ttex: tex,\n\t\t\t\tframes: frames,\n\t\t\t\tanims: conf.anims || {},\n\t\t\t};\n\n\t\t\tassets.sprites[name] = sprite;\n\n\t\t\treturn sprite;\n\n\t\t}\n\n\t\tconst loader = new Promise<SpriteData>((resolve, reject) => {\n\n\t\t\tif (!src) {\n\t\t\t\treturn reject(`expected sprite src for \"${name}\"`);\n\t\t\t}\n\n\t\t\t// from url\n\t\t\tif (typeof(src) === \"string\") {\n\t\t\t\tconst path = isDataUrl(src) ? src : assets.loadRoot + src;\n\t\t\t\tloadImg(path)\n\t\t\t\t\t.then((img) => {\n\t\t\t\t\t\tresolve(loadRawSprite(name, img, conf));\n\t\t\t\t\t})\n\t\t\t\t\t.catch(reject);\n\t\t\t} else {\n\t\t\t\tresolve(loadRawSprite(name, src, conf));\n\t\t\t}\n\n\t\t});\n\n\t\tload(loader);\n\n\t\treturn loader;\n\n\t}\n\n\tfunction loadShader(\n\t\tname: string,\n\t\tvert?: string,\n\t\tfrag?: string,\n\t\tisUrl: boolean = false,\n\t): Promise<ShaderData> {\n\n\t\tfunction loadRawShader(\n\t\t\tname: string,\n\t\t\tvert: string | null,\n\t\t\tfrag: string | null,\n\t\t): ShaderData {\n\t\t\tconst shader = gfx.makeProgram(vert, frag);\n\t\t\tassets.shaders[name] = shader;\n\t\t\treturn shader;\n\t\t}\n\n\t\tconst loader = new Promise<ShaderData>((resolve, reject) => {\n\n\t\t\tif (!vert && !frag) {\n\t\t\t\treturn reject(\"no shader\");\n\t\t\t}\n\n\t\t\tfunction resolveUrl(url?: string) {\n\t\t\t\treturn url ?\n\t\t\t\t\tfetch(assets.loadRoot + url)\n\t\t\t\t\t\t.then((r) => {\n\t\t\t\t\t\t\tif (r.ok) {\n\t\t\t\t\t\t\t\treturn r.text();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthrow new Error(`failed to load ${url}`)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(reject)\n\t\t\t\t\t: new Promise((r) => r(null));\n\t\t\t}\n\n\t\t\tif (isUrl) {\n\n\t\t\t\tPromise.all([resolveUrl(vert), resolveUrl(frag)])\n\t\t\t\t\t.then(([vcode, fcode]: [string | null, string | null]) => {\n\t\t\t\t\t\tresolve(loadRawShader(name, vcode, fcode));\n\t\t\t\t\t})\n\t\t\t\t\t.catch(reject);\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\tresolve(loadRawShader(name, vert, frag));\n\t\t\t\t} catch (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t}\n\t\t\t}\n\n\t\t});\n\n\t\tload(loader);\n\n\t\treturn loader;\n\n\t}\n\n\t// TODO: accept dataurl\n\t// load a sound to asset manager\n\tfunction loadSound(\n\t\tname: string,\n\t\tsrc: string,\n\t): Promise<SoundData> {\n\n\t\tconst url = assets.loadRoot + src;\n\n\t\tconst loader = new Promise<SoundData>((resolve, reject) => {\n\n\t\t\tif (!src) {\n\t\t\t\treturn reject(`expected sound src for \"${name}\"`);\n\t\t\t}\n\n\t\t\t// from url\n\t\t\tif (typeof(src) === \"string\") {\n\t\t\t\tfetch(url)\n\t\t\t\t\t.then((res) => {\n\t\t\t\t\t\tif (res.ok) {\n\t\t\t\t\t\t\treturn res.arrayBuffer();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow new Error(`failed to load ${url}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.then((data) => {\n\t\t\t\t\t\treturn new Promise((resolve2, reject2) => {\n\t\t\t\t\t\t\taudio.ctx().decodeAudioData(data, resolve2, reject2);\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.then((buf: AudioBuffer) => {\n\t\t\t\t\t\tassets.sounds[name] = buf;\n\t\t\t\t\t\tresolve(buf);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(reject);\n\t\t\t}\n\n\t\t});\n\n\t\tload(loader);\n\n\t\treturn loader;\n\n\t}\n\n\tfunction defFont(): FontData {\n\t\treturn assets.fonts[DEF_FONT];\n\t}\n\n\t// default font unscii http://pelulamu.net/unscii/\n\tloadFont(\n\t\tDEF_FONT,\n\t\tunsciiSrc,\n\t\t8,\n\t\t8\n\t);\n\n\treturn {\n\t\tloadRoot,\n\t\tloadSprite,\n\t\tloadSound,\n\t\tloadFont,\n\t\tloadShader,\n\t\tloadProgress,\n\t\tload,\n\t\tdefFont,\n\t\tsprites: assets.sprites,\n\t\tfonts: assets.fonts,\n\t\tsounds: assets.sounds,\n\t\tshaders: assets.shaders,\n\t};\n\n}\n\nexport {\n\tAssetsConf,\n\tAssets,\n\tassetsInit,\n\tDEF_FONT,\n\tASCII_CHARS,\n\tCP437_CHARS,\n};\n", "import {\n\tvec2,\n\trgba,\n\tmap,\n} from \"./math\";\n\nimport {\n\tAssets,\n} from \"./assets\";\n\nimport {\n\tGfx,\n} from \"./gfx\";\n\ntype Log = {\n\ttype: \"info\" | \"error\",\n\tmsg: string,\n};\n\ntype LoggerConf = {\n\tmax?: number,\n};\n\ntype Logger = {\n\tdraw(),\n\tinfo(msg: string),\n\terror(msg: string),\n\tclear(),\n};\n\nconst LOG_SIZE = 16;\n\nfunction loggerInit(gfx: Gfx, assets: Assets, conf: LoggerConf = {\n\tmax: 8,\n}): Logger {\n\n\tlet logs: Log[] = [];\n\tconst max = conf.max ?? 8;\n\n\t// TODO: draw rects first to reduce draw calls\n\t// TODO: make log and progress bar fixed size independent of global scale\n\tfunction draw() {\n\n\t\tif (logs.length > max) {\n\t\t\tlogs = logs.slice(0, max);\n\t\t}\n\n\t\tconst pos = vec2(0, gfx.height());\n\n\t\tlogs.forEach((log, i) => {\n\n\t\t\tconst txtAlpha = map(i, 0, max, 1, 0.5);\n\t\t\tconst bgAlpha = map(i, 0, max, 0.8, 0.2);\n\n\t\t\tconst col = (() => {\n\t\t\t\tswitch (log.type) {\n\t\t\t\t\tcase \"info\": return rgba(1, 1, 1, txtAlpha);\n\t\t\t\t\tcase \"error\": return rgba(1, 0, 0.5, txtAlpha);\n\t\t\t\t}\n\t\t\t})();\n\n\t\t\tconst ftext = gfx.fmtText(log.msg, assets.defFont(), {\n\t\t\t\tpos: pos,\n\t\t\t\torigin: \"botleft\",\n\t\t\t\tcolor: col,\n\t\t\t\tsize: LOG_SIZE / gfx.scale(),\n\t\t\t\twidth: gfx.width(),\n\t\t\t});\n\n\t\t\tgfx.drawRect(pos, ftext.width, ftext.height, {\n\t\t\t\torigin: \"botleft\",\n\t\t\t\tcolor: rgba(0, 0, 0, bgAlpha),\n\t\t\t});\n\n\t\t\tgfx.drawFmtText(ftext);\n\t\t\tpos.y -= ftext.height;\n\n\t\t});\n\n\t}\n\n\tfunction error(msg: string) {\n\t\tlogs.unshift({\n\t\t\ttype: \"error\",\n\t\t\tmsg: msg,\n\t\t});\n\t}\n\n\tfunction info(msg: string) {\n\t\tlogs.unshift({\n\t\t\ttype: \"info\",\n\t\t\tmsg: msg,\n\t\t});\n\t}\n\n\tfunction clear() {\n\t\tlogs = [];\n\t}\n\n\treturn {\n\t\tinfo,\n\t\terror,\n\t\tdraw,\n\t\tclear,\n\t};\n\n}\n\nexport {\n\tloggerInit,\n};\n", "type Net = {\n\tconnect(): Promise<WebSocket>,\n\tclose(),\n\tconnected(): boolean,\n\trecv(type: string, handler: MsgHandler),\n\tsend(type: string, data: any),\n};\n\nfunction netInit(url: string): Net {\n\n\tconst handlers: Record<string, MsgHandler[]> = {};\n\tconst sendQueue: string[] = [];\n\n\tlet socket: WebSocket | null = null;\n\n\tfunction connected(): boolean {\n\t\treturn socket !== null && socket.readyState === 1;\n\t}\n\n\tfunction connect(): Promise<WebSocket> {\n\n\t\tconst ws = new WebSocket(url);\n\n\t\treturn new Promise<WebSocket>((resolve, reject) => {\n\n\t\t\tws.onopen = () => {\n\t\t\t\tresolve(ws);\n\t\t\t\tsocket = ws;\n\t\t\t\tfor (const msg of sendQueue) {\n\t\t\t\t\tws.send(msg);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tws.onerror = () => {\n\t\t\t\treject(`failed to connect to ${url}`)\n\t\t\t};\n\n\t\t\tws.onmessage = (e) => {\n\t\t\t\tconst msg = JSON.parse(e.data);\n\t\t\t\tif (handlers[msg.type]) {\n\t\t\t\t\tfor (const handler of handlers[msg.type]) {\n\t\t\t\t\t\thandler(msg.id, msg.data);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t});\n\n\t}\n\n\tfunction recv(type: string, handler: MsgHandler) {\n\t\tif (!handlers[type]) {\n\t\t\thandlers[type] = [];\n\t\t}\n\t\thandlers[type].push(handler);\n\t}\n\n\tfunction send(type: string, data: any) {\n\t\tconst msg = JSON.stringify({\n\t\t\ttype: type,\n\t\t\tdata: data,\n\t\t});\n\t\tif (socket) {\n\t\t\tsocket.send(msg);\n\t\t} else {\n\t\t\tsendQueue.push(msg)\n\t\t}\n\t}\n\n\tfunction close() {\n\t\tif (socket) {\n\t\t\tsocket.close();\n\t\t}\n\t}\n\n\treturn {\n\t\tconnect,\n\t\tclose,\n\t\tconnected,\n\t\trecv,\n\t\tsend,\n\t};\n\n}\n\nexport {\n\tNet,\n\tnetInit,\n};\n", "// yep\n\n// @ts-ignore\nimport markSrc from \"./mark.png\";\n\nexport default (k: KaboomCtx) => {\n\n\tfunction loadMark(name: string = \"mark\"): Promise<SpriteData> {\n\t\treturn k.loadSprite(name, markSrc);\n\t}\n\n\treturn {\n\t\tloadMark,\n\t};\n\n};\n", "// load pedit\n// https://github.com/slmjkdbtl/pedit.js\n\nexport default (k: KaboomCtx) => {\n\n\tfunction loadImg(src: string): Promise<HTMLImageElement> {\n\t\tconst img = new Image();\n\t\timg.src = src;\n\t\timg.crossOrigin = \"anonymous\";\n\t\treturn new Promise<HTMLImageElement>((resolve, reject) => {\n\t\t\timg.onload = () => {\n\t\t\t\tresolve(img);\n\t\t\t};\n\t\t\timg.onerror = () => {\n\t\t\t\treject(`failed to load ${src}`);\n\t\t\t};\n\t\t});\n\t}\n\n\tfunction loadPedit(name: string, src: string): Promise<SpriteData> {\n\n\t\tconst loader = new Promise<SpriteData>((resolve, reject) => {\n\n\t\t\tfetch(k.loadRoot() + src)\n\t\t\t\t.then((res) => res.json())\n\t\t\t\t.then(async (data) => {\n\n\t\t\t\t\tconst images = await Promise.all(data.frames.map(loadImg));\n\t\t\t\t\tconst canvas = document.createElement(\"canvas\");\n\t\t\t\t\tcanvas.width = data.width;\n\t\t\t\t\tcanvas.height = data.height * data.frames.length;\n\n\t\t\t\t\tconst ctx = canvas.getContext(\"2d\");\n\n\t\t\t\t\timages.forEach((img: HTMLImageElement, i) => {\n\t\t\t\t\t\tctx.drawImage(img, 0, i * data.height);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn k.loadSprite(name, canvas, {\n\t\t\t\t\t\tsliceY: data.frames.length,\n\t\t\t\t\t\tanims: data.anims,\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.then(resolve)\n\t\t\t\t.catch(reject)\n\t\t\t\t;\n\n\t\t});\n\n\t\tk.load(loader);\n\n\t\treturn loader;\n\n\t}\n\n\treturn {\n\t\tloadPedit,\n\t};\n\n};\n", "// load aseprite spritesheet\n\nexport default (k: KaboomCtx) => {\n\nfunction loadAseprite(name: string, imgSrc: string, jsonSrc: string) {\n\n\tconst loader = new Promise<SpriteData>((resolve, reject) => {\n\n\t\t\tconst jsonPath = k.loadRoot() + jsonSrc;\n\n\t\t\tk.loadSprite(name, imgSrc)\n\t\t\t\t.then((sprite: SpriteData) => {\n\t\t\t\t\tfetch(jsonPath)\n\t\t\t\t\t\t.then((res) => {\n\t\t\t\t\t\t\treturn res.json();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then((data) => {\n\t\t\t\t\t\t\tconst size = data.meta.size;\n\t\t\t\t\t\t\tsprite.frames = data.frames.map((f: any) => {\n\t\t\t\t\t\t\t\treturn k.quad(\n\t\t\t\t\t\t\t\t\tf.frame.x / size.w,\n\t\t\t\t\t\t\t\t\tf.frame.y / size.h,\n\t\t\t\t\t\t\t\t\tf.frame.w / size.w,\n\t\t\t\t\t\t\t\t\tf.frame.h / size.h,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tfor (const anim of data.meta.frameTags) {\n\t\t\t\t\t\t\t\tsprite.anims[anim.name] = {\n\t\t\t\t\t\t\t\t\tfrom: anim.from,\n\t\t\t\t\t\t\t\t\tto: anim.to,\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresolve(sprite);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(reject)\n\t\t\t\t\t\t;\n\t\t\t\t})\n\t\t\t\t.catch(reject);\n\n\t\t});\n\n\tk.load(loader);\n\n\treturn loader;\n\n}\n\nreturn {\n\tloadAseprite,\n};\n\n};\n", "// font 04b03\n\n// @ts-ignore\nimport b04b03Src from \"./04b03_6x8.png\";\n\nexport default (k: KaboomCtx) => {\n\n\tfunction load04b03(name: string = \"04b03\"): Promise<FontData> {\n\t\treturn k.loadFont(\n\t\t\tname,\n\t\t\tb04b03Src,\n\t\t\t6,\n\t\t\t8\n\t\t);\n\t}\n\n\treturn {\n\t\tload04b03,\n\t};\n\n};\n", "// cga font\n// https://int10h.org/oldschool-pc-fonts/fontlist/font?ibm_cga\n\n// @ts-ignore\nimport cgaSrc from \"./cga_8x8.png\";\n\nexport default (k: KaboomCtx) => {\n\n\tfunction loadCGA(name: string = \"cga\"): Promise<FontData> {\n\t\treturn k.loadFont(\n\t\t\tname,\n\t\t\tcgaSrc,\n\t\t\t8,\n\t\t\t8,\n\t\t\tk.CP437_CHARS,\n\t\t);\n\t}\n\n\treturn {\n\t\tloadCGA,\n\t};\n\n};\n", "// proggy font\n// http://upperbounds.net/\n\n// @ts-ignore\nimport proggySrc from \"./proggy_7x13.png\";\n\nexport default (k: KaboomCtx) => {\n\n\tfunction loadProggy(name: string = \"proggy\"): Promise<FontData> {\n\t\treturn k.loadFont(\n\t\t\tname,\n\t\t\tproggySrc,\n\t\t\t7,\n\t\t\t13\n\t\t);\n\t}\n\n\treturn {\n\t\tloadProggy,\n\t};\n\n};\n", "type LevelConf = {\n\twidth: number,\n\theight: number,\n\tpos?: Vec2,\n\tany(s: string): Comp[] | undefined,\n\t[sym: string]: any,\n//  \t[sym: string]: Comp[] | (() => Comp[]),\n};\n\ntype Level = {\n\tgetPos(p: Vec2): Vec2,\n\tspawn(sym: string, p: Vec2): GameObj<any>,\n\twidth(): number,\n\theight(): number,\n\tgridWidth(): number,\n\tgridHeight(): number,\n\toffset(): Vec2,\n\tdestroy(),\n};\n\nexport default (k: KaboomCtx) => {\n\n\tfunction grid(level: Level, p: Vec2) {\n\n\t\treturn {\n\n\t\t\tid: \"grid\",\n\t\t\tgridPos: p.clone(),\n\n\t\t\tsetGridPos(p: Vec2) {\n\t\t\t\tthis.gridPos = p.clone();\n\t\t\t\tthis.pos = k.vec2(\n\t\t\t\t\tlevel.offset().x + this.gridPos.x * level.gridWidth(),\n\t\t\t\t\tlevel.offset().y + this.gridPos.y * level.gridHeight()\n\t\t\t\t);\n\t\t\t},\n\n\t\t\tmoveLeft() {\n\t\t\t\tthis.setGridPos(this.gridPos.add(k.vec2(-1, 0)));\n\t\t\t},\n\n\t\t\tmoveRight() {\n\t\t\t\tthis.setGridPos(this.gridPos.add(k.vec2(1, 0)));\n\t\t\t},\n\n\t\t\tmoveUp() {\n\t\t\t\tthis.setGridPos(this.gridPos.add(k.vec2(0, -1)));\n\t\t\t},\n\n\t\t\tmoveDown() {\n\t\t\t\tthis.setGridPos(this.gridPos.add(k.vec2(0, 1)));\n\t\t\t},\n\n\t\t};\n\n\t}\n\n\tfunction addLevel(map: string[], conf: LevelConf): Level {\n\n\t\tconst objs: GameObj<any>[] = [];\n\t\tconst offset = k.vec2(conf.pos || k.vec2(0));\n\t\tlet longRow = 0;\n\n\t\tconst level = {\n\n\t\t\toffset() {\n\t\t\t\treturn offset.clone();\n\t\t\t},\n\n\t\t\tgridWidth() {\n\t\t\t\treturn conf.width;\n\t\t\t},\n\n\t\t\tgridHeight() {\n\t\t\t\treturn conf.height;\n\t\t\t},\n\n\t\t\tgetPos(...args): Vec2 {\n\t\t\t\t// @ts-ignore\n\t\t\t\tconst p = k.vec2(...args);\n\t\t\t\treturn k.vec2(\n\t\t\t\t\toffset.x + p.x * conf.width,\n\t\t\t\t\toffset.y + p.y * conf.height\n\t\t\t\t);\n\t\t\t},\n\n\t\t\tspawn(sym: string, p: Vec2): GameObj<any> {\n\n\t\t\t\tconst comps = (() => {\n\t\t\t\t\tif (Array.isArray(sym)) {\n\t\t\t\t\t\treturn sym;\n\t\t\t\t\t} else if (conf[sym]) {\n\t\t\t\t\t\tif (typeof conf[sym] === \"function\") {\n\t\t\t\t\t\t\treturn conf[sym]();\n\t\t\t\t\t\t} else if (Array.isArray(conf[sym])) {\n\t\t\t\t\t\t\treturn [...conf[sym]];\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (conf.any) {\n\t\t\t\t\t\treturn conf.any(sym);\n\t\t\t\t\t}\n\t\t\t\t})();\n\n\t\t\t\tif (!comps) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcomps.push(k.pos(\n\t\t\t\t\toffset.x + p.x * conf.width,\n\t\t\t\t\toffset.y + p.y * conf.height\n\t\t\t\t));\n\n\t\t\t\tconst obj = k.add(comps);\n\n\t\t\t\tobjs.push(obj);\n\n\t\t\t\tobj.use(grid(this, p));\n\n\t\t\t\treturn obj;\n\n\t\t\t},\n\n\t\t\twidth() {\n\t\t\t\treturn longRow * conf.width;\n\t\t\t},\n\n\t\t\theight() {\n\t\t\t\treturn map.length * conf.height;\n\t\t\t},\n\n\t\t\tdestroy() {\n\t\t\t\tfor (const obj of objs) {\n\t\t\t\t\tk.destroy(obj);\n\t\t\t\t}\n\t\t\t},\n\n\t\t};\n\n\t\tmap.forEach((row, i) => {\n\n\t\t\tconst syms = row.split(\"\");\n\n\t\t\tlongRow = Math.max(syms.length, longRow);\n\n\t\t\tsyms.forEach((sym, j) => {\n\t\t\t\tlevel.spawn(sym, k.vec2(j, i));\n\t\t\t});\n\n\t\t});\n\n\t\treturn level;\n\n\t}\n\n\treturn {\n\t\taddLevel,\n\t};\n\n};\n", "import {\n\tvec2,\n\tmat4,\n\tquad,\n\trgba,\n\trgb,\n\tmakeRng,\n\trand,\n\trandSeed,\n\tchance,\n\tchoose,\n\tclamp,\n\tlerp,\n\tmap,\n\tmapc,\n\twave,\n\tcolRectRect,\n\toverlapRectRect,\n\tcolRectPt,\n\tvec2FromAngle,\n\tdeg2rad,\n\trad2deg,\n\tisVec2,\n} from \"./math\";\n\nimport {\n\toriginPt,\n\tgfxInit,\n} from \"./gfx\";\n\nimport {\n\tappInit,\n} from \"./app\";\n\nimport {\n\taudioInit,\n} from \"./audio\";\n\nimport {\n\tassetsInit,\n\tDEF_FONT,\n\tASCII_CHARS,\n\tCP437_CHARS,\n} from \"./assets\";\n\nimport {\n\tloggerInit,\n} from \"./logger\";\n\nimport {\n\tNet,\n\tnetInit,\n} from \"./net\";\n\nimport markPlugin from \"./plugins/mark\";\nimport peditPlugin from \"./plugins/pedit\";\nimport asepritePlugin from \"./plugins/aseprite\";\nimport f04b03Plugin from \"./plugins/04b03\";\nimport cgaPlugin from \"./plugins/cga\";\nimport proggyPlugin from \"./plugins/proggy\";\nimport levelPlugin from \"./plugins/level\";\n\nclass IDList<T> extends Map<number, T> {\n\t_lastID: number;\n\tconstructor(...args) {\n\t\tsuper(...args);\n\t\tthis._lastID = 0;\n\t}\n\tpush(v: T): number {\n\t\tconst id = this._lastID;\n\t\tthis.set(id, v);\n\t\tthis._lastID++;\n\t\treturn id;\n\t}\n\tpushd(v: T): () => void {\n\t\tconst id = this.push(v);\n\t\treturn () => this.delete(id);\n\t}\n}\n\n// @ts-ignore\nmodule.exports = (gconf: KaboomConf = {\n\twidth: null,\n\theight: null,\n\tscale: 1,\n\tdebug: false,\n\tcrisp: false,\n\tcanvas: null,\n\tconnect: null,\n\tlogMax: 8,\n\troot: document.body,\n\ttouchToMouse: true,\n}): KaboomCtx => {\n\nconst audio = audioInit();\n\nconst app = appInit({\n\twidth: gconf.width,\n\theight: gconf.height,\n\tscale: gconf.scale,\n\tcrisp: gconf.crisp,\n\tcanvas: gconf.canvas,\n\troot: gconf.root,\n\tstretch: gconf.stretch,\n\ttouchToMouse: gconf.touchToMouse ?? true,\n\taudioCtx: audio.ctx(),\n});\n\nconst gfx = gfxInit(app.gl, {\n\tclearColor: gconf.clearColor ? rgba(gconf.clearColor) : undefined,\n\twidth: gconf.width,\n\theight: gconf.height,\n\tscale: gconf.scale,\n\ttexFilter: gconf.texFilter,\n\tstretch: gconf.stretch,\n\tletterbox: gconf.letterbox,\n});\n\nconst assets = assetsInit(gfx, audio, {\n\terrHandler: (err: string) => {\n\t\tlogger.error(err);\n\t},\n});\n\nconst logger = loggerInit(gfx, assets, {\n\tmax: gconf.logMax,\n});\n\nconst net = gconf.connect ? netInit(gconf.connect) : null;\n\nfunction recv(ty: string, handler: MsgHandler) {\n\tif (!net) {\n\t\tthrow new Error(\"not connected to any websockets\");\n\t}\n\tnet.recv(ty, (data: any, id: number) => {\n\t\thandler(data, id);\n\t});\n}\n\nfunction send(ty: string, data: any) {\n\tif (!net) {\n\t\tthrow new Error(\"not connected to any websockets\");\n\t}\n\tnet.send(ty, data);\n}\n\nfunction dt() {\n\treturn app.dt() * debug.timeScale;\n}\n\n// TODO: clean\nfunction play(id: string, conf: AudioPlayConf = {}): AudioPlay {\n\tconst pb = audio.play(new AudioBuffer({\n\t\tlength: 1,\n\t\tnumberOfChannels: 1,\n\t\tsampleRate: 44100\n\t}));\n\tready(() => {\n\t\tconst sound = assets.sounds[id];\n\t\tif (!sound) {\n\t\t\tthrow new Error(`sound not found: \"${id}\"`);\n\t\t}\n\t\tconst pb2 = audio.play(sound, conf);\n\t\tfor (const k in pb2) {\n\t\t\tpb[k] = pb2[k];\n\t\t}\n\t});\n\treturn pb;\n}\n\nfunction isCamLayer(layer?: string): boolean {\n\treturn !game.layers[layer ?? game.defLayer]?.noCam;\n}\n\n// check input state last frame\nfunction mousePos(layer?: string): Vec2 {\n\treturn isCamLayer(layer) ? game.camMousePos : app.mousePos();\n}\n\nfunction drawSprite(\n\tid: string | SpriteData,\n\tconf: DrawSpriteConf = {},\n) {\n\tconst spr = (() => {\n\t\tif (typeof id === \"string\") {\n\t\t\treturn assets.sprites[id];\n\t\t} else {\n\t\t\treturn id;\n\t\t}\n\t})();\n\tif (!spr) {\n\t\tthrow new Error(`sprite not found: \"${id}\"`);\n\t}\n\tconst q = spr.frames[conf.frame ?? 0];\n\tgfx.drawTexture(spr.tex, {\n\t\t...conf,\n\t\tquad: q.scale(conf.quad || quad(0, 0, 1, 1)),\n\t});\n}\n\n// TODO: DrawTextComf\nfunction drawText(\n\ttxt: string,\n\tconf = {},\n) {\n\t// @ts-ignore\n\tconst fid = conf.font ?? DEF_FONT;\n\tconst font = assets.fonts[fid];\n\tif (!font) {\n\t\tthrow new Error(`font not found: ${fid}`);\n\t}\n\tgfx.drawText(txt, font, conf);\n}\n\nconst DEF_GRAVITY = 980;\nconst DEF_ORIGIN = \"topleft\";\n\ntype Timer = {\n\ttime: number,\n\tcb(),\n};\n\ntype Game = {\n\tloaded: boolean,\n\tevents: Record<string, IDList<() => void>>,\n\tobjEvents: Record<string, IDList<TaggedEvent>>,\n\tactions: IDList<() => void>,\n\trenders: IDList<() => void>,\n\tobjs: IDList<GameObj<any>>,\n\ttimers: IDList<Timer>,\n\tcam: Camera,\n\tcamMousePos: Vec2,\n\tcamMatrix: Mat4,\n\tgravity: number,\n\tlayers: Record<string, Layer>,\n\tdefLayer: string | null,\n\ttravelers: GameObjID[],\n\tvisitors: Record<ClientID, Record<GameObjID, GameObjID>>,\n\tdata: any,\n\ton<F>(ev: string, cb: F): EventCanceller,\n\ttrigger(ev: string, ...args),\n\tscenes: Record<SceneID, SceneDef>,\n\tpaused: boolean,\n};\n\ntype Camera = {\n\tpos: Vec2,\n\tscale: Vec2,\n\tangle: number,\n\tshake: number,\n};\n\ntype Layer = {\n\torder: number,\n\tnoCam: boolean,\n\talpha: number,\n}\n\ntype TaggedEvent = {\n\ttag: string,\n\tcb: (...args) => void,\n};\n\ntype KeyEvent = {\n\tkey: string,\n\tcb(),\n};\n\ntype MouseInputEvent = {\n\tcb(),\n};\n\ntype LoadEvent = () => void;\ntype NextFrameEvent = () => void;\ntype MouseEvent = () => void;\ntype CharEvent = (ch: string) => void;\n\nconst game: Game = {\n\n\tloaded: false,\n\n\t// event callbacks\n\tevents: {},\n\tobjEvents: {},\n\n\tactions: new IDList(),\n\trenders: new IDList(),\n\n\t// in game pool\n\tobjs: new IDList(),\n\ttimers: new IDList(),\n\n\t// cam\n\tcam: {\n\t\tpos: vec2(gfx.width() / 2, gfx.height() / 2),\n\t\tscale: vec2(1, 1),\n\t\tangle: 0,\n\t\tshake: 0,\n\t},\n\n\tcamMousePos: app.mousePos(),\n\tcamMatrix: mat4(),\n\n\t// misc\n\tlayers: {},\n\tdefLayer: null,\n\tgravity: DEF_GRAVITY,\n\tdata: {},\n\n\t// net\n\ttravelers: [],\n\tvisitors: {},\n\n\ton<F>(ev: string, cb: F): EventCanceller {\n\t\tif (!this.events[ev]) {\n\t\t\tthis.events[ev] = new IDList();\n\t\t}\n\t\treturn this.events[ev].pushd(cb);\n\t},\n\n\ttrigger(ev: string, ...args) {\n\t\tif (this.events[ev]) {\n\t\t\tthis.events[ev].forEach((cb) => cb(...args));\n\t\t}\n\t},\n\n\tscenes: {},\n\tpaused: false,\n\n};\n\nfunction layers(list: string[], def?: string) {\n\n\tlist.forEach((name, idx) => {\n\t\tgame.layers[name] = {\n\t\t\talpha: 1,\n\t\t\torder: idx + 1,\n\t\t\tnoCam: false,\n\t\t};\n\t});\n\n\tif (def) {\n\t\tgame.defLayer = def;\n\t}\n\n}\n\nfunction camPos(...pos): Vec2 {\n\tif (pos.length > 0) {\n\t\tgame.cam.pos = vec2(...pos);\n\t}\n\treturn game.cam.pos.clone();\n}\n\nfunction camScale(...scale): Vec2 {\n\tif (scale.length > 0) {\n\t\tgame.cam.scale = vec2(...scale);\n\t}\n\treturn game.cam.scale.clone();\n}\n\nfunction camRot(angle: number): number {\n\tif (angle !== undefined) {\n\t\tgame.cam.angle = angle;\n\t}\n\treturn game.cam.angle;\n}\n\nfunction camIgnore(layers: string[]) {\n\tlayers.forEach((name) => {\n\t\tif (game.layers[name]) {\n\t\t\tgame.layers[name].noCam = true;\n\t\t}\n\t})\n}\n\nfunction shake(intensity: number) {\n\tgame.cam.shake = intensity;\n}\n\nconst COMP_DESC = new Set([\n\t\"id\",\n\t\"require\",\n]);\n\nconst COMP_EVENTS = new Set([\n\t\"add\",\n\t\"load\",\n\t\"update\",\n\t\"draw\",\n\t\"destroy\",\n\t\"inspect\",\n]);\n\n// TODO: type check won't work if pass CustomData\nfunction add<T extends Comp>(comps: ReadonlyArray<T | Tag | CustomData>): GameObj<T> {\n\n\tconst compStates = {};\n\tconst customState = {};\n\tconst events = {};\n\tconst tags = [];\n\n\tconst obj = {\n\n\t\t_id: null,\n\t\thidden: false,\n\t\tpaused: false,\n\n\t\t// use a comp, or tag\n\t\tuse(comp: Comp | Tag) {\n\n\t\t\tif (!comp) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// tag\n\t\t\tif (typeof comp === \"string\") {\n\t\t\t\ttags.push(comp);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// clear if overwrite\n\t\t\tif (comp.id) {\n\t\t\t\tthis.unuse(comp.id);\n\t\t\t\tcompStates[comp.id] = {};\n\t\t\t}\n\n\t\t\t// state source location\n\t\t\tconst stateContainer = comp.id ? compStates[comp.id] : customState;\n\n\t\t\tstateContainer.cleanups = [];\n\n\t\t\tfor (const k in comp) {\n\n\t\t\t\tif (COMP_DESC.has(k)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// event / custom method\n\t\t\t\tif (typeof comp[k] === \"function\") {\n\t\t\t\t\tconst func = comp[k].bind(this);\n\t\t\t\t\tif (COMP_EVENTS.has(k)) {\n\t\t\t\t\t\tstateContainer.cleanups.push(this.on(k, func));\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstateContainer[k] = func;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tstateContainer[k] = comp[k];\n\t\t\t\t}\n\n\t\t\t\tif (this[k] === undefined) {\n\t\t\t\t\t// assign comp fields to game obj\n\t\t\t\t\tObject.defineProperty(this, k, {\n\t\t\t\t\t\tget: () => stateContainer[k],\n\t\t\t\t\t\tset: (val) => stateContainer[k] = val,\n\t\t\t\t\t\tconfigurable: true,\n\t\t\t\t\t\tenumerable: true,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst checkDeps = () => {\n\t\t\t\tif (!comp.require) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tfor (const dep of comp.require) {\n\t\t\t\t\tif (!this.c(dep)) {\n\t\t\t\t\t\tthrow new Error(`comp '${comp.id}' requires comp '${dep}'`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// check deps or run add event\n\t\t\tif (this.exists()) {\n\t\t\t\tif (comp.add) {\n\t\t\t\t\tcomp.add.call(this);\n\t\t\t\t}\n\t\t\t\tif (comp.load) {\n\t\t\t\t\tready(() => comp.load.call(this));\n\t\t\t\t}\n\t\t\t\tcheckDeps();\n\t\t\t} else {\n\t\t\t\tif (comp.require) {\n\t\t\t\t\tstateContainer.cleanups.push(this.on(\"add\", () => {\n\t\t\t\t\t\tcheckDeps();\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t}\n\n\t\t},\n\n\t\tunuse(comp: CompID) {\n\t\t\tif (compStates[comp]) {\n\t\t\t\tcompStates[comp].cleanups.forEach((f) => f());\n\t\t\t\tfor (const k in compStates[comp]) {\n\t\t\t\t\tdelete compStates[comp][k];\n\t\t\t\t}\n\t\t\t}\n\t\t\tcompStates[comp] = {};\n\t\t},\n\n\t\tc(id: string): Comp {\n\t\t\treturn compStates[id];\n\t\t},\n\n\t\t// if obj is current in scene\n\t\texists(): boolean {\n\t\t\treturn this._id !== null;\n\t\t},\n\n\t\t// if obj has certain tag\n\t\tis(tag: Tag | Tag[]): boolean {\n\t\t\tif (tag === \"*\") {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (Array.isArray(tag)) {\n\t\t\t\tfor (const t of tag) {\n\t\t\t\t\tif (!tags.includes(t)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn tags.includes(tag);\n\t\t},\n\n\t\ton(ev: string, cb): EventCanceller {\n\t\t\tif (!events[ev]) {\n\t\t\t\tevents[ev] = new IDList();\n\t\t\t}\n\t\t\treturn events[ev].pushd(cb);\n\t\t},\n\n\t\taction(cb: () => void): EventCanceller {\n\t\t\treturn this.on(\"update\", cb);\n\t\t},\n\n\t\ttrigger(ev: string, ...args): void {\n\n\t\t\tif (events[ev]) {\n\t\t\t\tevents[ev].forEach((cb) => cb.call(this, ...args));\n\t\t\t}\n\n\t\t\tconst gEvents = game.objEvents[ev];\n\n\t\t\tif (gEvents) {\n\t\t\t\tgEvents.forEach((e) => {\n\t\t\t\t\tif (this.is(e.tag)) {\n\t\t\t\t\t\te.cb(this, ...args);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t},\n\n\t\tuntag(t: Tag) {\n\t\t\tconst idx = tags.indexOf(t);\n\t\t\tif (idx > -1) {\n\t\t\t\ttags.splice(idx, 1);\n\t\t\t}\n\t\t},\n\n\t\tdestroy() {\n\t\t\tdestroy(this);\n\t\t},\n\n\t\t_inspect() {\n\n\t\t\tconst info = [];\n\n\t\t\tif (events[\"inspect\"]) {\n\t\t\t\tfor (const inspect of events[\"inspect\"].values()) {\n\t\t\t\t\tconst data = inspect();\n\t\t\t\t\tif (data) {\n\t\t\t\t\t\tinfo.push(data);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttags: tags,\n\t\t\t\tinfo: info,\n\t\t\t};\n\n\t\t},\n\n\t};\n\n\tfor (const comp of comps) {\n\t\tobj.use(comp);\n\t}\n\n\tobj._id = game.objs.push(obj);\n\tobj.trigger(\"add\");\n\tready(() => obj.trigger(\"load\"));\n\n\treturn obj as unknown as GameObj<T>;\n\n}\n\nfunction readd(obj: GameObj<any>): GameObj<any> {\n\n\tif (!obj.exists()) {\n\t\treturn;\n\t}\n\n\tgame.objs.delete(obj._id);\n\tobj._id = game.objs.push(obj);\n\tobj.trigger(\"add\");\n\tready(() => obj.trigger(\"load\"));\n\n\treturn obj;\n\n}\n\n// add an event to a tag\nfunction on(event: string, tag: string, cb: (obj: GameObj<any>) => void): EventCanceller {\n\tif (!game.objEvents[event]) {\n\t\tgame.objEvents[event] = new IDList();\n\t}\n\treturn game.objEvents[event].pushd({\n\t\ttag: tag,\n\t\tcb: cb,\n\t});\n}\n\n// add update event to a tag or global update\nfunction action(tag: string | (() => void), cb?: (obj: GameObj<any>) => void): EventCanceller {\n\tif (typeof tag === \"function\" && cb === undefined) {\n\t\treturn game.actions.pushd(tag);\n\t} else if (typeof tag === \"string\") {\n\t\treturn on(\"update\", tag, cb);\n\t}\n}\n\n// add draw event to a tag or global draw\nfunction render(tag: string | (() => void), cb?: (obj: GameObj<any>) => void) {\n\tif (typeof tag === \"function\" && cb === undefined) {\n\t\treturn game.renders.pushd(tag);\n\t} else if (typeof tag === \"string\") {\n\t\treturn on(\"update\", tag, cb);\n\t}\n}\n\n// add an event that runs with objs with t1 collides with objs with t2\nfunction collides(\n\tt1: string,\n\tt2: string,\n\tf: (a: GameObj<any>, b: GameObj<any>) => void,\n): EventCanceller {\n\treturn action(t1, (o1: GameObj<any>) => {\n\t\to1._checkCollisions(t2, (o2) => {\n\t\t\tf(o1, o2);\n\t\t});\n\t});\n}\n\n// add an event that runs with objs with t1 overlaps with objs with t2\nfunction overlaps(\n\tt1: string,\n\tt2: string,\n\tf: (a: GameObj<any>, b: GameObj<any>) => void,\n): EventCanceller {\n\treturn action(t1, (o1: GameObj<any>) => {\n\t\to1._checkOverlaps(t2, (o2) => {\n\t\t\tf(o1, o2);\n\t\t});\n\t});\n}\n\n// add an event that runs when objs with tag t is clicked\nfunction clicks(t: string, f: (obj: GameObj<any>) => void): EventCanceller {\n\treturn action(t, (o: GameObj<any>) => {\n\t\tif (o.isClicked()) {\n\t\t\tf(o);\n\t\t}\n\t});\n}\n\n// add an event that'd be run after t\nfunction wait(t: number, f?: () => void): Promise<void> {\n\treturn new Promise((resolve) => {\n\t\tgame.timers.push({\n\t\t\ttime: t,\n\t\t\tcb: () => {\n\t\t\t\tif (f) {\n\t\t\t\t\tf();\n\t\t\t\t}\n\t\t\t\tresolve();\n\t\t\t},\n\t\t});\n\t});\n}\n\n// add an event that's run every t seconds\nfunction loop(t: number, f: () => void): EventCanceller {\n\n\tlet stopped = false;\n\n\tconst newF = () => {\n\t\tif (stopped) {\n\t\t\treturn;\n\t\t}\n\t\tf();\n\t\twait(t, newF);\n\t};\n\n\tnewF();\n\n\treturn () => stopped = true;\n\n}\n\n// input callbacks\nfunction keyDown(k: string, f: () => void): EventCanceller {\n\tif (Array.isArray(k)) {\n\t\tconst cancellers = k.map((key) => keyDown(key, f));\n\t\treturn () => cancellers.forEach((cb) => cb());\n\t} else {\n\t\treturn game.on(\"input\", () => app.keyDown(k) && f());\n\t}\n}\n\nfunction keyPress(k: string, f: () => void): EventCanceller {\n\tif (Array.isArray(k)) {\n\t\tconst cancellers = k.map((key) => keyPress(key, f));\n\t\treturn () => cancellers.forEach((cb) => cb());\n\t} else {\n\t\treturn game.on(\"input\", () => app.keyPressed(k) && f());\n\t}\n}\n\nfunction keyPressRep(k: string, f: () => void): EventCanceller {\n\tif (Array.isArray(k)) {\n\t\tconst cancellers = k.map((key) => keyPressRep(key, f));\n\t\treturn () => cancellers.forEach((cb) => cb());\n\t} else {\n\t\treturn game.on(\"input\", () => app.keyPressedRep(k) && f());\n\t}\n}\n\nfunction keyRelease(k: string, f: () => void): EventCanceller {\n\tif (Array.isArray(k)) {\n\t\tconst cancellers = k.map((key) => keyRelease(key, f));\n\t\treturn () => cancellers.forEach((cb) => cb());\n\t} else {\n\t\treturn game.on(\"input\", () => app.keyReleased(k) && f());\n\t}\n}\n\n// TODO: these mousePos() are from last frame\nfunction mouseDown(f: (pos: Vec2) => void): EventCanceller {\n\treturn game.on(\"input\", () => app.mouseDown() && f(mousePos()));\n}\n\nfunction mouseClick(f: (pos: Vec2) => void): EventCanceller {\n\treturn game.on(\"input\", () => app.mouseClicked() && f(mousePos()));\n}\n\nfunction mouseRelease(f: (pos: Vec2) => void): EventCanceller {\n\treturn game.on(\"input\", () => app.mouseReleased() && f(mousePos()));\n}\n\n// TODO: pass delta pos\nfunction mouseMove(f: (pos: Vec2, dpos: Vec2) => void): EventCanceller {\n\treturn game.on(\"input\", () => app.mouseMoved() && f(mousePos(), app.mouseDeltaPos()));\n}\n\nfunction charInput(f: (ch: string) => void): EventCanceller {\n\treturn game.on(\"input\", () => app.charInputted().forEach((ch) => f(ch)));\n}\n\n// TODO\napp.canvas.addEventListener(\"touchstart\", (e) => {\n\t[...e.changedTouches].forEach((t) => {\n\t\tgame.trigger(\"touchStart\", t.identifier, vec2(t.clientX, t.clientY).scale(1 / app.scale));\n\t});\n});\n\napp.canvas.addEventListener(\"touchmove\", (e) => {\n\t[...e.changedTouches].forEach((t) => {\n\t\tgame.trigger(\"touchMove\", t.identifier, vec2(t.clientX, t.clientY).scale(1 / app.scale));\n\t});\n});\n\napp.canvas.addEventListener(\"touchmove\", (e) => {\n\t[...e.changedTouches].forEach((t) => {\n\t\tgame.trigger(\"touchEnd\", t.identifier, vec2(t.clientX, t.clientY).scale(1 / app.scale));\n\t});\n});\n\nfunction touchStart(f: (id: TouchID, pos: Vec2) => void): EventCanceller {\n\treturn game.on(\"touchStart\", f);\n}\n\nfunction touchMove(f: (id: TouchID, pos: Vec2) => void): EventCanceller {\n\treturn game.on(\"touchMove\", f);\n}\n\nfunction touchEnd(f: (id: TouchID, pos: Vec2) => void): EventCanceller {\n\treturn game.on(\"touchEnd\", f);\n}\n\n// TODO: cache sorted list\n// get all objects with tag\nfunction get(t?: string): GameObj<any>[] {\n\n\tconst objs = [...game.objs.values()].sort((o1, o2) => {\n\t\tconst l1 = game.layers[o1.layer ?? game.defLayer]?.order ?? 0;;\n\t\tconst l2 = game.layers[o2.layer ?? game.defLayer]?.order ?? 0;\n\t\treturn l1 - l2;\n\t});\n\n\tif (!t) {\n\t\treturn objs;\n\t} else {\n\t\treturn objs.filter(obj => obj.is(t));\n\t}\n\n}\n\n// apply a function to all objects currently in game with tag t\nfunction every<T>(t: string | ((obj: GameObj<any>) => T), f?: (obj: GameObj<any>) => T): T[] {\n\tif (typeof t === \"function\" && f === undefined) {\n\t\treturn get().map(t);\n\t} else if (typeof t === \"string\") {\n\t\treturn get(t).map(f);\n\t}\n}\n\n// every but in reverse order\nfunction revery<T>(t: string | ((obj: GameObj<any>) => T), f?: (obj: GameObj<any>) => T): T[] {\n\tif (typeof t === \"function\" && f === undefined) {\n\t\treturn get().reverse().map(t);\n\t} else if (typeof t === \"string\") {\n\t\treturn get(t).reverse().map(f);\n\t}\n}\n\n// destroy an obj\nfunction destroy(obj: GameObj<any>) {\n\n\tif (!obj.exists()) {\n\t\treturn;\n\t}\n\n\tobj.trigger(\"destroy\");\n\tgame.objs.delete(obj._id);\n\tdelete obj._id;\n\n}\n\n// destroy all obj with the tag\nfunction destroyAll(t: string) {\n\tevery(t, (obj) => {\n\t\tdestroy(obj);\n\t});\n}\n\n// get / set gravity\nfunction gravity(g?: number): number {\n\tif (g !== undefined) {\n\t\tgame.gravity = g;\n\t}\n\treturn game.gravity;\n}\n\n// TODO: cleaner pause logic\nfunction gameFrame(ignorePause?: boolean) {\n\n\tgame.trigger(\"nextFrame\");\n\tdelete game.events[\"nextFrame\"];\n\n\tconst doUpdate = ignorePause || !debug.paused;\n\n\tif (doUpdate) {\n\n\t\t// update timers\n\t\tgame.timers.forEach((t, id) => {\n\t\t\tt.time -= dt();\n\t\t\tif (t.time <= 0) {\n\t\t\t\tt.cb();\n\t\t\t\tgame.timers.delete(id);\n\t\t\t}\n\t\t});\n\n\t\t// update every obj\n\t\trevery((obj) => {\n\t\t\tif (!obj.paused) {\n\t\t\t\tobj.trigger(\"update\");\n\t\t\t}\n\t\t});\n\n\t\tgame.actions.forEach((a) => a());\n\n\t}\n\n\t// calculate camera matrix\n\tconst size = vec2(gfx.width(), gfx.height());\n\tconst cam = game.cam;\n\tconst shake = vec2FromAngle(rand(0, Math.PI * 2)).scale(cam.shake);\n\n\tcam.shake = lerp(cam.shake, 0, 5 * dt());\n\tgame.camMatrix = mat4()\n\t\t.translate(size.scale(0.5))\n\t\t.scale(cam.scale)\n\t\t.rotateZ(cam.angle)\n\t\t.translate(size.scale(-0.5))\n\t\t.translate(cam.pos.scale(-1).add(size.scale(0.5)).add(shake))\n\t\t;\n\n\t// draw every obj\n\tevery((obj) => {\n\n\t\tif (!obj.hidden) {\n\n\t\t\tgfx.pushTransform();\n\n\t\t\tif (isCamLayer(obj.layer)) {\n\t\t\t\tgfx.pushMatrix(game.camMatrix);\n\t\t\t}\n\n\t\t\tobj.trigger(\"draw\");\n\t\t\tgfx.popTransform();\n\n\t\t}\n\n\t});\n\n\tgame.renders.forEach((r) => r());\n\n}\n\nfunction drawInspect() {\n\n\tlet inspecting = null;\n\tconst font = assets.defFont();\n\tconst lcolor = rgba(gconf.inspectColor ?? [0, 1, 1, 1]);\n\n\tfunction drawInspectTxt(pos, txt, scale) {\n\n\t\tconst pad = vec2(4).scale(1 / scale);\n\n\t\tconst ftxt = gfx.fmtText(txt, font, {\n\t\t\tsize: 12 / scale,\n\t\t\tpos: pos.add(vec2(pad.x, pad.y)),\n\t\t});\n\n\t\tgfx.drawRect(pos, ftxt.width + pad.x * 2, ftxt.height + pad.x * 2, {\n\t\t\tcolor: rgba(0, 0, 0, 1),\n\t\t});\n\n\t\tgfx.drawFmtText(ftxt);\n\n\t}\n\n\tfunction drawObj(obj, f) {\n\t\tconst isCam = isCamLayer(obj.layer);\n\t\tconst scale = gfx.scale() * (isCam ? (game.cam.scale.x + game.cam.scale.y) / 2 : 1);\n\t\tif (isCam) {\n\t\t\tgfx.pushTransform();\n\t\t\tgfx.pushMatrix(game.camMatrix);\n\t\t}\n\t\tf(scale);\n\t\tif (isCam) {\n\t\t\tgfx.popTransform();\n\t\t}\n\t}\n\n\trevery((obj) => {\n\n\t\tif (!obj.area) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (obj.hidden) {\n\t\t\treturn;\n\t\t}\n\n\t\tdrawObj(obj, (scale) => {\n\n\t\t\tif (!inspecting) {\n\t\t\t\tif (obj.isHovered()) {\n\t\t\t\t\tinspecting = obj;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst lwidth = (inspecting === obj ? 6 : 2) / scale;\n\t\t\tconst a = obj.worldArea();\n\t\t\tconst w = a.p2.x - a.p1.x;\n\t\t\tconst h = a.p2.y - a.p1.y;\n\n\t\t\tgfx.drawRectStroke(a.p1, w, h, {\n\t\t\t\twidth: lwidth,\n\t\t\t\tcolor: lcolor,\n\t\t\t});\n\n\t\t});\n\n\t});\n\n\tif (inspecting) {\n\n\t\tdrawObj(inspecting, (scale) => {\n\n\t\t\tconst mpos = mousePos(inspecting.layer);\n\t\t\tconst lines = [];\n\t\t\tconst data = inspecting._inspect();\n\n\t\t\tif (data.tags.length === 0 && data.info.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfor (const tag of data.tags) {\n\t\t\t\tlines.push(`\"${tag}\"`);\n\t\t\t}\n\n\t\t\tfor (const info of data.info) {\n\t\t\t\tfor (const field in info) {\n\t\t\t\t\tlines.push(`${field}: ${info[field]}`);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdrawInspectTxt(mpos, lines.join(\"\\n\"), scale);\n\n\t\t});\n\n\t}\n\n\tdrawInspectTxt(vec2(0), app.fps() + \"\", gfx.scale());\n\n}\n\n// TODO: have velocity here?\nfunction pos(...args): PosComp {\n\n\treturn {\n\n\t\tid: \"pos\",\n\t\tpos: vec2(...args),\n\n\t\t// TODO: check physics here?\n\t\t// move with velocity (pixels per second)\n\t\tmove(...args) {\n\n\t\t\tconst p = vec2(...args);\n\t\t\tconst dx = p.x * dt();\n\t\t\tconst dy = p.y * dt();\n\n\t\t\tthis.pos.x += dx;\n\t\t\tthis.pos.y += dy;\n\n\t\t},\n\n\t\t// move to a destination, with optional speed\n\t\tmoveTo(dest: Vec2, speed?: number) {\n\t\t\tif (speed === undefined) {\n\t\t\t\tthis.pos = vec2(dest);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst diff = dest.sub(this.pos);\n\t\t\tif (diff.len() <= speed) {\n\t\t\t\tthis.pos = vec2(dest);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.pos = this.pos.add(diff.unit().scale(speed));\n\t\t},\n\n\t\t// TODO: check if on cam ignored layer\n\t\t// get the screen position (transformed by camera)\n\t\tscreenPos(): Vec2 {\n\t\t\treturn game.camMatrix.multVec2(this.pos);\n\t\t},\n\n\t\tinspect() {\n\t\t\treturn {\n\t\t\t\tpos: `(${~~this.pos.x}, ${~~this.pos.y})`,\n\t\t\t};\n\t\t},\n\n\t};\n\n};\n\n// TODO: allow single number assignment\nfunction scale(...args): ScaleComp {\n\tif (args.length === 0) {\n\t\treturn scale(1);\n\t}\n\treturn {\n\t\tid: \"scale\",\n\t\tscale: vec2(...args),\n\t};\n}\n\nfunction rotate(r: number): RotateComp {\n\treturn {\n\t\tid: \"rotate\",\n\t\tangle: r ?? 0,\n\t};\n}\n\nfunction color(...args): ColorComp {\n\treturn {\n\t\tid: \"color\",\n\t\tcolor: rgba(...args),\n\t};\n}\n\nfunction origin(o: Origin | Vec2): OriginComp {\n\treturn {\n\t\tid: \"origin\",\n\t\torigin: o,\n\t};\n}\n\nfunction layer(l: string): LayerComp {\n\treturn {\n\t\tid: \"layer\",\n\t\tlayer: l,\n\t\tinspect(): LayerCompInspect {\n\t\t\treturn {\n\t\t\t\tlayer: this.layer ?? game.defLayer,\n\t\t\t};\n\t\t},\n\t};\n}\n\nfunction isSameLayer(o1: GameObj<any>, o2: GameObj<any>): boolean {\n\treturn (o1.layer ?? game.defLayer) === (o2.layer ?? game.defLayer);\n}\n\n// TODO: tell which side collides\nfunction area(p1?: Vec2 | number, p2?: Vec2 | number): AreaComp {\n\n\tconst colliding = {};\n\tconst overlapping = {};\n\n\t// scale for auto area\n\tconst aScale = vec2(1);\n\n\tif (typeof p1 === \"number\") {\n\t\taScale.x = p1;\n\t\taScale.y = p1;\n\t\tif (typeof p2 === \"number\") {\n\t\t\taScale.y = p2;\n\t\t}\n\t}\n\n\treturn {\n\n\t\tid: \"area\",\n\n\t\tarea: {\n\t\t\tp1: isVec2(p1) ? p1 as Vec2 : null,\n\t\t\tp2: isVec2(p2) ? p2 as Vec2 : null,\n\t\t},\n\n\t\tareaWidth(): number {\n\t\t\tconst { p1, p2 } = this.worldArea();\n\t\t\treturn p2.x - p1.x;\n\t\t},\n\n\t\tareaHeight(): number {\n\t\t\tconst { p1, p2 } = this.worldArea();\n\t\t\treturn p2.y - p1.y;\n\t\t},\n\n\t\tisClicked(): boolean {\n\t\t\treturn app.mouseClicked() && this.isHovered();\n\t\t},\n\n\t\tisHovered() {\n\t\t\tif (app.isTouch) {\n\t\t\t\treturn app.mouseDown() && this.hasPt(mousePos(this.layer));\n\t\t\t} else {\n\t\t\t\treturn this.hasPt(mousePos(this.layer));\n\t\t\t}\n\t\t},\n\n\t\tisCollided(other) {\n\n\t\t\tif (!other.area) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!isSameLayer(this, other)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst a1 = this.worldArea();\n\t\t\tconst a2 = other.worldArea();\n\n\t\t\treturn colRectRect(a1, a2);\n\n\t\t},\n\n\t\tisOverlapped(other) {\n\n\t\t\tif (!other.area) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!isSameLayer(this, other)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst a1 = this.worldArea();\n\t\t\tconst a2 = other.worldArea();\n\n\t\t\treturn overlapRectRect(a1, a2);\n\n\t\t},\n\n\t\tclicks(f: () => void) {\n\t\t\tthis.action(() => {\n\t\t\t\tif (this.isClicked()) {\n\t\t\t\t\tf();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\thovers(f: () => void) {\n\t\t\tthis.action(() => {\n\t\t\t\tif (this.isHovered()) {\n\t\t\t\t\tf();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tcollides(tag: string, f: (o: GameObj<any>) => void) {\n\t\t\tthis.action(() => {\n\t\t\t\tthis._checkCollisions(tag, f);\n\t\t\t});\n\t\t},\n\n\t\toverlaps(tag: string, f: (o: GameObj<any>) => void) {\n\t\t\tthis.action(() => {\n\t\t\t\tthis._checkOverlaps(tag, f);\n\t\t\t});\n\t\t},\n\n\t\thasPt(pt: Vec2): boolean {\n\t\t\tconst a = this.worldArea();\n\t\t\treturn colRectPt({\n\t\t\t\tp1: a.p1,\n\t\t\t\tp2: a.p2,\n\t\t\t}, pt);\n\t\t},\n\n\t\t// TODO: make overlap events still trigger\n\t\t// push an obj out of another if they're overlapped\n\t\tpushOut(obj: GameObj<any>): PushOut | null {\n\n\t\t\tif (obj === this) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (!obj.area) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (!isSameLayer(this, obj)) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst a1 = this.worldArea();\n\t\t\tconst a2 = obj.worldArea();\n\n\t\t\tif (!colRectRect(a1, a2)) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst disLeft = a1.p2.x - a2.p1.x;\n\t\t\tconst disRight = a2.p2.x - a1.p1.x;\n\t\t\tconst disTop = a1.p2.y - a2.p1.y;\n\t\t\tconst disBottom = a2.p2.y - a1.p1.y;\n\t\t\tconst min = Math.min(disLeft, disRight, disTop, disBottom);\n\n\t\t\tswitch (min) {\n\t\t\t\tcase disLeft:\n\t\t\t\t\tthis.pos.x -= disLeft;\n\t\t\t\t\treturn {\n\t\t\t\t\t\tobj: obj,\n\t\t\t\t\t\tside: \"right\",\n\t\t\t\t\t\tdis: -disLeft,\n\t\t\t\t\t};\n\t\t\t\tcase disRight:\n\t\t\t\t\tthis.pos.x += disRight;\n\t\t\t\t\treturn {\n\t\t\t\t\t\tobj: obj,\n\t\t\t\t\t\tside: \"left\",\n\t\t\t\t\t\tdis: disRight,\n\t\t\t\t\t};\n\t\t\t\tcase disTop:\n\t\t\t\t\tthis.pos.y -= disTop;\n\t\t\t\t\treturn {\n\t\t\t\t\t\tobj: obj,\n\t\t\t\t\t\tside: \"bottom\",\n\t\t\t\t\t\tdis: -disTop,\n\t\t\t\t\t};\n\t\t\t\tcase disBottom:\n\t\t\t\t\tthis.pos.y += disBottom;\n\t\t\t\t\treturn {\n\t\t\t\t\t\tobj: obj,\n\t\t\t\t\t\tside: \"top\",\n\t\t\t\t\t\tdis: disBottom,\n\t\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn null;\n\n\t\t},\n\n\t\t// push object out of other solid objects\n\t\tpushOutAll(): PushOut[] {\n\t\t\treturn every((other) => other.solid ? this.pushOut(other) : null)\n\t\t\t\t.filter((res) => res != null);\n\t\t},\n\n\t\t_checkCollisions(tag: string, f: (obj: GameObj<any>) => void) {\n\n\t\t\tevery(tag, (obj) => {\n\t\t\t\tif (this === obj) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (colliding[obj._id]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this.isCollided(obj)) {\n\t\t\t\t\tf(obj);\n\t\t\t\t\tcolliding[obj._id] = obj;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfor (const id in colliding) {\n\t\t\t\tconst obj = colliding[id];\n\t\t\t\tif (!this.isCollided(obj)) {\n\t\t\t\t\tdelete colliding[id];\n\t\t\t\t}\n\t\t\t}\n\n\t\t},\n\n\t\t// TODO: repetitive with collides\n\t\t_checkOverlaps(tag: string, f: (obj: GameObj<any>) => void) {\n\n\t\t\tevery(tag, (obj) => {\n\t\t\t\tif (this === obj) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (overlapping[obj._id]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this.isOverlapped(obj)) {\n\t\t\t\t\tf(obj);\n\t\t\t\t\toverlapping[obj._id] = obj;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfor (const id in overlapping) {\n\t\t\t\tconst obj = overlapping[id];\n\t\t\t\tif (!this.isOverlapped(obj)) {\n\t\t\t\t\tdelete overlapping[id];\n\t\t\t\t}\n\t\t\t}\n\n\t\t},\n\n\t\t// TODO: cache\n\t\t// TODO: use matrix mult for more accuracy and rotation?\n\t\tworldArea(): Rect {\n\n\t\t\tconst a = {\n\t\t\t\tp1: this.area.p1,\n\t\t\t\tp2: this.area.p2,\n\t\t\t};\n\n\t\t\tif (!a.p1 && !a.p2 && this.width && this.height) {\n\n\t\t\t\tconst size = vec2(this.width, this.height).scale(aScale);\n\t\t\t\tconst offset = originPt(this.origin || DEF_ORIGIN).scale(size).scale(-0.5);\n\n\t\t\t\ta.p1 = offset.sub(size.scale(0.5));\n\t\t\t\ta.p2 = offset.add(size.scale(0.5));\n\n\t\t\t}\n\n\t\t\tconst pos = this.pos || vec2(0);\n\t\t\tconst scale = this.scale || vec2(1);\n\t\t\tconst p1 = pos.add(a.p1.scale(scale));\n\t\t\tconst p2 = pos.add(a.p2.scale(scale));\n\n\t\t\treturn {\n\t\t\t\tp1: vec2(Math.min(p1.x, p2.x), Math.min(p1.y, p2.y)),\n\t\t\t\tp2: vec2(Math.max(p1.x, p2.x), Math.max(p1.y, p2.y)),\n\t\t\t};\n\n\t\t},\n\n\t};\n\n}\n\n// TODO: clean\nfunction sprite(id: string, conf: SpriteCompConf = {}): SpriteComp {\n\n\tlet spr = null;\n\tlet curAnim: SpriteCurAnim | null = null;\n\n\tfunction calcTexScale(tex: GfxTexture, q: Quad, w?: number, h?: number): Vec2 {\n\t\tconst scale = vec2(1, 1);\n\t\tif (w && h) {\n\t\t\tscale.x = w / (tex.width * q.w);\n\t\t\tscale.y = h / (tex.height * q.h);\n\t\t} else if (w) {\n\t\t\tscale.x = w / (tex.width * q.w);\n\t\t\tscale.y = scale.x;\n\t\t} else if (h) {\n\t\t\tscale.y = h / (tex.height * q.h);\n\t\t\tscale.x = scale.y;\n\t\t}\n\t\treturn scale;\n\t}\n\n\treturn {\n\n\t\tid: \"sprite\",\n\t\t// TODO: allow update\n\t\twidth: 0,\n\t\theight: 0,\n\t\tanimSpeed: conf.animSpeed || 0.1,\n\t\tframe: conf.frame || 0,\n\t\tquad: conf.quad || quad(0, 0, 1, 1),\n\n\t\tload() {\n\n\t\t\tspr = assets.sprites[id];\n\n\t\t\tif (!spr) {\n\t\t\t\tthrow new Error(`sprite not found: \"${id}\"`);\n\t\t\t}\n\n\t\t\tlet q = { ...spr.frames[0] };\n\n\t\t\tif (conf.quad) {\n\t\t\t\tq = q.scale(conf.quad);\n\t\t\t}\n\n\t\t\tconst scale = calcTexScale(spr.tex, q, conf.width, conf.height);\n\n\t\t\tthis.width = spr.tex.width * q.w * scale.x;\n\t\t\tthis.height = spr.tex.height * q.h * scale.y;\n\n\t\t},\n\n\t\tdraw() {\n\t\t\tdrawSprite(spr, {\n\t\t\t\tpos: this.pos,\n\t\t\t\tscale: this.scale,\n\t\t\t\trot: this.angle,\n\t\t\t\tcolor: this.color,\n\t\t\t\tframe: this.frame,\n\t\t\t\torigin: this.origin,\n\t\t\t\tquad: this.quad,\n\t\t\t\tprog: assets.shaders[this.shader],\n\t\t\t\tuniform: this.uniform,\n\t\t\t\tflipX: conf.flipX,\n\t\t\t\tflipY: conf.flipY,\n\t\t\t\ttiled: conf.tiled,\n\t\t\t\twidth: conf.width,\n\t\t\t\theight: conf.height,\n\t\t\t});\n\t\t},\n\n\t\tupdate() {\n\n\t\t\tif (!curAnim) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst anim = spr.anims[curAnim.name];\n\n\t\t\tcurAnim.timer += dt();\n\n\t\t\tif (curAnim.timer >= this.animSpeed) {\n\t\t\t\t// TODO: anim dir\n\t\t\t\tthis.frame++;\n\t\t\t\tif (this.frame > anim.to) {\n\t\t\t\t\tif (curAnim.loop) {\n\t\t\t\t\t\tthis.frame = anim.from;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.frame--;\n\t\t\t\t\t\tthis.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (curAnim) {\n\t\t\t\t\tcurAnim.timer -= this.animSpeed;\n\t\t\t\t}\n\t\t\t}\n\n\t\t},\n\n\t\tplay(name: string, loop = true) {\n\n\t\t\tif (!spr) {\n\t\t\t\tready(() => {\n\t\t\t\t\tthis.play(name, loop);\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst anim = spr.anims[name];\n\n\t\t\tif (!anim) {\n\t\t\t\tthrow new Error(`anim not found: ${name}`);\n\t\t\t}\n\n\t\t\tif (curAnim) {\n\t\t\t\tthis.stop();\n\t\t\t}\n\n\t\t\tcurAnim = {\n\t\t\t\tname: name,\n\t\t\t\tloop: loop,\n\t\t\t\ttimer: 0,\n\t\t\t};\n\n\t\t\tthis.frame = anim.from;\n\t\t\tthis.trigger(\"animPlay\", name);\n\n\t\t},\n\n\t\tstop() {\n\t\t\tif (!curAnim) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst prevAnim = curAnim.name;\n\t\t\tcurAnim = null;\n\t\t\tthis.trigger(\"animEnd\", prevAnim);\n\t\t},\n\n\t\tnumFrames() {\n\t\t\tif (!spr) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\treturn spr.frames.length;\n\t\t},\n\n\t\tcurAnim() {\n\t\t\treturn curAnim?.name;\n\t\t},\n\n\t\tflipX(b: boolean) {\n\t\t\tconf.flipX = b;\n\t\t},\n\n\t\tflipY(b: boolean) {\n\t\t\tconf.flipY = b;\n\t\t},\n\n\t\tinspect(): SpriteCompInspect {\n\t\t\tconst info: SpriteCompInspect = {};\n\t\t\tif (curAnim) {\n\t\t\t\tinfo.curAnim = `\"${curAnim.name}\"`;\n\t\t\t}\n\t\t\treturn info;\n\t\t},\n\n\t};\n\n}\n\nfunction text(t: string, size: number, conf: TextCompConf = {}): TextComp {\n\n\treturn {\n\n\t\tid: \"text\",\n\t\ttext: t,\n\t\ttextSize: size || 16,\n\t\tfont: conf.font,\n\t\twidth: 0,\n\t\theight: 0,\n\n\t\tload() {\n\n\t\t\tconst font = assets.fonts[this.font ?? DEF_FONT];\n\t\t\tconst ftext = gfx.fmtText(this.text + \"\", font, {\n\t\t\t\tpos: this.pos,\n\t\t\t\tscale: this.scale,\n\t\t\t\trot: this.angle,\n\t\t\t\tsize: this.textSize,\n\t\t\t\torigin: this.origin,\n\t\t\t\tcolor: this.color,\n\t\t\t\twidth: conf.width,\n\t\t\t});\n\n\t\t\tthis.width = ftext.width / (this.scale?.x || 1);\n\t\t\tthis.height = ftext.height / (this.scale?.y || 1);\n\n\t\t},\n\n\t\tdraw() {\n\n\t\t\tconst font = assets.fonts[this.font ?? DEF_FONT];\n\t\t\tconst ftext = gfx.fmtText(this.text + \"\", font, {\n\t\t\t\tpos: this.pos,\n\t\t\t\tscale: this.scale,\n\t\t\t\trot: this.angle,\n\t\t\t\tsize: this.textSize,\n\t\t\t\torigin: this.origin,\n\t\t\t\tcolor: this.color,\n\t\t\t\twidth: conf.width,\n\t\t\t});\n\n\t\t\tthis.width = ftext.width / (this.scale?.x || 1);\n\t\t\tthis.height = ftext.height / (this.scale?.y || 1);\n\n\t\t\tgfx.drawFmtText(ftext);\n\n\t\t},\n\n\t};\n\n}\n\nfunction rect(w: number, h: number): RectComp {\n\treturn {\n\t\tid: \"rect\",\n\t\twidth: w,\n\t\theight: h,\n\t\tdraw() {\n\t\t\tgfx.drawRect(this.pos, this.width, this.height, {\n\t\t\t\tscale: this.scale,\n\t\t\t\trot: this.angle,\n\t\t\t\tcolor: this.color,\n\t\t\t\torigin: this.origin,\n\t\t\t\tprog: assets.shaders[this.shader],\n\t\t\t\tuniform: this.uniform,\n\t\t\t});\n\t\t},\n\t};\n}\n\nfunction outline(width: number = 1, color: Color = rgb(0, 0, 0)): OutlineComp {\n\n\treturn {\n\n\t\tid: \"outline\",\n\t\tlineWidth: width,\n\t\tlineColor: color,\n\n\t\tdraw() {\n\n\t\t\tif (this.width && this.height) {\n\n\t\t\t\tgfx.drawRectStroke(this.pos || vec2(0), this.width, this.height, {\n\t\t\t\t\twidth: this.lineWidth,\n\t\t\t\t\tcolor: this.lineColor,\n\t\t\t\t\tscale: this.scale,\n\t\t\t\t\torigin: this.origin,\n\t\t\t\t\tprog: assets.shaders[this.shader],\n\t\t\t\t\tuniform: this.uniform,\n\t\t\t\t});\n\n\t\t\t} else if (this.area) {\n\n\t\t\t\tconst a = this.worldArea();\n\t\t\t\tconst w = a.p2.x - a.p1.x;\n\t\t\t\tconst h = a.p2.y - a.p1.y;\n\n\t\t\t\tgfx.drawRectStroke(a.p1, w, h, {\n\t\t\t\t\twidth: width,\n\t\t\t\t\tcolor: color,\n\t\t\t\t});\n\n\t\t\t}\n\n\t\t},\n\n\t};\n\n}\n\nfunction solid(): SolidComp {\n\treturn {\n\t\tid: \"solid\",\n\t\trequire: [ \"area\", ],\n\t\tsolid: true,\n\t};\n}\n\n// maximum y velocity with body()\nconst DEF_MAX_VEL = 960;\nconst DEF_JUMP_FORCE = 480;\n\n// TODO: gravity scale\nfunction body(conf: BodyCompConf = {}): BodyComp {\n\n\tlet velY = 0;\n\tlet curPlatform: GameObj<any> | null = null;\n\tlet lastPlatformPos = null;\n\tconst maxVel = conf.maxVel ?? DEF_MAX_VEL;\n\n\treturn {\n\n\t\tid: \"body\",\n\t\trequire: [ \"area\", \"pos\", ],\n\t\tjumpForce: conf.jumpForce ?? DEF_JUMP_FORCE,\n\n\t\tupdate() {\n\n\t\t\tthis.move(0, velY);\n\n\t\t\tconst targets = this.pushOutAll();\n\t\t\tlet justOff = false;\n\n\t\t\t// check if loses current platform\n\t\t\tif (curPlatform) {\n\t\t\t\tif (!curPlatform.exists() || !this.isCollided(curPlatform)) {\n\t\t\t\t\tcurPlatform = null;\n\t\t\t\t\tlastPlatformPos = null;\n\t\t\t\t\tjustOff = true;\n\t\t\t\t} else {\n\t\t\t\t\tif (lastPlatformPos) {\n\t\t\t\t\t\t// sticky platform\n\t\t\t\t\t\tthis.pos = this.pos.add(curPlatform.pos.sub(lastPlatformPos));\n\t\t\t\t\t\tlastPlatformPos = curPlatform.pos.clone();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!curPlatform) {\n\n\t\t\t\tvelY = Math.min(velY + gravity() * dt(), maxVel);\n\n\t\t\t\t// check if grounded to a new platform\n\t\t\t\tfor (const target of targets) {\n\t\t\t\t\tif (target.side === \"bottom\" && velY > 0) {\n\t\t\t\t\t\tcurPlatform = target.obj;\n\t\t\t\t\t\tvelY = 0;\n\t\t\t\t\t\t// TODO: might not have pos\n\t\t\t\t\t\tlastPlatformPos = curPlatform.pos.clone();\n\t\t\t\t\t\tif (!justOff) {\n\t\t\t\t\t\t\tthis.trigger(\"grounded\", curPlatform);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (target.side === \"top\" && velY < 0) {\n\t\t\t\t\t\tvelY = 0;\n\t\t\t\t\t\tthis.trigger(\"headbutt\", target.obj);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t\tcurPlatform(): GameObj<any> | null {\n\t\t\treturn curPlatform;\n\t\t},\n\n\t\tgrounded(): boolean {\n\t\t\treturn curPlatform !== null;\n\t\t},\n\n\t\tfalling(): boolean {\n\t\t\treturn velY > 0;\n\t\t},\n\n\t\tjump(force: number) {\n\t\t\tcurPlatform = null;\n\t\t\tvelY = -force || -this.jumpForce;\n\t\t},\n\n\t};\n\n}\n\nfunction shader(id: string, uniform: Uniform = {}): ShaderComp {\n\tconst prog = assets.shaders[id];\n\treturn {\n\t\tid: \"shader\",\n\t\tshader: id,\n\t\tuniform: uniform,\n\t};\n}\n\nconst debug: Debug = {\n\tinspect: false,\n\ttimeScale: 1,\n\tshowLog: true,\n\tfps: app.fps,\n\tobjCount(): number {\n\t\treturn game.objs.size;\n\t},\n\tstepFrame() {\n\t\tgameFrame(true);\n\t},\n\tdrawCalls: gfx.drawCalls,\n\tclearLog: logger.clear,\n\tlog: logger.info,\n\terror: logger.error,\n\tget paused() {\n\t\treturn game.paused;\n\t},\n\tset paused(v) {\n\t\tgame.paused = v;\n\t\tif (v) {\n\t\t\taudio.ctx().suspend();\n\t\t} else {\n\t\t\taudio.ctx().resume();\n\t\t}\n\t}\n};\n\nfunction ready(cb: () => void): void {\n\tif (game.loaded) {\n\t\tcb();\n\t} else {\n\t\tgame.on(\"load\", cb);\n\t}\n}\n\nfunction scene(id: SceneID, def: SceneDef) {\n\tgame.scenes[id] = def;\n}\n\nfunction go(id: SceneID, ...args) {\n\n\tif (!game.scenes[id]) {\n\t\tthrow new Error(`scene not found: ${id}`);\n\t}\n\n\tgame.on(\"nextFrame\", () => {\n\n\t\tgame.events = {};\n\n\t\tgame.objEvents = {\n\t\t\tadd: new IDList(),\n\t\t\tupdate: new IDList(),\n\t\t\tdraw: new IDList(),\n\t\t\tdestroy: new IDList(),\n\t\t};\n\n\t\tgame.actions = new IDList();\n\t\tgame.renders = new IDList();\n\t\tgame.objs = new IDList();\n\t\tgame.timers = new IDList();\n\n\t\t// cam\n\t\tgame.cam = {\n\t\t\tpos: vec2(gfx.width() / 2, gfx.height() / 2),\n\t\t\tscale: vec2(1, 1),\n\t\t\tangle: 0,\n\t\t\tshake: 0,\n\t\t};\n\n\t\tgame.camMousePos = app.mousePos();\n\t\tgame.camMatrix = mat4();\n\n\t\tgame.layers = {};\n\t\tgame.defLayer = null;\n\t\tgame.gravity = DEF_GRAVITY;\n\n\t\tgame.scenes[id](...args);\n\n\t\tif (gconf.debug) {\n\t\t\tregDebugInput();\n\t\t}\n\n\t});\n\n}\n\nfunction getData<T>(key: string, def?: T): T {\n\ttry {\n\t\treturn JSON.parse(window.localStorage[key]);\n\t} catch {\n\t\tif (def) {\n\t\t\tsetData(key, def);\n\t\t\treturn def;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n}\n\nfunction setData(key: string, data: any) {\n\twindow.localStorage[key] = JSON.stringify(data);\n}\n\nfunction plug<T>(plugin: KaboomPlugin<T>): MergeObj<T> & KaboomCtx {\n\tconst funcs = plugin(ctx);\n\tfor (const k in funcs) {\n\t\t// @ts-ignore\n\t\tctx[k] = funcs[k];\n\t\tif (!gconf.noGlobal) {\n\t\t\t// @ts-ignore\n\t\t\twindow[k] = funcs[k];\n\t\t}\n\t}\n\treturn ctx as unknown as MergeObj<T> & KaboomCtx;\n}\n\nfunction center(): Vec2 {\n\treturn vec2(gfx.width() / 2, gfx.height() / 2);\n}\n\nconst ctx: KaboomCtx = {\n\t// asset load\n\tloadRoot: assets.loadRoot,\n\tloadSprite: assets.loadSprite,\n\tloadSound: assets.loadSound,\n\tloadFont: assets.loadFont,\n\tloadShader: assets.loadShader,\n\tload: assets.load,\n\t// query\n\twidth: gfx.width,\n\theight: gfx.height,\n\tcenter: center,\n\tdt: dt,\n\ttime: app.time,\n\tscreenshot: app.screenshot,\n\tfocused: app.focused,\n\tfocus: app.focus,\n\tcursor: app.cursor,\n\tready,\n\tisTouch: () => app.isTouch,\n\t// misc\n\tlayers,\n\tcamPos,\n\tcamScale,\n\tcamRot,\n\tshake,\n\tcamIgnore,\n\tgravity,\n\t// obj\n\tadd,\n\treadd,\n\tdestroy,\n\tdestroyAll,\n\tget,\n\tevery,\n\trevery,\n\t// comps\n\tpos,\n\tscale,\n\trotate,\n\tcolor,\n\torigin,\n\tlayer,\n\tarea,\n\tsprite,\n\ttext,\n\trect,\n\toutline,\n\tsolid,\n\tbody,\n\tshader,\n\t// group events\n\ton,\n\taction,\n\trender,\n\tcollides,\n\toverlaps,\n\tclicks,\n\t// input\n\tkeyDown,\n\tkeyPress,\n\tkeyPressRep,\n\tkeyRelease,\n\tmouseDown,\n\tmouseClick,\n\tmouseRelease,\n\tmouseMove,\n\tcharInput,\n\ttouchStart,\n\ttouchMove,\n\ttouchEnd,\n\tmousePos,\n\tmouseDeltaPos: app.mouseDeltaPos,\n\tkeyIsDown: app.keyDown,\n\tkeyIsPressed: app.keyPressed,\n\tkeyIsPressedRep: app.keyPressedRep,\n\tkeyIsReleased: app.keyReleased,\n\tmouseIsDown: app.mouseDown,\n\tmouseIsClicked: app.mouseClicked,\n\tmouseIsReleased: app.mouseReleased,\n\tmouseIsMoved: app.mouseMoved,\n\t// timer\n\tloop,\n\twait,\n\t// audio\n\tplay,\n\tvolume: audio.volume,\n\tburp: audio.burp,\n\taudioCtx: audio.ctx,\n\t// math\n\tmakeRng,\n\trand,\n\trandSeed,\n\tvec2,\n\trgb,\n\trgba,\n\tquad,\n\tchoose,\n\tchance,\n\tlerp,\n\tmap,\n\tmapc,\n\twave,\n\tdeg2rad,\n\trad2deg,\n\t// raw draw\n\tdrawSprite,\n\tdrawText,\n\tdrawRect: gfx.drawRect,\n\tdrawRectStroke: gfx.drawRectStroke,\n\tdrawLine: gfx.drawLine,\n\tdrawTri: gfx.drawTri,\n\t// debug\n\tdebug,\n\t// scene\n\tscene,\n\tgo,\n\t// storage\n\tgetData,\n\tsetData,\n\t// plugin\n\tplug,\n\t// char sets\n\tASCII_CHARS,\n\tCP437_CHARS,\n\t// dom\n\tcanvas: app.canvas,\n};\n\nplug(markPlugin);\nplug(peditPlugin);\nplug(asepritePlugin);\nplug(f04b03Plugin);\nplug(cgaPlugin);\nplug(proggyPlugin);\nplug(levelPlugin);\n\nif (gconf.plugins) {\n\tgconf.plugins.forEach(plug);\n}\n\nif (!gconf.noGlobal) {\n\tfor (const k in ctx) {\n\t\twindow[k] = ctx[k];\n\t}\n}\n\napp.run(() => {\n\n\tgfx.frameStart();\n\n\tif (!game.loaded) {\n\n\t\t// if assets are not fully loaded, draw a progress bar\n\t\tconst progress = assets.loadProgress();\n\n\t\tif (progress === 1) {\n\t\t\tgame.loaded = true;\n\t\t\tgame.trigger(\"load\");\n\t\t\tif (net) {\n\t\t\t\tnet.connect().catch(logger.error);\n\t\t\t}\n\t\t} else {\n\t\t\tconst w = gfx.width() / 2;\n\t\t\tconst h = 24 / gfx.scale();\n\t\t\tconst pos = vec2(gfx.width() / 2, gfx.height() / 2).sub(vec2(w / 2, h / 2));\n\t\t\tgfx.drawRect(vec2(0), gfx.width(), gfx.height(), { color: rgb(0, 0, 0), });\n\t\t\tgfx.drawRectStroke(pos, w, h, { width: 4 / gfx.scale(), });\n\t\t\tgfx.drawRect(pos, w * progress, h);\n\t\t}\n\n\t} else {\n\n\t\t// TODO: this gives the latest mousePos in input handlers but uses cam matrix from last frame\n\t\tgame.camMousePos = game.camMatrix.invert().multVec2(app.mousePos());\n\t\tgame.trigger(\"input\");\n\t\tgameFrame();\n\n\t\tif (debug.inspect) {\n\t\t\tdrawInspect();\n\t\t}\n\n\t\tif (debug.showLog) {\n\t\t\tlogger.draw();\n\t\t}\n\n\t}\n\n\tgfx.frameEnd();\n\n});\n\nfunction regDebugInput() {\n\n\tkeyPress(\"f1\", () => {\n\t\tdebug.inspect = !debug.inspect;\n\t});\n\n\tkeyPress(\"f2\", () => {\n\t\tdebug.clearLog();\n\t});\n\n\tkeyPress(\"f8\", () => {\n\t\tdebug.paused = !debug.paused;\n\t\tlogger.info(`${debug.paused ? \"paused\" : \"unpaused\"}`);\n\t});\n\n\tkeyPress(\"f7\", () => {\n\t\tdebug.timeScale = clamp(debug.timeScale - 0.2, 0, 2);\n\t\tlogger.info(`time scale: ${debug.timeScale.toFixed(1)}`);\n\t});\n\n\tkeyPress(\"f9\", () => {\n\t\tdebug.timeScale = clamp(debug.timeScale + 0.2, 0, 2);\n\t\tlogger.info(`time scale: ${debug.timeScale.toFixed(1)}`);\n\t});\n\n\tkeyPress(\"f10\", () => {\n\t\tdebug.stepFrame();\n\t\tlogger.info(`stepped frame`);\n\t});\n\n}\n\nif (gconf.debug) {\n\tregDebugInput();\n}\n\nwindow.addEventListener(\"error\", (e) => {\n\tlogger.error(`Error: ${e.error.message}`);\n\tapp.quit();\n\tapp.run(() => {\n\t\tif (assets.loadProgress() === 1) {\n\t\t\tgfx.frameStart();\n\t\t\tlogger.draw();\n\t\t\tgfx.frameEnd();\n\t\t}\n\t});\n});\n\nreturn ctx;\n\n};\n"],
  "mappings": "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",
  "names": []
}
